(function(){(this||window).webpackJsonp.registerAbsMids({"esri/Basemap":1326,"esri/core/asyncUtils":1404,"esri/core/loadAll":1650})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1326:function(e,r,t){var n,o;n=[t.dj.c(e.i),r,t(10),t(2),t(1),t(1404),t(21),t(495),t(27),t(6),t(4),t(102),t(1650),t(7),t(8),t(22),t(0),t(119),t(48),t(108),t(1651)],void 0===(o=function(e,r,n,o,a,i,s,l,u,c,p,f,y,d,h,m,b,v,w,L,I){var g=0,_=s.ofType(v),A=d.getLogger("esri.Basemap");return function(e){function r(r){var t=e.call(this)||this;t.id=null,t.portalItem=null,t.thumbnailUrl=null,t.title="Basemap",t.id=Date.now().toString(16)+"-basemap-"+g++,t.baseLayers=new _,t.referenceLayers=new _;var n=function(e){e.parent&&e.parent!==t&&"remove"in e.parent&&e.parent.remove(e),e.parent=t,"elevation"===e.type&&A.error("Layer '"+e.title+", id:"+e.id+"' of type '"+e.type+"' is not supported as a basemap layer and will therefore be ignored.")},o=function(e){e.parent=null};return t.baseLayers.on("after-add",function(e){return n(e.item)}),t.referenceLayers.on("after-add",function(e){return n(e.item)}),t.baseLayers.on("after-remove",function(e){return o(e.item)}),t.referenceLayers.on("after-remove",function(e){return o(e.item)}),t}var s;return o(r,e),s=r,r.prototype.initialize=function(){var e=this;this.when().catch(function(r){A.error("#load()","Failed to load basemap (title: '"+e.title+"', id: '"+e.id+"')",r)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},r.prototype.normalizeCtorArgs=function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=n({},e)).resourceInfo),e},Object.defineProperty(r.prototype,"baseLayers",{set:function(e){this._set("baseLayers",l.referenceSetter(e,this._get("baseLayers"),_))},enumerable:!0,configurable:!0}),r.prototype.writeBaseLayers=function(e,r,t,o){var a=[];e?(o=n({},o,{layerContainerType:"basemap"}),this.baseLayers.forEach(function(e){if(e.write){var r={};e.write(r,o)&&a.push(r)}}),this.referenceLayers.forEach(function(e){if(e.write){var r={isReference:!0};e.write(r,o)&&a.push(r)}}),r[t]=a):r[t]=a},Object.defineProperty(r.prototype,"referenceLayers",{set:function(e){this._set("referenceLayers",l.referenceSetter(e,this._get("referenceLayers"),_))},enumerable:!0,configurable:!0}),r.prototype.writeTitle=function(e,r){r.title=e||"Basemap"},r.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},r.prototype.loadAll=function(){var e=this;return i.safeCast(y.loadAll(this,function(r){r(e.baseLayers,e.referenceLayers)}))},r.prototype.clone=function(){var e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new s({resourceInfo:this.resourceInfo}).set(e)},r.prototype.read=function(e,r){return this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),this.inherited(arguments)},r.prototype.write=function(e,r){return e=e||{},r&&r.origin||(r=n({origin:"web-map"},r)),this.inherited(arguments,[e,r]),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(function(e){var r=p.clone(e);return r.url&&m.isProtocolRelative(r.url)&&(r.url="https:"+r.url),r.templateUrl&&m.isProtocolRelative(r.templateUrl)&&(r.templateUrl="https:"+r.templateUrl),r})),e},r.prototype._loadFromSource=function(){var e=this.resourceInfo,r=this.portalItem;return e?this._loadLayersFromJSON(e.data,e.context?e.context.url:null):r?this._loadFromItem(r):h.resolve(null)},r.prototype._loadLayersFromJSON=function(e,r){var n=this,o=this.resourceInfo&&this.resourceInfo.context,a=this.portalItem&&this.portalItem.portal||o&&o.portal||null,i=o&&"web-scene"===o.origin?"web-scene":"web-map";return h.create(function(e){return t.e(31).then(function(){var r=[t(1843)];e.apply(null,r)}.bind(this)).catch(t.oe)}).then(function(t){var o=[];if(e.baseMapLayers&&Array.isArray(e.baseMapLayers)){var s={context:{origin:i,url:r,portal:a,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},l=t.populateOperationalLayers(n.baseLayers,e.baseMapLayers.filter(function(e){return!e.isReference}),s);o.push.apply(o,l);var u=t.populateOperationalLayers(n.referenceLayers,e.baseMapLayers.filter(function(e){return e.isReference}),s);o.push.apply(o,u)}return h.eachAlways(o)}).then(function(){})},r.prototype._loadFromItem=function(e){var r=this;return e.load().then(function(e){return e.fetchData()}).then(function(t){var n=m.urlToObject(e.itemUrl);return r._set("resourceInfo",{data:t.baseMap,context:{origin:"web-map",portal:e.portal||w.getDefault(),url:n}}),r.read(r.resourceInfo.data,r.resourceInfo.context),r.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||w.getDefault(),url:n}),r._loadLayersFromJSON(r.resourceInfo.data,n)})},r.fromId=function(e){var r=I[e];return r?s.fromJSON(r):null},a([b.property({type:_,json:{write:{ignoreOrigin:!0,target:"baseMapLayers"}}}),b.cast(l.castForReferenceSetter)],r.prototype,"baseLayers",null),a([b.writer("baseLayers")],r.prototype,"writeBaseLayers",null),a([b.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],r.prototype,"id",void 0),a([b.property({type:L})],r.prototype,"portalItem",void 0),a([b.property({type:_}),b.cast(l.castForReferenceSetter)],r.prototype,"referenceLayers",null),a([b.property({readOnly:!0})],r.prototype,"resourceInfo",void 0),a([b.property()],r.prototype,"thumbnailUrl",void 0),a([b.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],r.prototype,"title",void 0),a([b.writer("title")],r.prototype,"writeTitle",null),s=a([b.subclass("esri.Basemap")],r)}(b.declared(c,u,f))}.apply(null,n))||(e.exports=o)},1404:function(e,r,t){var n,o;n=[t.dj.c(e.i),r,t(158),t(474),t(8)],void 0===(o=function(e,r,t,n,o){function a(e){return e}Object.defineProperty(r,"__esModule",{value:!0}),r.forEach=function(e,r,t){return o.eachAlways(e.map(function(e,n){return r.apply(t,[e,n])}))},r.map=function(e,r,t){return o.eachAlways(e.map(function(e,n){return r.apply(t,[e,n])})).then(function(e){return e.map(function(e){return e.value})})},r.result=function(e){return e.then(function(e){return{ok:!0,value:e}}).catch(function(e){return{ok:!1,error:e}})},r.assertResult=function(e){if(!0===e.ok)return e.value;throw e.error},r.safeCast=a,r.safeCastCall=function(e){return a(e())},r.safeCastReturn=function(e){return e}}.apply(null,n))||(e.exports=o)},1650:function(e,r,t){var n,o;n=[t.dj.c(e.i),r,t(158),t(474),t(1404),t(21),t(102)],void 0===(o=function(e,r,t,n,o,a,i){function s(e,r){return n(this,void 0,void 0,function(){var s,l,u,c=this;return t(this,function(p){switch(p.label){case 0:return[4,e.load()];case 1:return p.sent(),s=[],l=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var t=0,n=e;t<n.length;t++){var o=n[t];o&&(Array.isArray(o)?l.apply(void 0,o):a.isCollection(o)?o.forEach(function(e){return l(e)}):o.isInstanceOf&&o.isInstanceOf(i)&&s.push(o))}},r(l),u=null,[4,o.map(s,function(e){return n(c,void 0,void 0,function(){return t(this,function(r){switch(r.label){case 0:return[4,o.result(function(e){return"loadAll"in e&&"function"==typeof e.loadAll}(e)?e.loadAll():e.load())];case 1:return!1!==r.sent().ok||u||(u=e),[2]}})})})];case 2:if(p.sent(),u)throw u.loadError;return[2,e]}})})}Object.defineProperty(r,"__esModule",{value:!0}),r.loadAll=s,r.default=s}.apply(null,n))||(e.exports=o)}}]);