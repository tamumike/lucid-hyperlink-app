(function(){(this||window).webpackJsonp.registerAbsMids({"esri/Basemap":1326,"esri/core/asyncUtils":1404,"esri/layers/support/TilemapCache":1524,"esri/core/LRUCache":1541,"esri/layers/support/Tilemap":1542,"esri/layers/mixins/ArcGISCachedService":1616,"esri/core/loadAll":1650,"esri/support/LayersMixin":1712,"esri/Ground":1900,"esri/Map":2199,"esri/ground/navigationConstraints":2200,"esri/support/basemapUtils":2202,"esri/support/groundUtils":2203})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[95,21,28,43,69],{1326:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(1404),r(21),r(495),r(27),r(6),r(4),r(102),r(1650),r(7),r(8),r(22),r(0),r(119),r(48),r(108),r(1651)],void 0===(i=function(e,t,n,i,a,o,l,s,u,p,c,y,f,d,h,v,m,b,g,w,L){var _=0,S=l.ofType(b),T=d.getLogger("esri.Basemap");return function(e){function t(t){var r=e.call(this)||this;r.id=null,r.portalItem=null,r.thumbnailUrl=null,r.title="Basemap",r.id=Date.now().toString(16)+"-basemap-"+_++,r.baseLayers=new S,r.referenceLayers=new S;var n=function(e){e.parent&&e.parent!==r&&"remove"in e.parent&&e.parent.remove(e),e.parent=r,"elevation"===e.type&&T.error("Layer '"+e.title+", id:"+e.id+"' of type '"+e.type+"' is not supported as a basemap layer and will therefore be ignored.")},i=function(e){e.parent=null};return r.baseLayers.on("after-add",function(e){return n(e.item)}),r.referenceLayers.on("after-add",function(e){return n(e.item)}),r.baseLayers.on("after-remove",function(e){return i(e.item)}),r.referenceLayers.on("after-remove",function(e){return i(e.item)}),r}var l;return i(t,e),l=t,t.prototype.initialize=function(){var e=this;this.when().catch(function(t){T.error("#load()","Failed to load basemap (title: '"+e.title+"', id: '"+e.id+"')",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},t.prototype.normalizeCtorArgs=function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=n({},e)).resourceInfo),e},Object.defineProperty(t.prototype,"baseLayers",{set:function(e){this._set("baseLayers",s.referenceSetter(e,this._get("baseLayers"),S))},enumerable:!0,configurable:!0}),t.prototype.writeBaseLayers=function(e,t,r,i){var a=[];e?(i=n({},i,{layerContainerType:"basemap"}),this.baseLayers.forEach(function(e){if(e.write){var t={};e.write(t,i)&&a.push(t)}}),this.referenceLayers.forEach(function(e){if(e.write){var t={isReference:!0};e.write(t,i)&&a.push(t)}}),t[r]=a):t[r]=a},Object.defineProperty(t.prototype,"referenceLayers",{set:function(e){this._set("referenceLayers",s.referenceSetter(e,this._get("referenceLayers"),S))},enumerable:!0,configurable:!0}),t.prototype.writeTitle=function(e,t){t.title=e||"Basemap"},t.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},t.prototype.loadAll=function(){var e=this;return o.safeCast(f.loadAll(this,function(t){t(e.baseLayers,e.referenceLayers)}))},t.prototype.clone=function(){var e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new l({resourceInfo:this.resourceInfo}).set(e)},t.prototype.read=function(e,t){return this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),this.inherited(arguments)},t.prototype.write=function(e,t){return e=e||{},t&&t.origin||(t=n({origin:"web-map"},t)),this.inherited(arguments,[e,t]),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(function(e){var t=c.clone(e);return t.url&&v.isProtocolRelative(t.url)&&(t.url="https:"+t.url),t.templateUrl&&v.isProtocolRelative(t.templateUrl)&&(t.templateUrl="https:"+t.templateUrl),t})),e},t.prototype._loadFromSource=function(){var e=this.resourceInfo,t=this.portalItem;return e?this._loadLayersFromJSON(e.data,e.context?e.context.url:null):t?this._loadFromItem(t):h.resolve(null)},t.prototype._loadLayersFromJSON=function(e,t){var n=this,i=this.resourceInfo&&this.resourceInfo.context,a=this.portalItem&&this.portalItem.portal||i&&i.portal||null,o=i&&"web-scene"===i.origin?"web-scene":"web-map";return h.create(function(e){return r.e(31).then(function(){var t=[r(1843)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){var i=[];if(e.baseMapLayers&&Array.isArray(e.baseMapLayers)){var l={context:{origin:o,url:t,portal:a,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},s=r.populateOperationalLayers(n.baseLayers,e.baseMapLayers.filter(function(e){return!e.isReference}),l);i.push.apply(i,s);var u=r.populateOperationalLayers(n.referenceLayers,e.baseMapLayers.filter(function(e){return e.isReference}),l);i.push.apply(i,u)}return h.eachAlways(i)}).then(function(){})},t.prototype._loadFromItem=function(e){var t=this;return e.load().then(function(e){return e.fetchData()}).then(function(r){var n=v.urlToObject(e.itemUrl);return t._set("resourceInfo",{data:r.baseMap,context:{origin:"web-map",portal:e.portal||g.getDefault(),url:n}}),t.read(t.resourceInfo.data,t.resourceInfo.context),t.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||g.getDefault(),url:n}),t._loadLayersFromJSON(t.resourceInfo.data,n)})},t.fromId=function(e){var t=L[e];return t?l.fromJSON(t):null},a([m.property({type:S,json:{write:{ignoreOrigin:!0,target:"baseMapLayers"}}}),m.cast(s.castForReferenceSetter)],t.prototype,"baseLayers",null),a([m.writer("baseLayers")],t.prototype,"writeBaseLayers",null),a([m.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],t.prototype,"id",void 0),a([m.property({type:w})],t.prototype,"portalItem",void 0),a([m.property({type:S}),m.cast(s.castForReferenceSetter)],t.prototype,"referenceLayers",null),a([m.property({readOnly:!0})],t.prototype,"resourceInfo",void 0),a([m.property()],t.prototype,"thumbnailUrl",void 0),a([m.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],t.prototype,"title",void 0),a([m.writer("title")],t.prototype,"writeTitle",null),l=a([m.subclass("esri.Basemap")],t)}(m.declared(p,u,y))}.apply(null,n))||(e.exports=i)},1404:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(158),r(474),r(8)],void 0===(i=function(e,t,r,n,i){function a(e){return e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=function(e,t,r){return i.eachAlways(e.map(function(e,n){return t.apply(r,[e,n])}))},t.map=function(e,t,r){return i.eachAlways(e.map(function(e,n){return t.apply(r,[e,n])})).then(function(e){return e.map(function(e){return e.value})})},t.result=function(e){return e.then(function(e){return{ok:!0,value:e}}).catch(function(e){return{ok:!1,error:e}})},t.assertResult=function(e){if(!0===e.ok)return e.value;throw e.error},t.safeCast=a,t.safeCastCall=function(e){return a(e())},t.safeCastReturn=function(e){return e}}.apply(null,n))||(e.exports=i)},1524:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(98),r(36),r(5),r(9),r(14),r(7),r(1541),r(475),r(8),r(15),r(0),r(1542)],void 0===(i=function(e,t,r,n,i,a,o,l,s,u,p,c,y,f,d,h,v){var m=p.getLogger("esri.layers.support.TilemapCache");return function(e){function t(t){var r=e.call(this)||this;return r._handles=new u,r._pendingTilemapRequests={},r._availableLevels={},r.levels=5,r.cacheByteSize=2097152,r.request=o,r}var l;return n(t,e),l=t,t.prototype.initialize=function(){var e=this;this._tilemapCache=new c(this.cacheByteSize),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],function(){return e._initializeTilemapDefinition()}),d.init(this,"layer.tileInfo.lods",function(t){return e._initializeAvailableLevels(t)},!0)]),this._initializeTilemapDefinition()},t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},t.prototype.castLevels=function(e){return e<=2?(m.error("Minimum levels for Tilemap is 3, but got ",e),3):e},Object.defineProperty(t.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0}),t.prototype.getTilemap=function(e,t,r){return this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition)},t.prototype.fetchTilemap=function(e,t,r,n){var i=this;if(!this._availableLevels[e])return f.reject(new s("tilemap-cache:level-unavailable","Level "+e+" is unavailable in the service"));var a=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,r,a);if(o)return f.resolve(o);var l=v.tilemapDefinitionId(a),u=this._pendingTilemapRequests[l];return u||(u=v.Tilemap.fromDefinition(a,n).then(function(e){return i._tilemapCache.put(l,e,e.byteSize),delete i._pendingTilemapRequests[l],e}).catch(function(e){return delete i._pendingTilemapRequests[l],f.reject(e)}),this._pendingTilemapRequests[l]=u),f.create(function(e,t){u.then(e,t)})},t.prototype.getAvailability=function(e,t,r){if(!this._availableLevels[e])return"unavailable";var n=this.getTilemap(e,t,r);return n?n.getAvailability(t,r):"unknown"},t.prototype.getAvailabilityUpsample=function(e,t,r,n){n.level=e,n.row=t,n.col=r;var i=this.layer.tileInfo;for(i.updateTileInfo(n);;){var a=this.getAvailability(n.level,n.row,n.col);if("unavailable"!==a)return a;if(!i.upsampleTile(n))return"unavailable"}},t.prototype.fetchAvailability=function(e,t,r,n){return this._availableLevels[e]?this.fetchTilemap(e,t,r,n).catch(function(e){return e}).then(function(n){if(n instanceof v.Tilemap){var i=n.getAvailability(t,r);return"unavailable"===i?f.reject(new s("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):i}return n&&"cancel"===n.dojoType?f.reject(n):"unknown"}):f.reject(new s("tilemap-cache:level-unavailable","Level "+e+" is unavailable in the service"))},t.prototype.fetchAvailabilityUpsample=function(e,t,r,n,i){var a=this;n.level=e,n.row=t,n.col=r;var o=this.layer.tileInfo;o.updateTileInfo(n);for(var s=this.fetchAvailability(e,t,r,i).catch(function(e){return e&&"cancel"===e.dojoType?f.reject(e):o.upsampleTile(n)?a.fetchAvailabilityUpsample(n.level,n.row,n.col,n):f.reject(e)}),u={id:n.id,level:e,row:t,col:r},p=this,c=0;l._prefetches.length<l._maxPrefetch&&o.upsampleTile(u);++c)!function(e){var t=p.fetchAvailability(u.level,u.row,u.col,i);l._prefetches.push(t),s.then(function(){return t.cancel()},function(){return t.cancel()}),t.then(function(){return l._prefetches.removeUnordered(t)},function(){return l._prefetches.removeUnordered(t)})}();return s},t.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var e=this.layer.parsedUrl,t=e.query;t&&t.token||!this.layer.token||(t=r({},t,{token:this.layer.token})),this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?a.objectToQuery(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}},t.prototype._tilemapFromCache=function(e,t,r,n){var i=this._getTilemapDefinition(e,t,r,n),a=v.tilemapDefinitionId(i);return this._tilemapCache.get(a)},t.prototype._getTilemapDefinition=function(e,t,r,n){return n.level=e,n.row=t-t%this.size,n.col=r-r%this.size,n},t.prototype._initializeAvailableLevels=function(e){var t=this;this._availableLevels={},e&&e.forEach(function(e){return t._availableLevels[e.level]=!0})},t._maxPrefetch=4,t._prefetches=new y({initialSize:l._maxPrefetch}),i([h.property({constructOnly:!0,type:Number})],t.prototype,"levels",void 0),i([h.cast("levels")],t.prototype,"castLevels",null),i([h.property({readOnly:!0,dependsOn:["levels"],type:Number})],t.prototype,"size",null),i([h.property({constructOnly:!0,type:Number})],t.prototype,"cacheByteSize",void 0),i([h.property({constructOnly:!0})],t.prototype,"layer",void 0),i([h.property({constructOnly:!0})],t.prototype,"request",void 0),l=i([h.subclass("esri.layers.support.TilemapCache")],t)}(h.declared(l))}.apply(null,n))||(e.exports=i)},1541:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(480)],void 0===(i=function(e,t,r){return function(){function e(e,t){this._storage=new r.Storage,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}return e.prototype.put=function(e,t,r){this._storage.put(e,t,r)},e.prototype.pop=function(e){return this._storage.pop(e)},e.prototype.get=function(e){return this._storage.get(e)},e.prototype.clear=function(){this._storage.clearAll()},e.prototype.destroy=function(){this._storage.clearAll()},e}()}.apply(null,n))||(e.exports=i)},1542:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(36),r(9),r(4),r(8)],void 0===(i=function(e,t,r,n,i,a,o){function l(e){var t;if("vector-tile"===e.service.type)t=e.service.url+"/tilemap/"+e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height;else{var r=e.service.tileServers;t=(r&&r.length?r[e.row%r.length]:e.service.url)+"/tilemap/"+e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height}var n=e.service.query;return n&&(t=t+"?"+n),t}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this.location={left:0,top:0,width:0,height:0},this.byteSize=40}return e.prototype.getAvailability=function(e,t){if(this._isAllAvailable)return"available";if(this._isAllUnvailable)return"unavailable";var r=(e-this.location.top)*this.location.width+(t-this.location.left),n=r%8,i=r>>3,a=this._tileAvailabilityBitSet;return i<0||i>a.length?"unknown":a[i]&1<<n?"available":"unavailable"},e.prototype._updateFromData=function(e){for(var t=this.location.width,r=this.location.height,n=!0,i=!0,a=Math.ceil(t*r/8),o=new Uint8Array(a),l=0,s=0;s<e.length;s++){var u=s%8;e[s]?(i=!1,o[l]|=1<<u):n=!1,7===u&&++l}this._isAllUnvailable=i,this._isAllAvailable=n,this._isAllAvailable||this._isAllUnvailable||(this._tileAvailabilityBitSet=o,this.byteSize+=o.length)},e.fromDefinition=function(t,a){var s=t.service.request||n,u=t.row,p=t.col,c=t.width,y=t.height,f={query:{f:"json"}};return a=a?r({},f,a):f,s(l(t),a).then(function(e){return e.data}).catch(function(e){return e&&e.details&&422===e.details.httpStatus?{location:{top:u,left:p,width:c,height:y},valid:!0,data:function(){for(var e=[],t=0,r=c*y;t<r;t++)e[t]=0;return e}()}:o.reject(e)}).then(function(t){if(t.location&&(t.location.top!==u||t.location.left!==p||t.location.width!==c||t.location.height!==y))throw new i("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:u,left:p,width:c,height:y}});return e.fromJSON(t)})},e.fromJSON=function(t){e.validateJSON(t);var r=new e;return r.location=Object.freeze(a.clone(t.location)),r._updateFromData(t.data),Object.freeze(r)},e.validateJSON=function(e){if(!e||!e.location)throw new i("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new i("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new i("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new i("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new i("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")},e}();t.Tilemap=s,t.tilemapDefinitionId=function(e){return e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height},t.tilemapDefinitionUrl=l,t.default=s}.apply(null,n))||(e.exports=i)},1616:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(32),r(0),r(244),r(237),r(1524)],void 0===(i=function(e,t,r,n,i,a,o,l,s,u){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.copyright=null,t.minScale=0,t.maxScale=0,t.spatialReference=null,t.tileInfo=null,t.tilemapCache=null,t}return n(t,e),Object.defineProperty(t.prototype,"supportsBlankTile",{get:function(){return this.version>=10.2},enumerable:!0,configurable:!0}),t.prototype.readTileInfo=function(e,t){var r=function(e){return Math.round(1e4*e)/1e4},n=t.minScale?r(t.minScale):1/0,i=t.maxScale?r(t.maxScale):-1/0;return e?(e.lods=e.lods.filter(function(e){var t=r(e.scale);return t<=n&&t>=i}),s.fromJSON(e)):null},t.prototype.readTilemapCache=function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new u({layer:this}):null},i([o.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),i([o.property({json:{origins:{service:{read:!1}}}})],t.prototype,"minScale",void 0),i([o.property({json:{origins:{service:{read:!1}}}})],t.prototype,"maxScale",void 0),i([o.property({type:a.SpatialReference})],t.prototype,"spatialReference",void 0),i([o.property({readOnly:!0,dependsOn:["version"]})],t.prototype,"supportsBlankTile",null),i([o.property({type:s})],t.prototype,"tileInfo",void 0),i([o.reader("service","tileInfo",["tileInfo","minScale","maxScale"])],t.prototype,"readTileInfo",null),i([o.property()],t.prototype,"tilemapCache",void 0),i([o.reader("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),i([o.property()],t.prototype,"version",void 0),i([o.subclass("esri.layers.mixins.ArcGISCachedService")],t)}(o.declared(l))}.apply(null,n))||(e.exports=i)},1650:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(158),r(474),r(1404),r(21),r(102)],void 0===(i=function(e,t,r,n,i,a,o){function l(e,t){return n(this,void 0,void 0,function(){var l,s,u,p=this;return r(this,function(c){switch(c.label){case 0:return[4,e.load()];case 1:return c.sent(),l=[],s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e;r<n.length;r++){var i=n[r];i&&(Array.isArray(i)?s.apply(void 0,i):a.isCollection(i)?i.forEach(function(e){return s(e)}):i.isInstanceOf&&i.isInstanceOf(o)&&l.push(i))}},t(s),u=null,[4,i.map(l,function(e){return n(p,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return[4,i.result(function(e){return"loadAll"in e&&"function"==typeof e.loadAll}(e)?e.loadAll():e.load())];case 1:return!1!==t.sent().ok||u||(u=e),[2]}})})})];case 2:if(c.sent(),u)throw u.loadError;return[2,e]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.loadAll=l,t.default=l}.apply(null,n))||(e.exports=i)},1712:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(5),r(21),r(495),r(7),r(8),r(0),r(119)],void 0===(i=function(e,t,r,n,i,a,o,l,s,u,p){function c(e){return e&&null!=e.layers}function y(e,t,r){for(var n,i,a=0,o=e.length;a<o;a++){if((n=e.getItemAt(a))[t]===r)return n;if(c(n)&&(i=y(n.layers,t,r)))return i}}var f=a.ofType(p),d=l.getLogger("esri.support.LayersMixin");return function(e){function t(t){var r=e.call(this,t)||this;r.layers=new f;return r.layers.on("after-add",function(e){return function(e){e.parent&&e.parent!==r&&"remove"in e.parent&&e.parent.remove(e),e.parent=r,r.layerAdded(e),"elevation"===e.type&&d.error("Layer '"+e.title+", id:"+e.id+"' of type '"+e.type+"' is not supported as an operational layer and will therefore be ignored.")}(e.item)}),r.layers.on("after-remove",function(e){return function(e){e.parent=null,r.layerRemoved(e)}(e.item)}),r}return r(t,e),t.prototype.destroy=function(){this.layers.drain(this.layerRemoved,this)},Object.defineProperty(t.prototype,"layers",{set:function(e){this._set("layers",o.referenceSetter(e,this._get("layers"),f))},enumerable:!0,configurable:!0}),t.prototype.findLayerById=function(e){return y(this.layers,"id",e)},t.prototype.add=function(e,t){var r=this,n=this.layers;t=n.getNextIndex(t),e instanceof p?(e.parent===this&&this.reorder(e,t),n.add(e,t)):s.isThenable(e)?e.then(function(e){r.destroyed||r.add(e,t)}):d.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")},t.prototype.addMany=function(e,t){var r=this,n=this.layers;t=n.getNextIndex(t),e.slice().forEach(function(e){e.parent!==r?(n.add(e,t),t+=1):r.reorder(e,t)})},t.prototype.findLayerByUid=function(e){return y(this.layers,"uid",e)},t.prototype.remove=function(e){return this.layers.remove(e)},t.prototype.removeMany=function(e){return this.layers.removeMany(e)},t.prototype.removeAll=function(){return this.layers.removeAll()},t.prototype.reorder=function(e,t){return this.layers.reorder(e,t)},t.prototype.layerAdded=function(e){},t.prototype.layerRemoved=function(e){},n([u.property({type:f,cast:o.castForReferenceSetter})],t.prototype,"layers",null),n([u.subclass("esri.support.LayersMixin")],t)}(u.declared(i))}.apply(null,n))||(e.exports=i)},1900:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(23),r(1404),r(21),r(495),r(9),r(6),r(4),r(102),r(1650),r(7),r(8),r(0),r(24),r(2200),r(1310),r(119),r(1901),r(534),r(178)],void 0===(i=function(e,t,n,i,a,o,l,s,u,p,c,y,f,d,h,v,m,b,g,w,L,_,S,T){var I=s.ofType(L),A=h.getLogger("esri.Ground");return function(e){function t(t){var r=e.call(this)||this;r.opacity=1,r.surfaceColor=null,r.navigationConstraint=null,r.layers=new I;return r.layers.on("after-add",function(e){return function(e){e.parent&&e.parent!==r&&"remove"in e.parent&&e.parent.remove(e),e.parent=r,S.isOfType(e,["elevation","base-elevation"])||A.error("Layer '"+e.title+", id:"+e.id+"' of type '"+e.type+"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.")}(e.item)}),r.layers.on("after-remove",function(e){return function(e){e.parent=null}(e.item)}),r}var s;return i(t,e),s=t,t.prototype.initialize=function(){this.when().catch(function(e){A.error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},t.prototype.normalizeCtorArgs=function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=n({},e)).resourceInfo),e},Object.defineProperty(t.prototype,"layers",{set:function(e){this._set("layers",u.referenceSetter(e,this._get("layers"),I))},enumerable:!0,configurable:!0}),t.prototype.writeLayers=function(e,t,r,i){var a=[];e?(i=n({},i,{layerContainerType:"ground"}),e.forEach(function(e){if(e.write){var t={};e.write(t,i)&&a.push(t)}else i&&i.messages&&i.messages.push(new p("layer:unsupported","Layers ("+e.title+", "+e.id+") of type '"+e.declaredClass+"' cannot be persisted in the ground",{layer:e}))}),t.layers=a):t.layers=a},t.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},t.prototype.loadAll=function(){var e=this;return l.safeCast(d.loadAll(this,function(t){t(e.layers)}))},t.prototype.queryElevation=function(e,t){var r=new _.ElevationQuery,n=this.layers.filter(function(e){return"elevation"===e.type}).toArray();return r.queryAll(n,e,t)},t.prototype.createElevationSampler=function(e,t){var r=new _.ElevationQuery,n=this.layers.filter(function(e){return"elevation"===e.type}).toArray();return r.createSamplerAll(n,e,t)},t.prototype.clone=function(){var e={opacity:this.opacity,surfaceColor:y.clone(this.surfaceColor),navigationConstraint:y.clone(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new s({resourceInfo:this.resourceInfo}).set(e)},t.prototype.read=function(e,t){return this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),this.inherited(arguments)},t.prototype._loadFromSource=function(){var e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context):v.resolve(null)},t.prototype._loadLayersFromJSON=function(e,t){var n=this,i=t&&t.origin||"web-scene",a=t&&t.portal||null,o=t&&t.url||null;return v.create(function(e){return r.e(31).then(function(){var t=[r(1843)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(t){var r=[];if(e.layers&&Array.isArray(e.layers)){var l={context:{origin:i,url:o,portal:a,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};r.push.apply(r,t.populateOperationalLayers(n.layers,e.layers,l))}return v.eachAlways(r)}).then(function(){})},a([m.property({type:I,json:{type:[w],read:!1}}),m.cast(u.castForReferenceSetter)],t.prototype,"layers",null),a([m.writer("layers")],t.prototype,"writeLayers",null),a([m.property({readOnly:!0})],t.prototype,"resourceInfo",void 0),a([m.property({type:Number,json:{type:b.Integer,read:{reader:T.transparencyToOpacity,source:"transparency"},write:{writer:function(e,t){t.transparency=T.opacityToTransparency(e)},target:"transparency"}}})],t.prototype,"opacity",void 0),a([m.property({type:o,json:{type:[b.Integer],write:function(e,t){t.surfaceColor=e.toJSON().slice(0,3)}}})],t.prototype,"surfaceColor",void 0),a([m.property({types:g.navigationConstraintTypes,json:{read:g.readNavigationConstraint,write:!0}})],t.prototype,"navigationConstraint",void 0),s=a([m.subclass("esri.Ground")],t)}(m.declared(c,f))}.apply(null,n))||(e.exports=i)},2199:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(1326),r(1900),r(5),r(500),r(27),r(7),r(0),r(2202),r(2203),r(1712)],void 0===(i=function(e,t,r,n,i,a,o,l,s,u,p,c,y,f){var d=u.getLogger("esri.Map");return function(e){function t(t){var r=e.call(this)||this;return r.basemap=null,r.ground=new a,r._basemapCache=c.createCache(),r}return r(t,e),Object.defineProperty(t.prototype,"allLayers",{get:function(){return new l({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:function(e){return e.layers}})},enumerable:!0,configurable:!0}),t.prototype.castBasemap=function(e){return c.ensureType(e,this._basemapCache)},t.prototype.castGround=function(e){return y.ensureType(e)||(d.error("Map.ground may not be set to null or undefined"),this._get("ground"))},n([p.property({readOnly:!0})],t.prototype,"allLayers",null),n([p.property({type:i})],t.prototype,"basemap",void 0),n([p.cast("basemap")],t.prototype,"castBasemap",null),n([p.property({type:a})],t.prototype,"ground",void 0),n([p.cast("ground")],t.prototype,"castGround",null),n([p.subclass("esri.Map")],t)}(p.declared(o,s,f))}.apply(null,n))||(e.exports=i)},2200:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(76),r(0)],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),n([o.enumeration.serializable()({none:"none",stayAbove:"stay-above"}),o.property({readOnly:!0,json:{read:!1}})],t.prototype,"type",void 0),n([o.subclass("esri.ground.NavigationConstraint")],t)}(o.declared(i));t.NavigationConstraint=l;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="none",t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i},n([o.property({type:["none"],json:{type:["none"]}})],t.prototype,"type",void 0),i=n([o.subclass("esri.ground.NoneNavigationConstraint")],t)}(o.declared(l));t.NoneNavigationConstraint=s;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="stay-above",t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i},n([o.property({type:["stay-above"],json:{type:["stayAbove"]}})],t.prototype,"type",void 0),i=n([o.subclass("esri.ground.StayAboveNavigationConstraint")],t)}(o.declared(l));t.StayAboveNavigationConstraint=u,t.readNavigationConstraint=function(e,t,r){var n=e&&p[e.type];if(n){var i=new n;return i.read(e,r),i}r&&r.messages&&e&&r.messages.push(new a("navigationconstraint:unsupported","Navigation constraint of type '"+(e.type||"unknown")+"' is not supported",{definition:e,context:r}))};var p={none:s,stayAbove:u};t.navigationConstraintTypes={key:"type",base:l,typeMap:{none:s,"stay-above":u}}}.apply(null,n))||(e.exports=i)},2202:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1326),r(21),r(7),r(22),r(24),r(1651)],void 0===(i=function(e,t,r,n,i,a,o,l){function s(e,t){var n;if("string"==typeof e){if(!(e in l)){var i=Object.keys(l).map(function(e){return'"'+e+'"'}).join(", ");return g.warn("Unable to find basemap definition for: "+e+". Try one of these: "+i),null}t&&(n=t[e]),n||(n=r.fromId(e),t&&(t[e]=n))}else n=o.default(r,e);return n}function u(e,t){return e.map(function(e){return t.find(function(t){return m(y(e),y(t))})||e})}function p(e){return e?!e.loaded&&e.resourceInfo?f(e.resourceInfo.data):{baseLayers:c(e.baseLayers),referenceLayers:c(e.referenceLayers)}:null}function c(e){return(n.isCollection(e)?e.toArray():e).map(y)}function y(e){return{type:e.type,url:b(e.urlTemplate||e.url||e.styleUrl),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible}}function f(e){return e?{baseLayers:d(e.baseMapLayers.filter(function(e){return!e.isReference})),referenceLayers:d(e.baseMapLayers.filter(function(e){return e.isReference}))}:null}function d(e){return e.map(function(e){return function(e){var t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;default:t="unknown"}return{type:t,url:b(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility}}(e)})}function h(e,t,r){return null!=e!=(null!=t)?"not-equal":e?v(e.baseLayers,t.baseLayers)?v(e.referenceLayers,t.referenceLayers)?"equal":r.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function v(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!m(e[r],t[r]))return!1;return!0}function m(e,t){return e.type===t.type&&e.url===t.url&&e.minScale===t.minScale&&e.maxScale===t.maxScale&&e.visible===t.visible&&e.opacity===t.opacity}function b(e){return e?a.normalize(e).replace(/^\s*https?:/i,"").toLowerCase():""}Object.defineProperty(t,"__esModule",{value:!0});var g=i.getLogger("esri.support.basemapUtils");t.createCache=function(){return{}},t.ensureType=s,t.clonePreservingTiledLayers=function(e,t){void 0===t&&(t=null);var n=s(e);if(!n)return null;var i=new r({id:n.id,title:n.title,baseLayers:n.baseLayers.slice(),referenceLayers:n.referenceLayers.slice()});return t&&(i.baseLayers=u(i.baseLayers,t.baseLayers),i.referenceLayers=u(i.referenceLayers,t.referenceLayers)),i.load(),i.portalItem=n.portalItem,i},t.getWellKnownBasemapId=function(e){var t=null,r=p(e);for(var n in l){var i=h(r,f(l[n]),{mustMatchReferences:!1});if("equal"===i){t=n;break}"base-layers-equal"===i&&(t=n)}return t},t.contentEquals=function(e,t){return e===t||"equal"===h(p(e),p(t),{mustMatchReferences:!0})}}.apply(null,n))||(e.exports=i)},2203:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1900),r(7),r(24),r(1310)],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0});var o=n.getLogger("esri.support.groundUtils");t.groundElevationLayers={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer"}},t.ensureType=function(e){var n;if("string"==typeof e)if(e in t.groundElevationLayers){var l=t.groundElevationLayers[e],s=new a({id:l.id,url:l.url});n=new r({layers:[s]})}else o.warn("Unable to find ground definition for: "+e+'. Try "world-elevation"');else n=i.default(r,e);return n}}.apply(null,n))||(e.exports=i)}}]);