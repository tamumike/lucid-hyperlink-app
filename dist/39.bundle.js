(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/ImageryLayer":1316,"esri/layers/support/rasterFormats/LercCodec":1794,"esri/layers/support/PixelBlock":1923,"esri/layers/support/rasterFormats/Zlib":1924,"esri/layers/support/DimensionalDefinition":1925,"esri/layers/mixins/ArcGISImageService":2325,"esri/tasks/ImageServiceIdentifyTask":2326,"esri/tasks/support/ImageServiceIdentifyResult":2327,"esri/layers/support/Raster":2328,"esri/layers/support/rasterFormats/JpgPlus":2329,"esri/layers/support/rasterFormats/Jpg":2330,"esri/layers/support/rasterFormats/Png":2331,"esri/layers/support/rasterFormats/Raw":2332,"esri/layers/support/MosaicRule":2333,"esri/layers/support/RasterFunction":2334,"esri/tasks/support/ImageServiceIdentifyParameters":2335})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{1316:function(e,t,r){var i,n;i=[r.dj.c(e.i),r(4),r(8),r(119),r(2325),r(239),r(238),r(482),r(485),r(123)],void 0===(n=function(e,t,i,n,a,s,o,l,u,h){var c={canvas2D:"2d",webGL:"webgl",expWebGL:"experimental-webgl",webGL2:"webgl2",expWebGL2:"experimental-webgl2"};return n.createSubclass([a,s,o,l,u],{declaredClass:"esri.layers.ImageryLayer",normalizeCtorArgs:function(e,r){return"string"==typeof e?t.mixin({},{url:e},r):e},load:function(){this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]}).then(this._fetchService.bind(this),this._fetchService.bind(this)))},properties:{url:h.url,drawMode:!0,drawType:{value:c.canvas2D,cast:function(e){return e in c?e:c.canvas2D}},legendEnabled:h.legendEnabled,operationalLayerType:{type:["ArcGISImageServiceLayer"],value:"ArcGISImageServiceLayer"},popupEnabled:h.popupEnabled,pixelFilter:null,type:{value:"imagery",json:{read:!1}}},redraw:function(){this.emit("redraw")},importLayerViewModule:function(e){switch(e.type){case"2d":return i.create(function(e){Promise.all([r.e(16),r.e(72)]).then(function(){var t=[r(2369)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"3d":return i.create(function(e){Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(73)]).then(function(){var t=[r(2370)];e.apply(null,t)}.bind(this)).catch(r.oe)})}}})}.apply(null,i))||(e.exports=n)},1794:function(e,t,r){var i;void 0===(i=function(){var e={defaultNoDataValue:-3.4027999387901484e38,decode:function(a,s){var o=(s=s||{}).encodedMaskData||null===s.encodedMaskData,l=n(a,s.inputOffset||0,o),u=null!=s.noDataValue?s.noDataValue:e.defaultNoDataValue,h=t(l,s.pixelType||Float32Array,s.encodedMaskData,u,s.returnMask),c={width:l.width,height:l.height,pixelData:h.resultPixels,minValue:l.pixels.minValue,maxValue:l.pixels.maxValue,noDataValue:u};return h.resultMask&&(c.maskData=h.resultMask),s.returnEncodedMask&&l.mask&&(c.encodedMaskData=l.mask.bitset?l.mask.bitset:null),s.returnFileInfo&&(c.fileInfo=r(l),s.computeUsedBitDepths&&(c.fileInfo.bitDepths=i(l))),c}},t=function(e,t,r,i,n){var s,o,l=0,u=e.pixels.numBlocksX,h=e.pixels.numBlocksY,c=Math.floor(e.width/u),f=Math.floor(e.height/h),p=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),n&&r&&(o=new Uint8Array(e.width*e.height));for(var d,m,g=new Float32Array(c*f),y=0;y<=h;y++){var v=y!==h?f:e.height%h;if(0!==v)for(var x=0;x<=u;x++){var b=x!==u?c:e.width%u;if(0!==b){var w,k,I,D,T=y*e.width*f+x*c,S=e.width-b,R=e.pixels.blocks[l];if(R.encoding<2?(0===R.encoding?w=R.rawData:(a(R.stuffedData,R.bitsPerPixel,R.numValidPixels,R.offset,p,g,e.pixels.maxValue),w=g),k=0):I=2===R.encoding?0:R.offset,r)for(m=0;m<v;m++){for(7&T&&(D=r[T>>3],D<<=7&T),d=0;d<b;d++)7&T||(D=r[T>>3]),128&D?(o&&(o[T]=1),s[T++]=R.encoding<2?w[k++]:I):(o&&(o[T]=0),s[T++]=i),D<<=1;T+=S}else if(R.encoding<2)for(m=0;m<v;m++){for(d=0;d<b;d++)s[T++]=w[k++];T+=S}else for(m=0;m<v;m++)if(s.fill)s.fill(I,T,T+b),T+=b+S;else{for(d=0;d<b;d++)s[T++]=I;T+=S}if(1===R.encoding&&k!==R.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:s,resultMask:o}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:this.noDataValue}}},i=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},i=0;i<t;i++){var n=e.pixels.blocks[i];0===n.encoding?r.float32=!0:1===n.encoding?r[n.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},n=function(e,t,r){var i={},n=new Uint8Array(e,t,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,n),"CntZImage"!=i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;t+=10;var a=new DataView(e,t,24);if(i.fileVersion=a.getInt32(0,!0),i.imageType=a.getInt32(4,!0),i.height=a.getUint32(8,!0),i.width=a.getUint32(12,!0),i.maxZError=a.getFloat64(16,!0),t+=24,!r)if(a=new DataView(e,t,16),i.mask={},i.mask.numBlocksY=a.getUint32(0,!0),i.mask.numBlocksX=a.getUint32(4,!0),i.mask.numBytes=a.getUint32(8,!0),i.mask.maxValue=a.getFloat32(12,!0),t+=16,i.mask.numBytes>0){var s=new Uint8Array(Math.ceil(i.width*i.height/8)),o=(a=new DataView(e,t,i.mask.numBytes)).getInt16(0,!0),l=2,u=0;do{if(o>0)for(;o--;)s[u++]=a.getUint8(l++);else{var h=a.getUint8(l++);for(o=-o;o--;)s[u++]=h}o=a.getInt16(l,!0),l+=2}while(l<i.mask.numBytes);if(-32768!==o||u<s.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=s,t+=i.mask.numBytes}else if(0==(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)){s=new Uint8Array(Math.ceil(i.width*i.height/8));i.mask.bitset=s}a=new DataView(e,t,16),i.pixels={},i.pixels.numBlocksY=a.getUint32(0,!0),i.pixels.numBlocksX=a.getUint32(4,!0),i.pixels.numBytes=a.getUint32(8,!0),i.pixels.maxValue=a.getFloat32(12,!0),t+=16;var c=i.pixels.numBlocksX,f=i.pixels.numBlocksY,p=c+(i.width%c>0?1:0),d=f+(i.height%f>0?1:0);i.pixels.blocks=new Array(p*d);for(var m=1e9,g=0,y=0;y<d;y++)for(var v=0;v<p;v++){var x=0,b=e.byteLength-t;a=new DataView(e,t,Math.min(10,b));var w={};i.pixels.blocks[g++]=w;var k=a.getUint8(0);if(x++,w.encoding=63&k,w.encoding>3)throw"Invalid block encoding ("+w.encoding+")";if(2!==w.encoding){if(0!==k&&2!==k){if(k>>=6,w.offsetType=k,2===k)w.offset=a.getInt8(1),x++;else if(1===k)w.offset=a.getInt16(1,!0),x+=2;else{if(0!==k)throw"Invalid block offset type";w.offset=a.getFloat32(1,!0),x+=4}if(m=Math.min(w.offset,m),1===w.encoding)if(k=a.getUint8(x),x++,w.bitsPerPixel=63&k,k>>=6,w.numValidPixelsType=k,2===k)w.numValidPixels=a.getUint8(x),x++;else if(1===k)w.numValidPixels=a.getUint16(x,!0),x+=2;else{if(0!==k)throw"Invalid valid pixel count type";w.numValidPixels=a.getUint32(x,!0),x+=4}}var I;if(t+=x,3!=w.encoding)if(0===w.encoding){var D=(i.pixels.numBytes-1)/4;if(D!==Math.floor(D))throw"uncompressed block has invalid length";I=new ArrayBuffer(4*D),new Uint8Array(I).set(new Uint8Array(e,t,4*D));for(var T=new Float32Array(I),S=0;S<T.length;S++)m=Math.min(m,T[S]);w.rawData=T,t+=4*D}else if(1===w.encoding){var R=Math.ceil(w.numValidPixels*w.bitsPerPixel/8),A=Math.ceil(R/4);I=new ArrayBuffer(4*A),new Uint8Array(I).set(new Uint8Array(e,t,R)),w.stuffedData=new Uint32Array(I),t+=R}}else t++,m=Math.min(m,0)}return i.pixels.minValue=m,i.eofOffset=t,i},a=function(e,t,r,i,n,a,s){var o,l,u,h=(1<<t)-1,c=0,f=0,p=Math.ceil((s-i)/n),d=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*d,o=0;o<r;o++){if(0===f&&(u=e[c++],f=32),f>=t)l=u>>>f-t&h,f-=t;else{var m=t-f;l=(u&h)<<m&h,l+=(u=e[c++])>>>(f=32-m)}a[o]=l<p?i+l*n:s}return a};return e}.apply(null,[]))||(e.exports=i)},1923:function(e,t,r){var i,n;i=[r(5),r(4)],void 0===(n=function(e,t){return e.createSubclass({declaredClass:"esri.layers.support.PixelBlock",normalizeCtorArgs:function(e){if(!e.width||Math.floor(e.width)!==e.width)throw"PixelBlock: incorrect width";if(!e.height||Math.floor(e.height)!==e.height)throw"PixelBlock: incorrect height";if(!e.pixels||!e.statistics)throw"PixelBlock: pixel data or statistics not present"},properties:{height:null,mask:null,pixels:[],pixelType:null,planes:null,statistics:[],width:null},getPlaneCount:function(){return this.pixels.length!==this.statistics.length?console.error("Inconsistent pixel data and statistics"):this.statistics.length},addData:function(e){if(!e.pixels||!e.statistics)throw"Pixel data or statistics are not present";if(e.pixels.length!==this.width*this.height)throw"Inconsistent pixel data size";this.statistics.push(e.statistics),this.pixels.push(e.pixels)},getAsRGBA:function(){var e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)},getAsRGBAFloat:function(){var e=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(e),e},clone:function(){var e,r,i=new this.constructor;if(i.width=this.width,i.height=this.height,i.pixelType=this.pixelType,this.mask&&(i.mask=new Uint8Array(this.mask)),this.pixels)for(i.pixels=[],r=this.pixels.length,e=0;e<r;e++)i.pixels[e]=new Float32Array(this.pixels[e]);if(this.statistics)for(i.statistics=[],r=this.statistics.length,e=0;e<r;e++)i.statistics[e]=t.clone(this.statistics[e]);return i},_fillFrom8Bit:function(e){var t,r,i,n,a=this.pixels,s=this.mask;if(!e||!a||!a.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");t=r=i=a[0],a.length>=3&&(r=a[1],i=a[2]);var o=new Uint32Array(e),l=this.width*this.height;if(t.length!==l)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(s&&s.length===l)for(n=0;n<l;n++)s[n]&&(o[n]=255<<24|i[n]<<16|r[n]<<8|t[n]);else for(n=0;n<l;n++)o[n]=255<<24|i[n]<<16|r[n]<<8|t[n]},_fillFromNon8Bit:function(e){var t=this.pixels,r=this.mask,i=this.statistics;if(!e||!t||!t.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");var n=1,a=0;if(i&&i.length>0)a=i[0].minValue,n=255/(i[0].maxValue-i[0].minValue);else{var s=255;"s8"===this.pixelType?(a=-128,s=127):"u16"===this.pixelType?s=65535:"s16"===this.pixelType?(a=-32768,s=32767):"u32"===this.pixelType?s=4294967295:"s32"===this.pixelType?(a=-2147483648,s=2147483647):"f32"===this.pixelType?(a=-3.4e39,s=3.4e39):"f64"===this.pixelType&&(a=-Number.MAX_VALUE,s=Number.MAX_VALUE),n=255/(s-a)}var o,l,u,h,c,f=new Uint32Array(e),p=this.width*this.height;if((o=t[0]).length!==p)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");if(t.length>=3)if(l=t[1],u=t[2],r&&r.length===p)for(h=0;h<p;h++)r[h]&&(f[h]=255<<24|(u[h]-a)*n<<16|(l[h]-a)*n<<8|(o[h]-a)*n);else for(h=0;h<p;h++)f[h]=255<<24|(u[h]-a)*n<<16|(l[h]-a)*n<<8|(o[h]-a)*n;else if(r&&r.length===p)for(h=0;h<p;h++)c=(o[h]-a)*n,r[h]&&(f[h]=255<<24|c<<16|c<<8|c);else for(h=0;h<p;h++)c=(o[h]-a)*n,f[h]=255<<24|c<<16|c<<8|c},_fillFrom32Bit:function(e){var t,r,i,n,a=this.pixels,s=this.mask;if(!e||!a||!a.length)return console.error("Unable to convert to RGBA. The input pixel block is empty.");t=r=i=a[0],a.length>=3&&(r=a[1],i=a[2]);var o=this.width*this.height;if(t.length!==o)return console.error("Unable to convert to RGBA. The pixelblock is invalid.");var l=0;if(s&&s.length===o)for(n=0;n<o;n++)e[l++]=t[n],e[l++]=r[n],e[l++]=i[n],e[l++]=s[n];else for(n=0;n<o;n++)e[l++]=t[n],e[l++]=r[n],e[l++]=i[n],e[l++]=255}})}.apply(null,i))||(e.exports=n)},1924:function(e,t,r){var i;void 0===(i=function(){var e=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(e){var t=this.buffer,r=t?t.byteLength:0;if(e<r)return t;for(var i=512;i<e;)i<<=1;for(var n=new Uint8Array(i),a=0;a<r;++a)n[a]=t[a];return this.buffer=n},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(e){var t=this.pos;if(e){this.ensureBuffer(t+e);for(var r=t+e;!this.eof&&this.bufferLength<r;)this.readBlock();var i=this.bufferLength;r>i&&(r=i)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}return this.pos=r,this.buffer.subarray(t,r)},lookChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(e,t,r){for(var i=e+t;this.bufferLength<=i&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,r)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0}},e}();return function(){function t(e){throw new Error(e)}function r(r){var i=0,n=r[i++],a=r[i++];-1!=n&&-1!=a||t("Invalid header in flate stream"),8!=(15&n)&&t("Unknown compression method in flate stream"),((n<<8)+a)%31!=0&&t("Bad FCHECK in flate stream"),32&a&&t("FDICT bit set in flate stream"),this.bytes=r,this.bytesPos=i,this.codeSize=0,this.codeBuf=0,e.call(this)}var i=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),a=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),s=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],o=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];return r.prototype=Object.create(e.prototype),r.prototype.getBits=function(e){for(var r,i=this.codeSize,n=this.codeBuf,a=this.bytes,s=this.bytesPos;i<e;)void 0===(r=a[s++])&&t("Bad encoding in flate stream"),n|=r<<i,i+=8;return r=n&(1<<e)-1,this.codeBuf=n>>e,this.codeSize=i-=e,this.bytesPos=s,r},r.prototype.getCode=function(e){for(var r=e[0],i=e[1],n=this.codeSize,a=this.codeBuf,s=this.bytes,o=this.bytesPos;n<i;){var l;void 0===(l=s[o++])&&t("Bad encoding in flate stream"),a|=l<<n,n+=8}var u=r[a&(1<<i)-1],h=u>>16,c=65535&u;return(0==n||n<h||0==h)&&t("Bad encoding in flate stream"),this.codeBuf=a>>h,this.codeSize=n-h,this.bytesPos=o,c},r.prototype.generateHuffmanTable=function(e){for(var t=e.length,r=0,i=0;i<t;++i)e[i]>r&&(r=e[i]);for(var n=1<<r,a=new Uint32Array(n),s=1,o=0,l=2;s<=r;++s,o<<=1,l<<=1)for(var u=0;u<t;++u)if(e[u]==s){var h=0,c=o;for(i=0;i<s;++i)h=h<<1|1&c,c>>=1;for(i=h;i<n;i+=l)a[i]=s<<16|u;++o}return[a,r]},r.prototype.readBlock=function(){function e(e,t,r,i,n){for(var a=e.getBits(r)+i;a-- >0;)t[d++]=n}var r=this.getBits(3);if(1&r&&(this.eof=!0),0!=(r>>=1)){var l,u;if(1==r)l=s,u=o;else if(2==r){for(var h=this.getBits(5)+257,c=this.getBits(5)+1,f=this.getBits(4)+4,p=Array(i.length),d=0;d<f;)p[i[d++]]=this.getBits(3);for(var m=this.generateHuffmanTable(p),g=0,y=(d=0,h+c),v=new Array(y);d<y;){var x=this.getCode(m);16==x?e(this,v,2,3,g):17==x?e(this,v,3,3,g=0):18==x?e(this,v,7,11,g=0):v[d++]=g=x}l=this.generateHuffmanTable(v.slice(0,h)),u=this.generateHuffmanTable(v.slice(h,y))}else t("Unknown block type in flate stream");for(var b=(C=this.buffer)?C.length:0,w=this.bufferLength;;){var k=this.getCode(l);if(k<256)w+1>=b&&(b=(C=this.ensureBuffer(w+1)).length),C[w++]=k;else{if(256==k)return void(this.bufferLength=w);var I=(k=n[k-=257])>>16;I>0&&(I=this.getBits(I));g=(65535&k)+I;k=this.getCode(u),(I=(k=a[k])>>16)>0&&(I=this.getBits(I));var D=(65535&k)+I;w+g>=b&&(b=(C=this.ensureBuffer(w+g)).length);for(var T=0;T<g;++T,++w)C[w]=C[w-D]}}}else{var S,R=this.bytes,A=this.bytesPos;void 0===(S=R[A++])&&t("Bad block header in flate stream");var P=S;void 0===(S=R[A++])&&t("Bad block header in flate stream"),P|=S<<8,void 0===(S=R[A++])&&t("Bad block header in flate stream");var B=S;void 0===(S=R[A++])&&t("Bad block header in flate stream"),(B|=S<<8)!=(65535&~P)&&t("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var U=this.bufferLength,C=this.ensureBuffer(U+P),M=U+P;this.bufferLength=M;for(var F=U;F<M;++F){if(void 0===(S=R[A++])){this.eof=!0;break}C[F]=S}this.bytesPos=A}},r}()}.apply(null,[]))||(e.exports=i)},1925:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(4),r(0)],void 0===(n=function(e,t,r,i,n,a,s){return function(e){function t(t){var r=e.call(this)||this;return r.variableName=null,r.dimensionName=null,r.values=[],r.isSlice=!1,r}var n;return r(t,e),n=t,t.prototype.clone=function(){return new n({variableName:this.variableName,dimensionName:this.dimensionName,values:a.clone(this.values),isSlice:this.isSlice})},i([s.property({type:String,json:{write:!0}})],t.prototype,"variableName",void 0),i([s.property({type:String,json:{write:!0}})],t.prototype,"dimensionName",void 0),i([s.property({json:{write:!0}})],t.prototype,"values",void 0),i([s.property({type:Boolean,json:{write:!0}})],t.prototype,"isSlice",void 0),n=i([s.subclass("esri.layers.support.DimensionalDefinition")],t)}(s.declared(n))}.apply(null,i))||(e.exports=n)},2325:function(e,t,r){var i,n;i=[r(244),r(83),r(2328),r(1923),r(2333),r(2334),r(1925),r(17),r(20),r(19),r(481),r(2326),r(2335),r(36),r(45),r(103),r(4),r(5),r(11),r(8),r(7)],void 0===(n=function(e,t,r,i,n,a,s,o,l,u,h,c,f,p,d,m,g,y,v,x,b){var w=v({S8:"s8",S16:"s16",S32:"s32",U8:"u8",U16:"u16",U32:"u32",F32:"f32",F64:"f64"}),k=b.getLogger("esri.layers.mixins.ArcGISImageService"),I=y.createSubclass({properties:{layer:{},mosaicRule:{dependsOn:["layer.mosaicRule"],get:function(){return this.get("layer.mosaicRule")||null}},version:{value:0,dependsOn:["layer.bandIds","layer.format","layer.compressionQuality","layer.compressionTolerance","layer.interpolation","layer.noData","layer.noDataInterpretation","layer.mosaicRule","layer.renderingRule","layer.adjustAspectRatio","layer.pixelFilter"],get:function(){var e=this.layer;return e.bandIds,e.format,e.compressionQuality,e.compressionTolerance,e.interpolation,e.noData,e.noDataInterpretation,e.mosaicRule,e.renderingRule,e.adjustAspectRatio,e.pixelFilter,this._get("version")+1}}},toJSON:function(){var e=this.layer;return{bandIds:e.bandIds?e.bandIds.join(","):null,format:e.format,compressionQuality:e.compressionQuality,compressionTolerance:e.compressionTolerance,interpolation:e.interpolation,noData:e.noData,noDataInterpretation:e.noDataInterpretation,mosaicRule:this.mosaicRule?JSON.stringify(this.mosaicRule.toJSON()):null,renderingRule:e.renderingRule?JSON.stringify(e.renderingRule.toJSON()):null,adjustAspectRatio:e.adjustAspectRatio}}});return e.createSubclass({declaredClass:"esri.layers.mixins.ArcGISImageService",getDefaults:function(){return g.mixin(this.inherited(arguments),{exportImageServiceParameters:{layer:this}})},_raster:null,properties:{adjustAspectRatio:{},bandCount:{},bandIds:{type:[Number],json:{write:!0}},capabilities:{json:{read:function(e){return e&&e.split(",").map(function(e){return e.trim()})}}},compressionQuality:{type:Number,json:{write:!0}},compressionTolerance:.01,copyright:{json:{read:{source:["copyrightText"],reader:function(e,t){return t.copyrightText}}}},definitionExpression:{get:function(){return this.mosaicRule?this.mosaicRule.where:null},set:function(e){var t=this.mosaicRule||new n;t.where=e,this._set("mosaicRule",t)},json:{read:{source:["definitionExpression","layerDefinition.definitionExpression"],reader:function(e,t){return e||t.layerDefinition&&t.layerDefinition.definitionExpression||void 0}}}},domainFields:{value:null,type:[t],dependsOn:["fields"],get:function(){return this.fields&&this.fields.filter(function(e){return null!=e.domain})||[]}},exportImageServiceParameters:{readOnly:!0,type:I},fields:{type:[t]},fullExtent:{type:o,json:{read:{source:["extent"],reader:function(e,t){return o.fromJSON(t.extent)}}}},format:{type:String,dependsOn:["pixelFilter"],get:function(){return null!=this.pixelFilter?"lerc":"jpgpng"},json:{write:!0}},hasRasterAttributeTable:{},hasMultidimensions:{},imageMaxHeight:{value:4100,json:{origins:{service:{read:{source:"maxImageHeight"}}}}},imageMaxWidth:{value:15e3,json:{origins:{service:{read:{source:"maxImageWidth"}}}}},interpolation:{type:String,json:{write:!0}},mosaicRule:{value:null,type:n,json:{origins:{service:{read:{source:["defaultMosaicMethod"],reader:function(e,t){return n.fromJSON(t)}}}},write:!0}},multidimensionalInfo:null,noData:{type:Number,json:{write:!0}},noDataInterpretation:{type:String,json:{write:!0}},objectIdField:{json:{read:{source:["fields"],reader:function(e,t){return!e&&t.fields&&t.fields.some(function(t){return"esriFieldTypeOID"===t.type&&(e=t.name),!!e}),e}}}},pixelFilter:{},pixelType:{type:String,value:null,json:{read:w.read,write:w.write}},pixelSizeX:{value:0},pixelSizeY:{value:0},popupTemplate:{value:null,type:m,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}},queryTask:{readOnly:!0,dependsOn:["url"],get:function(){return new h({url:this.url})}},renderer:{json:{origins:{service:{read:!1}},read:{source:"layerDefinition.drawingInfo.renderer",reader:function(){k.warn("Client side renderer configuration on ImageryLayer (id: "+this.id+", title: "+this.title+") is not yet supported. Visualization of the layer data may differ from what is expected.")}},write:!1}},rasterAttributeTable:null,rasterAttributeTableFieldPrefix:"Raster.",rasterFields:{value:null,dependsOn:["fields","rasterAttributeTable","rasterAttributeTableFieldPrefix"],get:function(){var e=this.rasterAttributeTableFieldPrefix,t=this.fields?g.clone(this.fields):[],r=t.length;if(t[r]={name:"Raster.ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:"string"},(this.capabilities&&this.capabilities.indexOf("Catalog")>-1||this.fields&&this.fields.length>0)&&(t[r+1]={name:"Raster.ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:"string"}),null!=this.pixelFilter&&("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)){t[r+2]={name:"Raster.Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"double"},t[r+3]={name:"Raster.Direction",alias:"Direction",domain:null,editable:!1,type:"double"}}var i=this.rasterAttributeTable&&this.rasterAttributeTable.fields||null;if(i&&i.length>0){var n=i.filter(function(e){return"esriFieldTypeOID"!==e.type&&"value"!==e.name.toLowerCase()}).map(function(t){var r=g.clone(t);return r.name=e+t.name,r});t=t.concat(n)}return t}},renderingRule:{value:null,type:a,json:{origins:{service:{read:{source:["rasterFunctionInfos"],reader:function(e,t){var r=t.rasterFunctionInfos;return t.renderingRule||r&&r.length&&"None"!==r[0].name?a.fromJSON(t.renderingRule||{rasterFunctionInfos:t.rasterFunctionInfos}):null}}}},write:!0}},serviceDataType:{},spatialReference:{value:null,readOnly:!0,json:{read:{source:["extent"],reader:function(e,t){return(e=t.extent&&t.extent.spatialReference)&&u.fromJSON(e)}}}},url:{},version:{value:null,readOnly:!0,json:{read:{source:["currentVersion","fields","timeInfo"],reader:function(e,t){return(e=t.currentVersion)||(e=t.hasOwnProperty("fields")||t.hasOwnProperty("objectIdField")||t.hasOwnProperty("timeInfo")?10:9.3),e}}}}},applyFilter:function(e){var t=this._clonePixelData(e);return this.pixelFilter&&this.pixelFilter(t),t},fetchImage:function(e,t,r,i){if(i=i||{},null==this._raster||null==e||null==t||null==r)return x.reject(new Error("Insufficient parameters for requesting an image. A valid extent, width and height values are required."));var n={imageServiceParameters:this.getExportImageServiceParameters(e,t,r,i),nBands:Math.min(this.bandCount,3),pixelType:this.pixelType,requestAsImageElement:i.requestAsImageElement&&!this.pixelFilter||!1};return this._raster.read(n)},fetchKeyProperties:function(){return p(this.parsedUrl.path+"/keyProperties",{query:g.mixin({f:"json"}),responseType:"json"}).then(function(e){return e.data})},getExportImageServiceParameters:function(e,t,r,i){var n=(e=e.clone().shiftCentralMeridian())&&e.spatialReference;return n=n&&(n.wkid||JSON.stringify(n.toJSON())),g.mixin({bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:n,imageSR:n,size:t+","+r},this.exportImageServiceParameters.toJSON())},queryRasters:function(e){return this.queryTask.execute(e)},queryVisibleRasters:function(e,t){this._visibleRasters=[];var r,i,n,a,s=!1,o=this.popupTemplate;if(o&&o.fieldInfos&&o.fieldInfos.length>0&&(s=o.fieldInfos.length>1||"raster.servicepixelvalue"!==o.fieldInfos[0].toLowerCase()),o&&!s&&this.rasterFields&&(s=this.rasterFields.some(function(e){var t=e&&e.name?e.name.toLowerCase():null;return t&&"raster.servicepixelvalue"!==t&&(o.title&&o.title.toLowerCase().indexOf(t)>-1||o.content&&o.content.toLowerCase().indexOf(t)>-1)})),t.layerView&&t.layerView.view){var u=t.layerView.view;if("2d"===u.type){var h=u.state;r=h.spatialReference.clone(),i=h.resolution}else r=u.spatialReference.clone(),i=u.resolution;i&&(n=new l(.5*i,.5*i,r)),a=r.equals(this.spatialReference)}var p=new f({geometry:e.geometry,returnCatalogItems:s,timeExtent:e.timeExtent,mosaicRule:this.mosaicRule||null,renderingRule:this.renderingRule||null,returnGeometry:a,outSpatialReference:r,pixelSize:n});return new c({url:this.url}).execute(p).then(function(e){return this._processVisibleRastersResponse(e,t)}.bind(this)).catch(function(e){throw new Error("Error querying for visible rasters")})},_isScientificData:function(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType||"esriImageServiceDataTypeScientific"===this.serviceDataType},_fetchService:function(){return x.resolve().then(function(){return this.resourceInfo||p(this.parsedUrl.path,{query:g.mixin({f:"json"},this.parsedUrl.query),responseType:"json"})}.bind(this)).then(function(e){e.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.read(e.data,{origin:"service",url:this.parsedUrl}),this._raster=new r({url:this.url})}.bind(this)).then(function(){if(this.version>10&&this.hasRasterAttributeTable)return p(this.parsedUrl.path+"/rasterAttributeTable",{query:{f:"json"},responseType:"json"}).then(function(e){var t=e.data;t&&t.features&&t.fields&&this.read({rasterAttributeTable:t},{origin:"service",url:this.parsedUrl})}.bind(this))}.bind(this)).then(function(){if(this.version>=10.3&&this._isScientificData()&&this.hasMultidimensions)return p(this.parsedUrl.path+"/multiDimensionalInfo",{query:{f:"json"},responseType:"json"}).then(function(e){var t=e.data;t&&t.multidimensionalInfo&&(this._updateMultidimensionalDefinition(t.multidimensionalInfo),this.multidimensionalInfo=t.multidimensionalInfo)}.bind(this))}.bind(this))},_updateMultidimensionalDefinition:function(e){var t,r=e.variables[0].dimensions,i=[];for(t in r)if(r.hasOwnProperty(t)){var a=r[t],o=!0,l=a.extent,u=[l[0]];a.hasRanges&&!0===a.hasRanges?(o=!1,u=[a.values[0]]):"stdz"===a.name.toLowerCase()&&Math.abs(l[1])<=Math.abs(l[0])&&(u=[l[1]]),i.push(new s({variableName:"",dimensionName:r[t].name,isSlice:o,values:u}))}if(i.length>0){this.mosaicRule=this.mosaicRule||new n;var h=this.mosaicRule.multidimensionalDefinition;(!h||h&&h.length<=0)&&(this.mosaicRule.multidimensionalDefinition=i)}},_clonePixelData:function(e){if(null===e||void 0===e)return e;var t={};e.extent&&(t.extent=e.extent.clone());var r=e.pixelBlock;return null===r||void 0===r?t:(t.pixelBlock=r.clone(),t)},_processVisibleRastersResponse:function(e,t){var r,i,n,a,s=e.value,l=0,u=this.objectIdField,h=e.catalogItems&&e.catalogItems.features&&e.catalogItems.features.length||0;if(h){var c,f,p=0,m=0;for(i=[h],r=[h],a=[h],l=0;l<h;l++)e.properties.Values[l].toLowerCase().indexOf("nodata")>-1&&m++;for(c=h-m,l=0;l<h;l++)i[f=e.properties.Values[l].toLowerCase().indexOf("nodata")>-1?c++:p++]=e.catalogItems.features[l],r[f]=e.properties.Values[l],a[f]=i[f].attributes[u]}this._visibleRasters=[];var g,y=s.toLowerCase().indexOf("nodata")>-1;if(s&&!i&&!y){u="ObjectId",i=[];var v={ObjectId:0};(g=new d(new o(this.fullExtent),null,v)).sourceLayer=this,i.push(g)}var x=[];if(!i)return x;var b,w=t&&t.returnDomainValues||!1;for(l=0,n=i.length;l<n;l++)(g=i[l]).sourceLayer=this,s&&(b=s,r&&r.length>=l&&(b=r[l].replace(/ /gi,", ")),g.attributes["Raster.ItemPixelValue"]=b,g.attributes["Raster.ServicePixelValue"]=s,this._updateFeatureWithMagDirValues(g,b),this._updateFeatureWithRasterAttributeTableValues(g,b)),w&&this._updateFeatureWithDomainValues(g),x.push(g);return x},_updateFeatureWithRasterAttributeTableValues:function(e,t){var r=this.rasterAttributeTable&&this.rasterAttributeTable.features;if(r&&!(r.length<1)&&this.rasterAttributeTableFieldPrefix){var i=null;if(r.forEach(function(e){e&&e.attributes&&(e.attributes.Value!=t&&e.attributes.VALUE!=t||(i=e))}),i){var n,a={};for(n in i.attributes)i.attributes.hasOwnProperty(n)&&(a[this.rasterAttributeTableFieldPrefix+n]=i.attributes[n]);e.attributes=g.mixin(e.attributes,a)}}},_updateFeatureWithMagDirValues:function(e,t){if(this.pixelFilter&&("esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType)){var r=t.replace(" ","").split(","),n=new i({height:1,width:1,pixelType:"f32",pixels:[],statistics:[]});r.forEach(function(e){n.addData({pixels:[e],statistics:{minValue:e,maxValue:e,noDataValue:null}})}),this.pixelFilter({pixelBlock:n,extent:new o(0,0,0,0,this.spatialReference)}),e.attributes["Raster.Magnitude"]=n.pixels[0][0],e.attributes["Raster.Direction"]=n.pixels[1][0]}},_updateFeatureWithDomainValues:function(e){var t=this.domainFields;null!=t&&t.forEach(function(t){if(t){var r=e.attributes[t.name];if(null!=r){var i=this._findMatchingDomainValue(t.domain,r);null!=i&&(e.attributes[t.name]=i)}}},this)},_findMatchingDomainValue:function(e,t){var r,i=e&&e.codedValues;if(i)return i.some(function(e){return e.code===t&&(r=e.name,!0)}),r}})}.apply(null,i))||(e.exports=n)},2326:function(e,t,r){var i,n;i=[r(36),r(4),r(166),r(180),r(2327)],void 0===(n=function(e,t,r,i,n){return i.createSubclass({declaredClass:"esri.tasks.ImageServiceIdentifyTask",properties:{parsedUrl:{get:function(){var e=this._parseUrl(this.url);return e.path+="/identify",e}},url:{}},execute:function(i,n){var a=i.geometry?[i.geometry]:[];return r.normalizeCentralMeridian(a).then(function(r){var a={query:this._encode(t.mixin({},this.parsedUrl.query,{f:"json"},i.toJSON({geometry:r&&r[0]})))};return(this.requestOptions||n)&&(a=t.mixin({},this.requestOptions,n,a)),e(this.parsedUrl.path,a)}.bind(this)).then(this._handleExecuteResponse)},_handleExecuteResponse:function(e){return n.fromJSON(e.data)}})}.apply(null,i))||(e.exports=n)},2327:function(e,t,r){var i,n;i=[r(6),r(20),r(126)],void 0===(n=function(e,t,r){return e.createSubclass({declaredClass:"esri.tasks.support.ImageServiceIdentifyResult",properties:{catalogItemVisibilities:null,catalogItems:{value:null,type:r},location:{value:null,type:t},name:null,objectId:null,properties:null,value:null}})}.apply(null,i))||(e.exports=n)},2328:function(e,t,r){var i,n;i=[r(5),r(4),r(22),r(8),r(36),r(17),r(19),r(1923),r(1794),r(2329),r(2331),r(2332)],void 0===(n=function(e,t,r,i,n,a,s,o,l,u,h,c){return e.createSubclass({declaredClass:"esri.layers.support.Raster",validPixelTypes:["u1","u2","u4","u8","u16","u32","s8","s16","s32","f32"],validFormats:["lerc","jpeg","jpg","jpgpng","png","png8","png24","png32","bip","bsq"],properties:{parsedUrl:{readOnly:!0,dependsOn:["url"],get:function(){return this.url?r.urlToObject(this.url):null}},url:null},read:function(e){if(!e.imageServiceParameters||!e.nBands)return i.reject(new Error("Insufficient parameters to read data"));var r=t.clone(e.imageServiceParameters),n=e.nBands,a=e.pixelType||"f32",s=e.requestAsImageElement;this.validPixelTypes.indexOf(a.toUpperCase())<=-1&&(r.pixelType="f32"),r.format=r.format||"lerc",this.validFormats.indexOf(r.format.toLowerCase())<=-1&&(r.format="lerc"),this._prepareGetImageParameters(r);var o=t.clone(r);return this._cleanupRequestParams(o),this._requestArrayBuffer(r,o,n,a,s)},_requestArrayBuffer:function(e,r,a,s,o){return n(this.parsedUrl.path+"/exportImage",{responseType:"array-buffer",query:t.mixin(r,{f:"image"})}).then(function(t){var r=t.data;if(!this._isDataValid(r)){var n=new Error(String.fromCharCode.apply(null,new Uint8Array(r)));return i.reject(n)}var l=e.format.toUpperCase(),u=l;if("BSQ"!==u&&"BIP"!==u&&(u=this._getFormat(r)),this.validFormats.indexOf(u.toLowerCase())<=-1)return i.reject(new Error("Cannot decode the pixelBlock. Unsupported Format: "+u));if(!("PNG"!==l&&"JPGPNG"!==l||"PNG"!==u&&"JPEG"!==u)&&o){var h=new Blob([r],{type:"image/"+("PNG"===u?"png":"jpeg")}),c=URL.createObjectURL(h),f=new Image,p=i.createResolver(),d=p.promise;return f.addEventListener("load",p),f.addEventListener("error",p.reject),f.src=c,d.then(function(){return URL.revokeObjectURL(c),{imageElement:f,params:e}},function(e){return URL.revokeObjectURL(c),i.reject(new Error("Failed to load raster"))})}try{return{pixelData:{pixelBlock:this._decodePixelBlock(r,{width:e.width,height:e.height,planes:a,pixelType:s,noDataValue:e.noData,format:u}),extent:e.extent},params:e}}catch(e){return i.reject(e)}}.bind(this))},_prepareGetImageParameters:function(e){if(e.size&&e.bbox){var r=e.size.split(",");if(e.width=parseFloat(r[0]),e.height=parseFloat(r[1]),!e.extent){var i=e.bbox.split(",");e.extent=new a(parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]),new s(e.bboxSR))}}else{if(!e.width||Math.floor(e.width)!==e.width||!e.height||Math.floor(e.height)!==e.height)throw new Error("Incorrect Image Dimensions");if(!e.extent||"esri.geometry.Extent"!==e.extent.declaredClass)throw new Error("Incorrect extent");var n=e.extent,o=n.spatialReference.wkid||JSON.stringify(n.spatialReference.toJSON());delete e._ts,t.mixin(e,{bbox:n.xmin+","+n.ymin+","+n.xmax+","+n.ymax,imageSR:o,bboxSR:o,size:e.width+","+e.height},e.disableClientCaching?{_ts:Date.now()}:{})}},_adjustExtent:function(e,t,r){var i=e.ymax-e.ymin,n=e.xmax-e.xmin;return r>=t?(i=n*t/r,e.ymax=e.ymin+i):(n=i*r/t,e.xmax=e.xmin+n),e},_cleanupRequestParams:function(e){if(!e)return e;var t,r=["width","height","extent"];for(t in r)e.hasOwnProperty(r[t])&&delete e[r[t]];return e},_getFormat:function(e){var t=new Uint8Array(e,0,10),r="";return 255===t[0]&&216===t[1]?r="JPEG":137===t[0]&&80===t[1]&&78===t[2]&&71===t[3]?r="PNG":67===t[0]&&110===t[1]&&116===t[2]&&90===t[3]&&73===t[4]&&109===t[5]&&97===t[6]&&103===t[7]&&101===t[8]&&32===t[9]?r="LERC":String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1&&(r="ERROR"),r},_isDataValid:function(e){var t=new Uint8Array(e,0,10);return!(String.fromCharCode.apply(null,t).toLowerCase().indexOf("error")>-1)},_calculateBandStatistics:function(e){var t,r=1/0,i=-1/0,n=e.length,a=0;for(t=0;t<n;t++)r=(a=e[t])<r?a:r,i=a>i?a:i;return{minValue:r,maxValue:i}},_verifyResult:function(e,t){return!(!e||e.height!==t.height||e.width!==t.width)},_getPixelTypeAndNoData:function(e){var t,r=e.noDataValue,i=e.pixelType;return"u1"===i||"u2"===i||"u4"===i||"u8"===i?(i="u8",r=Math.pow(2,8)-1,t=Uint8Array):"u16"===i?(r=r||Math.pow(2,16)-1,t=Uint16Array):"u32"===i?(r=r||Math.pow(2,32)-1,t=Uint32Array):"s8"===i?(r=r||0-Math.pow(2,7),t=Int8Array):"s16"===i?(r=r||0-Math.pow(2,15),t=Int16Array):"s32"===i?(r=r||0-Math.pow(2,31),t=Int32Array):t=Float32Array,{pixelType:i,pixelDataType:t,noDataValue:r}},_decodePixelBlock:function(e,t){if(!e||!t)throw new Error("Cannot decode the pixelBlock. Invalid parameters provided for decoding.");if(!t.height||Math.floor(t.height)!==t.height)throw new Error("Cannot decode the pixelBlock. Height is not provided.");if(!t.width||Math.floor(t.width)!==t.width)throw new Error("Cannot decode the pixelBlock. Width is not provided.");var r=this._decodeLerc;switch(t.format.toUpperCase()){case"JPEG":r=this._decodeJpeg;break;case"PNG":r=this._decodePng;break;case"BSQ":r=this._decodeBsq;break;case"BIP":r=this._decodeBip}var i,n,a=(r=r.bind(this))(e,t),s=a.statistics||[];if(s.length<=0)for(i=0;i<a.pixels.length;i++)n=a.pixels[i],s.push(this._calculateBandStatistics(n));return new o({width:t.width,height:t.height,pixels:a.pixels,pixelType:t.pixelType,mask:a.mask,statistics:s})},_decodeJpeg:function(e,t){if(!u)throw new Error("The jpeg decoder module is not loaded.");var r=(new u).decode(e);if(!this._verifyResult(r,t))throw new Error("Error in decoding the image. The decoded image dimensions are incorrect.");return t.width=r.width,t.height=r.height,t.pixelType="U8",r},_decodePng:function(e,t){if(!h)throw new Error("The png decoder module is not loaded.");var r=new Uint8Array(e),i=new h(r),n=new Uint8Array(t.width*t.height*4);i.copyToImageData(n,i.decodePixels());var a,s=0,o=0,l=new Uint8Array(t.width*t.height);for(s=0;s<t.width*t.height;s++)l[s]=n[4*s+3];var u={pixels:[],mask:l};for(s=0;s<3;s++){for(a=new Uint8Array(t.width*t.height),o=0;o<t.width*t.height;o++)a[o]=n[4*o+s];u.pixels.push(a)}return t.pixelType="U8",u},_decodeBsq:function(e,t){if(!c)throw new Error("The bsq decoder module is not loaded.");var r=this._getPixelTypeAndNoData(t);return c.decodeBSQ(e,{bandCount:t.planes,width:t.width,height:t.height,pixelType:r.pixelDataType,noDataValue:r.noDataValue})},_decodeBip:function(e,t){if(!c)throw new Error("The bsq decoder module is not loaded.");var r=this._getPixelTypeAndNoData(t);return c.decodeBIP(e,{bandCount:t.planes,width:t.width,height:t.height,pixelType:r.pixelDataType,noDataValue:r.noDataValue})},_decodeLerc:function(e,t){var r=this._getPixelTypeAndNoData(t);t.pixelType=r.pixelType;for(var i,n=0,a=0,s=e.byteLength-10,o={pixels:[],statistics:[]};a<s;){var u=l.decode(e,{inputOffset:a,encodedMaskData:i,returnMask:0===n,returnEncodedMask:0===n,returnFileInfo:!0,pixelType:r.pixelDataType,noDataValue:r.noDataValue});if(a=u.fileInfo.eofOffset,0===n&&(i=u.encodedMaskData,o.mask=u.maskData),n++,!this._verifyResult(u,t))throw new Error("Error in decoding the image. The decoded image dimensions are incorrect.");o.pixels.push(u.pixelData),o.statistics.push({minValue:u.minValue,maxValue:u.maxValue,noDataValue:u.noDataValue})}return o}})}.apply(null,i))||(e.exports=n)},2329:function(e,t,r){var i,n;i=[r(235),r(1924),r(2330)],void 0===(n=function(e,t,r){"use strict";return e(null,{constructor:function(){},decode:function(e){var i=new Uint8Array(e),n=new r;n.parse(i);var a,s=n.numComponents,o=n.getData(n.width,n.height,!0),l=n.width*n.height,u=n.eof,h=0,c=0,f=0;if(u<i.length-1){var p=new t(i.subarray(u)).getBytes();a=new Uint8Array(l);var d=0;for(h=0;h<p.length;h++)for(f=7;f>=0;f--)a[d++]=p[h]>>f&1}var m,g=[];if(1===s)g=[o,o,o];else{for(h=0;h<3;h++)m=new Uint8Array(l),g.push(m);for(f=0,c=0;c<l;c++)for(h=0;h<3;h++)g[h][c]=o[f++]}return{width:n.width,height:n.height,pixels:g,mask:a}}})}.apply(null,i))||(e.exports=n)},2330:function(e,t,r){var i;void 0===(i=function(){"use strict";return function(){function e(){}function t(e,t){for(var r,i,n=0,a=[],s=16;s>0&&!e[s-1];)s--;a.push({children:[],index:0});var o,l=a[0];for(r=0;r<s;r++){for(i=0;i<e[r];i++){for((l=a.pop()).children[l.index]=t[n];l.index>0;)l=a.pop();for(l.index++,a.push(l);a.length<=r;)a.push(o={children:[],index:0}),l.children[l.index]=o.children,l=o;n++}r+1<s&&(a.push(o={children:[],index:0}),l.children[l.index]=o.children,l=o)}return a[0].children}function r(e,t,r){return 64*((e.blocksPerLine+1)*t+r)}function i(e,t,i,n,a,s,l,u,h){function c(){if(S>0)return T>>--S&1;if(255===(T=e[t++])){var r=e[t++];if(r)throw"unexpected marker: "+(T<<8|r).toString(16)}return S=7,T>>>7}function f(e){for(var t=e;;){if("number"==typeof(t=t[c()]))return t;if("object"!=typeof t)throw"invalid huffman sequence"}}function p(e){for(var t=0;e>0;)t=t<<1|c(),e--;return t}function d(e){if(1===e)return 1===c()?1:-1;var t=p(e);return t>=1<<e-1?t:t+(-1<<e)+1}var m,g,y,v,x,b,w,k=(i.precision,i.samplesPerLine,i.scanLines,i.mcusPerLine),I=i.progressive,D=(i.maxH,i.maxV,t),T=0,S=0,R=0,A=0,P=n.length;w=I?0===s?0===u?function(e,t){var r=f(e.huffmanTableDC),i=0===r?0:d(r)<<h;e.blockData[t]=e.pred+=i}:function(e,t){e.blockData[t]|=c()<<h}:0===u?function(e,t){if(R>0)R--;else for(var r=s,i=l;r<=i;){var n=f(e.huffmanTableAC),a=15&n,u=n>>4;if(0!==a){var c=o[r+=u];e.blockData[t+c]=d(a)*(1<<h),r++}else{if(u<15){R=p(u)+(1<<u)-1;break}r+=16}}}:function(e,t){for(var r,i,n=s,a=l,u=0;n<=a;){var g=o[n];switch(A){case 0:if(u=(i=f(e.huffmanTableAC))>>4,0==(r=15&i))u<15?(R=p(u)+(1<<u),A=4):(u=16,A=1);else{if(1!==r)throw"invalid ACn encoding";m=d(r),A=u?2:3}continue;case 1:case 2:e.blockData[t+g]?e.blockData[t+g]+=c()<<h:0==--u&&(A=2===A?3:0);break;case 3:e.blockData[t+g]?e.blockData[t+g]+=c()<<h:(e.blockData[t+g]=m<<h,A=0);break;case 4:e.blockData[t+g]&&(e.blockData[t+g]+=c()<<h)}n++}4===A&&0==--R&&(A=0)}:function(e,t){var r=f(e.huffmanTableDC),i=0===r?0:d(r);e.blockData[t]=e.pred+=i;for(var n=1;n<64;){var a=f(e.huffmanTableAC),s=15&a,l=a>>4;if(0!==s){var u=o[n+=l];e.blockData[t+u]=d(s),n++}else{if(l<15)break;n+=16}}};var B,U,C,M,F=0;for(U=1===P?n[0].blocksPerLine*n[0].blocksPerColumn:k*i.mcusPerColumn,a||(a=U);F<U;){for(y=0;y<P;y++)n[y].pred=0;if(R=0,1===P)for(g=n[0],b=0;b<a;b++)!function(e,t,i){w(e,r(e,i/e.blocksPerLine|0,i%e.blocksPerLine))}(g,0,F),F++;else for(b=0;b<a;b++){for(y=0;y<P;y++)for(C=(g=n[y]).h,M=g.v,v=0;v<M;v++)for(x=0;x<C;x++)!function(e,t,i,n,a){var s=F%k;w(e,r(e,(F/k|0)*e.v+n,s*e.h+a))}(g,0,0,v,x);F++}if(S=0,(B=e[t]<<8|e[t+1])<=65280)throw"marker was not found";if(!(B>=65488&&B<=65495))break;t+=2}return t-D}function n(e,t,r){for(var i,n,a,s,o,g,y,v,x,b,w,k,I,D,T,S,R,A=e.quantizationTable,P=e.blockData,B=0;B<64;B+=8)x=P[t+B],b=P[t+B+1],w=P[t+B+2],k=P[t+B+3],I=P[t+B+4],D=P[t+B+5],T=P[t+B+6],S=P[t+B+7],x*=A[B],0!=(b|w|k|I|D|T|S)?(b*=A[B+1],w*=A[B+2],k*=A[B+3],I*=A[B+4],D*=A[B+5],T*=A[B+6],S*=A[B+7],n=(i=(i=d*x+128>>8)+(n=d*I+128>>8)+1>>1)-n,R=(a=w)*p+(s=T)*f+128>>8,a=a*f-s*p+128>>8,y=(o=(o=m*(b-S)+128>>8)+(y=D<<4)+1>>1)-y,g=(v=(v=m*(b+S)+128>>8)+(g=k<<4)+1>>1)-g,s=(i=i+(s=R)+1>>1)-s,a=(n=n+a+1>>1)-a,R=o*c+v*h+2048>>12,o=o*h-v*c+2048>>12,v=R,R=g*u+y*l+2048>>12,g=g*l-y*u+2048>>12,y=R,r[B]=i+v,r[B+7]=i-v,r[B+1]=n+y,r[B+6]=n-y,r[B+2]=a+g,r[B+5]=a-g,r[B+3]=s+o,r[B+4]=s-o):(R=d*x+512>>10,r[B]=R,r[B+1]=R,r[B+2]=R,r[B+3]=R,r[B+4]=R,r[B+5]=R,r[B+6]=R,r[B+7]=R);for(var U=0;U<8;++U)x=r[U],0!=((b=r[U+8])|(w=r[U+16])|(k=r[U+24])|(I=r[U+32])|(D=r[U+40])|(T=r[U+48])|(S=r[U+56]))?(n=(i=4112+((i=d*x+2048>>12)+(n=d*I+2048>>12)+1>>1))-n,R=(a=w)*p+(s=T)*f+2048>>12,a=a*f-s*p+2048>>12,s=R,y=(o=(o=m*(b-S)+2048>>12)+(y=D)+1>>1)-y,g=(v=(v=m*(b+S)+2048>>12)+(g=k)+1>>1)-g,R=o*c+v*h+2048>>12,o=o*h-v*c+2048>>12,v=R,R=g*u+y*l+2048>>12,g=g*l-y*u+2048>>12,S=(i=i+s+1>>1)-v,b=(n=n+a+1>>1)+(y=R),T=n-y,w=(a=n-a)+g,D=a-g,k=(s=i-s)+o,I=s-o,x=(x=i+v)<16?0:x>=4080?255:x>>4,b=b<16?0:b>=4080?255:b>>4,w=w<16?0:w>=4080?255:w>>4,k=k<16?0:k>=4080?255:k>>4,I=I<16?0:I>=4080?255:I>>4,D=D<16?0:D>=4080?255:D>>4,T=T<16?0:T>=4080?255:T>>4,S=S<16?0:S>=4080?255:S>>4,P[t+U]=x,P[t+U+8]=b,P[t+U+16]=w,P[t+U+24]=k,P[t+U+32]=I,P[t+U+40]=D,P[t+U+48]=T,P[t+U+56]=S):(R=(R=d*x+8192>>14)<-2040?0:R>=2024?255:R+2056>>4,P[t+U]=R,P[t+U+8]=R,P[t+U+16]=R,P[t+U+24]=R,P[t+U+32]=R,P[t+U+40]=R,P[t+U+48]=R,P[t+U+56]=R)}function a(e,t){for(var i=t.blocksPerLine,a=t.blocksPerColumn,s=new Int16Array(64),o=0;o<a;o++)for(var l=0;l<i;l++){n(t,r(t,o,l),s)}return t.blockData}function s(e){return e<=0?0:e>=255?255:e}var o=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),l=4017,u=799,h=3406,c=2276,f=1567,p=3784,d=5793,m=2896;return e.prototype={parse:function(e){function r(){var t=e[l]<<8|e[l+1];return l+=2,t}var n,s,l=0,u=(e.length,null),h=null,c=[],f=[],p=[],d=r();if(65496!==d)throw"SOI not found";for(d=r();65497!==d;){var m,g,y;switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=function(){var t=r(),i=e.subarray(l,l+t-2);return l+=i.length,i}();65504===d&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(u={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===d&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&(h={version:v[5]<<8|v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var x=r()+l-2;l<x;){var b=e[l++],w=new Uint16Array(64);if(b>>4==0)for(g=0;g<64;g++)w[o[g]]=e[l++];else{if(b>>4!=1)throw"DQT: invalid table spec";for(g=0;g<64;g++)w[o[g]]=r()}c[15&b]=w}break;case 65472:case 65473:case 65474:if(n)throw"Only single frame JPEGs supported";r(),(n={}).extended=65473===d,n.progressive=65474===d,n.precision=e[l++],n.scanLines=r(),n.samplesPerLine=r(),n.components=[],n.componentIds={};var k,I=e[l++],D=0,T=0;for(m=0;m<I;m++){k=e[l];var S=e[l+1]>>4,R=15&e[l+1];D<S&&(D=S),T<R&&(T=R);var A=e[l+2];y=n.components.push({h:S,v:R,quantizationTable:c[A]}),n.componentIds[k]=y-1,l+=3}n.maxH=D,n.maxV=T,function(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),r=Math.ceil(e.scanLines/8/e.maxV),i=0;i<e.components.length;i++){F=e.components[i];var n=Math.ceil(Math.ceil(e.samplesPerLine/8)*F.h/e.maxH),a=Math.ceil(Math.ceil(e.scanLines/8)*F.v/e.maxV),s=t*F.h,o=64*(r*F.v)*(s+1);F.blockData=new Int16Array(o),F.blocksPerLine=n,F.blocksPerColumn=a}e.mcusPerLine=t,e.mcusPerColumn=r}(n);break;case 65476:var P=r();for(m=2;m<P;){var B=e[l++],U=new Uint8Array(16),C=0;for(g=0;g<16;g++,l++)C+=U[g]=e[l];var M=new Uint8Array(C);for(g=0;g<C;g++,l++)M[g]=e[l];m+=17+C,(B>>4==0?p:f)[15&B]=t(U,M)}break;case 65501:r(),s=r();break;case 65498:var F,V=(r(),e[l++]),O=[];for(m=0;m<V;m++){var _=n.componentIds[e[l++]];F=n.components[_];var L=e[l++];F.huffmanTableDC=p[L>>4],F.huffmanTableAC=f[15&L],O.push(F)}var j=e[l++],N=e[l++],E=e[l++],J=i(e,l,n,O,s,j,N,E>>4,15&E);l+=J;break;case 65535:255!==e[l]&&l--;break;default:if(255===e[l-3]&&e[l-2]>=192&&e[l-2]<=254){l-=3;break}throw"unknown JPEG marker "+d.toString(16)}d=r()}for(this.width=n.samplesPerLine,this.height=n.scanLines,this.jfif=u,this.eof=l,this.adobe=h,this.components=[],m=0;m<n.components.length;m++)F=n.components[m],this.components.push({output:a(0,F),scaleX:F.h/n.maxH,scaleY:F.v/n.maxV,blocksPerLine:F.blocksPerLine,blocksPerColumn:F.blocksPerColumn});this.numComponents=this.components.length},_getLinearizedBlockData:function(e,t){var r,i,n,a,s,o,l,u,h,c,f,p=this.width/e,d=this.height/t,m=0,g=this.components.length,y=e*t*g,v=new Uint8Array(y),x=new Uint32Array(e);for(l=0;l<g;l++){for(i=(r=this.components[l]).scaleX*p,n=r.scaleY*d,m=l,f=r.output,a=r.blocksPerLine+1<<3,s=0;s<e;s++)u=0|s*i,x[s]=(4294967288&u)<<3|7&u;for(o=0;o<t;o++)for(c=a*(4294967288&(u=0|o*n))|(7&u)<<3,s=0;s<e;s++)v[m]=f[c+x[s]],m+=g}var b=this.decodeTransform;if(b)for(l=0;l<y;)for(u=0,h=0;u<g;u++,l++,h+=2)v[l]=(v[l]*b[h]>>8)+b[h+1];return v},_isColorConversionNeeded:function(){return!(!this.adobe||!this.adobe.transformCode)||3===this.numComponents},_convertYccToRgb:function(e){for(var t,r,i,n=0,a=e.length;n<a;n+=3)t=e[n],r=e[n+1],i=e[n+2],e[n]=s(t-179.456+1.402*i),e[n+1]=s(t+135.459-.344*r-.714*i),e[n+2]=s(t-226.816+1.772*r);return e},_convertYcckToRgb:function(e){for(var t,r,i,n,a=0,o=0,l=e.length;o<l;o+=4){t=e[o];var u=(r=e[o+1])*(-660635669420364e-19*r+.000437130475926232*(i=e[o+2])-54080610064599e-18*t+.00048449797120281*(n=e[o+3])-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*t-.00477271405408747*n+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*n+.48357088451265)+n*(-.000336197177618394*n+.484791561490776),h=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*i+.000659397001245577*t+.000426105652938837*n-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*t+.000770482631801132*n-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*n+.25802910206845)+n*(-.000318913117588328*n-.213742400323665),c=r*(-.000570115196973677*r-263409051004589e-19*i+.0020741088115012*t-.00288260236853442*n+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*t+.000560833691242812*n-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*n+.116935020465145)+n*(-.000343531996510555*n+.24165260232407);e[a++]=s(u),e[a++]=s(h),e[a++]=s(c)}return e},_convertYcckToCmyk:function(e){for(var t,r,i,n=0,a=e.length;n<a;n+=4)t=e[n],r=e[n+1],i=e[n+2],e[n]=s(434.456-t-1.402*i),e[n+1]=s(119.541-t+.344*r+.714*i),e[n+2]=s(481.816-t-1.772*r);return e},_convertCmykToRgb:function(e){for(var t,r,i,n,a=0,s=-16581375,o=0,l=e.length;o<l;o+=4){var u=(t=e[o])*(-4.387332384609988*t+54.48615194189176*(r=e[o+1])+18.82290502165302*(i=e[o+2])+212.25662451639585*(n=e[o+3])-72734.4411664936)+r*(1.7149763477362134*r-5.6096736904047315*i-17.873870861415444*n-1401.7366389350734)+i*(-2.5217340131683033*i-21.248923337353073*n+4465.541406466231)-n*(21.86122147463605*n+48317.86113160301),h=t*(8.841041422036149*t+60.118027045597366*r+6.871425592049007*i+31.159100130055922*n-20220.756542821975)+r*(-15.310361306967817*r+17.575251261109482*i+131.35250912493976*n-48691.05921601825)+i*(4.444339102852739*i+9.8632861493405*n-6341.191035517494)-n*(20.737325471181034*n+47890.15695978492),c=t*(.8842522430003296*t+8.078677503112928*r+30.89978309703729*i-.23883238689178934*n-3616.812083916688)+r*(10.49593273432072*r+63.02378494754052*i+50.606957656360734*n-28620.90484698408)+i*(.03296041114873217*i+115.60384449646641*n-49363.43385999684)-n*(22.33816807309886*n+45932.16563550634);e[a++]=u>=0?255:u<=s?0:255+u*(1/255/255)|0,e[a++]=h>=0?255:h<=s?0:255+h*(1/255/255)|0,e[a++]=c>=0?255:c<=s?0:255+c*(1/255/255)|0}return e},getData:function(e,t,r){if(this.numComponents>4)throw"Unsupported color mode";var i=this._getLinearizedBlockData(e,t);if(3===this.numComponents)return this._convertYccToRgb(i);if(4===this.numComponents){if(this._isColorConversionNeeded())return r?this._convertYcckToRgb(i):this._convertYcckToCmyk(i);if(r)return this._convertCmykToRgb(i)}return i}},e}()}.apply(null,[]))||(e.exports=i)},2331:function(e,t,r){var i,n;i=[r(1924)],void 0===(n=function(e){return function(t){function r(e){var t,r,i,n,a,s,o,l,u,h,c,f,p;for(this.data=e,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},a=null;;){switch(t=this.readUInt32(),l=function(){var e,t;for(t=[],e=0;e<4;++e)t.push(String.fromCharCode(this.data[this.pos++]));return t}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(t);break;case"fcTL":a&&this.animation.frames.push(a),this.pos+=4,a={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},n=this.readUInt16(),i=this.readUInt16()||100,a.delay=1e3*n/i,a.disposeOp=this.data[this.pos++],a.blendOp=this.data[this.pos++],a.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,t-=4),e=(null!=a?a.data:void 0)||this.imgData,c=0;0<=t?c<t:c>t;0<=t?++c:--c)e.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(t),(u=255-this.transparency.indexed.length)>0)for(f=0;0<=u?f<u:f>u;0<=u?++f:--f)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(t)[0];break;case 2:this.transparency.rgb=this.read(t)}break;case"tEXt":s=(h=this.read(t)).indexOf(0),o=String.fromCharCode.apply(String,h.slice(0,s)),this.text[o]=String.fromCharCode.apply(String,h.slice(s+1));break;case"IEND":return a&&this.animation.frames.push(a),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(p=this.colorType)||6===p,r=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*r,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=t}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}var i,n,a;return r.load=function(e,t,i){var n;return"function"==typeof t&&(i=t),(n=new XMLHttpRequest).open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){var e;return e=new r(new Uint8Array(n.response||n.mozResponseArrayBuffer)),"function"==typeof(null!=t?t.getContext:void 0)&&e.render(t),"function"==typeof i?i(e):void 0},n.send(null)},1,2,0,r.prototype.read=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;0<=e?++t:--t)r.push(this.data[this.pos++]);return r},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(t){var r,i,n,a,s,o,l,u,h,c,f,p,d,m,g,y,v,x,b,w,k,I,D;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=(t=new e(t)).getBytes(),y=(p=this.pixelBitlength/8)*this.width,d=new Uint8Array(y*this.height),o=t.length,g=0,m=0,i=0;m<o;){switch(t[m++]){case 0:for(a=b=0;b<y;a=b+=1)d[i++]=t[m++];break;case 1:for(a=w=0;w<y;a=w+=1)r=t[m++],s=a<p?0:d[i-p],d[i++]=(r+s)%256;break;case 2:for(a=k=0;k<y;a=k+=1)r=t[m++],n=(a-a%p)/p,v=g&&d[(g-1)*y+n*p+a%p],d[i++]=(v+r)%256;break;case 3:for(a=I=0;I<y;a=I+=1)r=t[m++],n=(a-a%p)/p,s=a<p?0:d[i-p],v=g&&d[(g-1)*y+n*p+a%p],d[i++]=(r+Math.floor((s+v)/2))%256;break;case 4:for(a=D=0;D<y;a=D+=1)r=t[m++],n=(a-a%p)/p,s=a<p?0:d[i-p],0===g?v=x=0:(v=d[(g-1)*y+n*p+a%p],x=n&&d[(g-1)*y+(n-1)*p+a%p]),l=s+v-x,u=Math.abs(l-s),c=Math.abs(l-v),f=Math.abs(l-x),h=u<=c&&u<=f?s:c<=f?v:x,d[i++]=(r+h)%256;break;default:throw new Error("Invalid filter algorithm: "+t[m-1])}g++}return d},r.prototype.decodePalette=function(){var e,t,r,i,n,a,s,o,l;for(r=this.palette,a=this.transparency.indexed||[],n=new Uint8Array((a.length||0)+r.length),i=0,r.length,e=0,t=s=0,o=r.length;s<o;t=s+=3)n[i++]=r[t],n[i++]=r[t+1],n[i++]=r[t+2],n[i++]=null!=(l=a[e++])?l:255;return n},r.prototype.copyToImageData=function(e,t){var r,i,n,a,s,o,l,u,h,c,f;if(i=this.colors,h=null,r=this.hasAlphaChannel,this.palette.length&&(h=null!=(f=this._decodedPalette)?f:this._decodedPalette=this.decodePalette(),i=4,r=!0),u=(n=e.data||e).length,s=h||t,a=o=0,1===i)for(;a<u;)l=h?4*t[a/4]:o,c=s[l++],n[a++]=c,n[a++]=c,n[a++]=c,n[a++]=r?s[l++]:this.transparency.grayscale&&this.transparency.grayscale===c?0:255,o=l;else for(;a<u;)l=h?4*t[a/4]:o,n[a++]=s[l++],n[a++]=s[l++],n[a++]=s[l++],n[a++]=r?s[l++]:this.transparency.rgb&&this.transparency.rgb[1]===s[l-3]&&this.transparency.rgb[3]===s[l-2]&&this.transparency.rgb[5]===s[l-1]?0:255,o=l},r.prototype.decode=function(){var e;return e=new Uint8Array(this.width*this.height*4),this.copyToImageData(e,this.decodePixels()),e},n=t.document&&t.document.createElement("canvas"),a=n&&n.getContext("2d"),i=function(e){var t;return a.width=e.width,a.height=e.height,a.clearRect(0,0,e.width,e.height),a.putImageData(e,0,0),(t=new Image).src=n.toDataURL(),t},r.prototype.decodeFrames=function(e){var t,r,n,a,s,o,l,u;if(this.animation){for(u=[],r=s=0,o=(l=this.animation.frames).length;s<o;r=++s)t=l[r],n=e.createImageData(t.width,t.height),a=this.decodePixels(new Uint8Array(t.data)),this.copyToImageData(n,a),t.imageData=n,u.push(t.image=i(n));return u}},r.prototype.renderFrame=function(e,t){var r,i,n;return r=(i=this.animation.frames)[t],n=i[t-1],0===t&&e.clearRect(0,0,this.width,this.height),1===(null!=n?n.disposeOp:void 0)?e.clearRect(n.xOffset,n.yOffset,n.width,n.height):2===(null!=n?n.disposeOp:void 0)&&e.putImageData(n.imageData,n.xOffset,n.yOffset),0===r.blendOp&&e.clearRect(r.xOffset,r.yOffset,r.width,r.height),e.drawImage(r.image,r.xOffset,r.yOffset)},r.prototype.animate=function(e){var t,r,i,n,a,s,o=this;return r=0,s=this.animation,n=s.numFrames,i=s.frames,a=s.numPlays,(t=function(){var s,l;if(s=r++%n,l=i[s],o.renderFrame(e,s),n>1&&r/n<a)return o.animation._timeout=setTimeout(t,l.delay)})()},r.prototype.stopAnimation=function(){var e;return clearTimeout(null!=(e=this.animation)?e._timeout:void 0)},r.prototype.render=function(e){var t,r;return e._png&&e._png.stopAnimation(),e._png=this,e.width=this.width,e.height=this.height,t=e.getContext("2d"),this.animation?(this.decodeFrames(t),this.animate(t)):(r=t.createImageData(this.width,this.height),this.copyToImageData(r,this.decodePixels()),t.putImageData(r,0,0))},r}(this)}.apply(null,i))||(e.exports=n)},2332:function(e,t,r){var i;void 0===(i=function(){"use strict";return{decodeBIP:function(e,t){var r=t.pixelType,i=t.bandCount,n=[],a=t.width*t.height,s=this.getBandCount(e,t);i=i||s;var o,l,u,h,c=e.byteLength-e.byteLength%(a*this._getPixelLength(r)),f=new r(e,0,a*s);for(o=0;o<i;o++){for(h=new r(a),l=0;l<a;l++)h[l]=f[l*s+o];n.push(h)}return c<e.byteLength-1&&(u=this._decodeMask(e.slice(c),t)),{pixels:n,mask:u}},decodeBSQ:function(e,t){var r=t.pixelType,i=t.bandCount;void 0!==i&&null!==i||(i=this.getBandCount(e,t));var n,a,s=[],o=t.width*t.height,l=o*i,u=e.byteLength-e.byteLength%(o*this._getPixelLength(r)),h=new r(e,0,l);for(n=0;n<i;n++)s.push(h.subarray(n*o,(n+1)*o));return u<e.byteLength-1&&(a=this._decodeMask(e.slice(u),t)),{pixels:s,mask:a}},getBandCount:function(e,t){var r=t.width*t.height,i=t.pixelType;return Math.floor(e.byteLength/(r*this._getPixelLength(i)))},_getPixelLength:function(e){var t=1;switch(e){case Uint8Array:case Int8Array:case Uint8ClampedArray:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t},_decodeMask:function(e,t){var r=t.width*t.height;if(8*e.byteLength<r)return null;var i=new Uint8Array(e,0,Math.ceil(r/8)),n=new Uint8Array(t.width*t.height),a=0,s=0,o=0,l=0;for(o=0;o<i.length-1;o++)for(s=i[o],l=7;l>=0;l--)n[a++]=s>>l&1;for(l=7;a<r-1;)s=i[i.length-1],n[a++]=s>>l&1,l--;return n}}}.apply(null,[]))||(e.exports=i)},2333:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(11),r(4),r(0),r(20),r(1925)],void 0===(n=function(e,t,r,i,n,a,s,o,l,u){var h=a({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),c=a({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});return function(e){function t(t){var r=e.call(this)||this;return r.ascending=!0,r.lockRasterIds=null,r.method=null,r.multidimensionalDefinition=null,r.objectIds=null,r.operation=null,r.sortField=null,r.sortValue=null,r.viewpoint=null,r.where=null,r}var n;return r(t,e),n=t,t.prototype.writeAscending=function(e,t,r,i){e||(t[r]=!1)},t.prototype.readMethod=function(e,t){var r=t.mosaicMethod||t.defaultMosaicMethod,i=r.toLowerCase();switch(i){case"byattribute":r="attribute";break;case"lockraster":r="lock-raster";break;case"center":case"northwest":case"nadir":case"viewpoint":case"seamline":case"none":r=i}return c.fromJSON(r)},t.prototype.readOperation=function(e,t){return h.fromJSON(t.mosaicOperation||t.mosaicOperator&&t.mosaicOperator.toLowerCase())},t.prototype.clone=function(){return new n({ascending:this.ascending,lockRasterIds:s.clone(this.lockRasterIds),method:this.method,multidimensionalDefinition:s.clone(this.multidimensionalDefinition),objectIds:s.clone(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:s.clone(this.viewpoint),where:this.where})},i([o.property({type:Boolean})],t.prototype,"ascending",void 0),i([o.writer("ascending")],t.prototype,"writeAscending",null),i([o.property({type:[Number],json:{write:!0}})],t.prototype,"lockRasterIds",void 0),i([o.property({json:{write:{target:"mosaicMethod",writer:c.write}}})],t.prototype,"method",void 0),i([o.reader("method",["mosaicMethod","defaultMosaicMethod"])],t.prototype,"readMethod",null),i([o.property({type:[u],json:{write:!0}})],t.prototype,"multidimensionalDefinition",void 0),i([o.property({json:{read:{source:"fids"},write:{target:"fids"}}})],t.prototype,"objectIds",void 0),i([o.property({json:{read:{reader:h.read},write:{target:"mosaicOperation",writer:h.write}}})],t.prototype,"operation",void 0),i([o.reader("operation",["mosaicOperation","mosaicOperator"])],t.prototype,"readOperation",null),i([o.property({type:String,json:{write:!0}})],t.prototype,"sortField",void 0),i([o.property({json:{write:!0}})],t.prototype,"sortValue",void 0),i([o.property({type:l,json:{write:!0}})],t.prototype,"viewpoint",void 0),i([o.property({type:String,json:{write:!0}})],t.prototype,"where",void 0),n=i([o.subclass("esri.layers.support.MosaicRule")],t)}(o.declared(n))}.apply(null,i))||(e.exports=n)},2334:function(e,t,r){var i,n;i=[r(11),r(6),r(4)],void 0===(n=function(e,t,r){var i=e({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"}),n=t.createSubclass({declaredClass:"esri.layers.support.RasterFunction",properties:{functionArguments:{value:null,json:{read:{source:["rasterFunctionArguments"],reader:function(e,t){return this._resolveFunctionArguments(r.clone(t.rasterFunctionArguments))}}}},functionName:{value:null,json:{read:{source:["rasterFunction","rasterFunctionInfos"],reader:function(e,t){e=t.rasterFunction;var r=t.rasterFunctionInfos;return r&&r.length&&"None"!==r[0].name&&(e=r[0].name),e}}}},outputPixelType:{value:"unknown"},variableName:{value:null}},clone:function(){return n.fromJSON(this.toJSON())},toJSON:function(){var e=r.clone(this.functionArguments),t=function(e){return e&&"esri.layers.support.RasterFunction"===e.declaredClass?e.toJSON():e};if(e&&(e.Raster=t(e.Raster),e.Raster2=t(e.Raster2),e.DEM=t(e.DEM),e.FillRaster=t(e.FillRaster),e.Rasters&&e.Rasters.length)){var n,a=[];for(n=0;n<e.Rasters.length;n++)a.push(t(e.Rasters[n]));e.Rasters=a}var s=i.toJSON(this.outputPixelType);s="UNKNOWN"!==s?s:null;var o={rasterFunction:this.functionName,rasterFunctionArguments:e,variableName:this.variableName,outputPixelType:s};return r.filter(o,function(e){return null!=e})},_resolveFunctionArguments:function(e){var t=function(e){return e&&e.rasterFunction?n.fromJSON(e):e};if(e&&(e.Raster=t(e.Raster),e.Raster2=t(e.Raster2),e.DEM=t(e.DEM),e.FillRaster=t(e.FillRaster),e.Rasters&&e.Rasters.length))for(var r=0;r<e.Rasters.length;r++)e.Rasters[r]=t(e.Rasters[r]);return e}});return n}.apply(null,i))||(e.exports=n)},2335:function(e,t,r){var i,n;i=[r(5),r(51)],void 0===(n=function(e,t){return e.createSubclass({declaredClass:"esri.tasks.support.ImageServiceIdentifyParameters",properties:{geometry:null,mosaicRule:null,noData:null,renderingRule:null,pixelSizeX:null,pixelSizeY:null,pixelSize:null,returnGeometry:!1,returnCatalogItems:!0,timeExtent:null},toJSON:function(e){var r=e&&e.geometry||this.geometry,i={geometry:r,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,mosaicRule:this.mosaicRule?JSON.stringify(this.mosaicRule.toJSON()):null,renderingRule:this.renderingRule?JSON.stringify(this.renderingRule.toJSON()):null};r&&(i.geometryType=t.getJsonType(r));var n=this.timeExtent;return i.time=n?n.toJSON().join(","):null,null!=this.pixelSizeX&&null!=this.pixelSizeY?i.pixelSize=JSON.stringify({x:parseFloat(this.pixelSizeX),y:parseFloat(this.pixelSizeY)}):this.pixelSize&&(i.pixelSize=this.pixelSize?JSON.stringify(this.pixelSize.toJSON()):null),i}})}.apply(null,i))||(e.exports=n)}}]);