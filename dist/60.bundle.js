(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/HandleOwner":1393,"esri/views/layers/LayerView":1413,"esri/views/3d/layers/support/layerViewUpdatingProperties":1428,"esri/views/3d/layers/LayerView3D":1437,"esri/layers/support/lazyLayerLoader":1544,"esri/views/3d/terrain/terrainUtils":1607,"esri/views/3d/layers/TiledLayerView3D":1643,"esri/views/3d/terrain/terrainUtilsPlanar":1644,"esri/views/3d/terrain/terrainUtilsSpherical":1645,"esri/views/3d/layers/support/tiledLayerUtils":1766,"esri/views/3d/layers/ElevationLayerView3D":2350})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1393:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(5),r(14),r(0)],void 0===(i=function(e,t,r,n,i,a,o){return function(e){function t(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=e.call(this)||this;return n.handles=new a,n}return r(t,e),t.prototype.destroy=function(){this.handles.destroy()},n([o.property({readOnly:!0})],t.prototype,"handles",void 0),n([o.subclass("esri.core.HandleOwner")],t)}(o.declared(i))}.apply(null,n))||(e.exports=i)},1413:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(27),r(1393),r(121),r(7),r(159),r(8),r(0)],void 0===(i=function(e,t,r,n,i,a,o,l,s,c,u){return function(e){function t(t){var r=e.call(this)||this;return r.layer=null,r.parent=null,r.view=null,r}return r(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var r=e.layer&&e.layer.id||"no id",n=e.layer&&e.layer.title||"no title";return l.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+n+"', id: '"+r+"')",t),c.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},n([u.property()],t.prototype,"layer",void 0),n([u.property()],t.prototype,"parent",void 0),n([u.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),n([u.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),n([u.property()],t.prototype,"view",void 0),n([u.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),n([u.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),n([u.subclass("esri.views.layers.LayerView")],t)}(u.declared(a,i,o.Identifiable,s))}.apply(null,n))||(e.exports=i)},1428:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.updatingPercentageValue={value:100,readOnly:!0},t.updatingPercentage={dependsOn:["updating","updatingPercentageValue"],readOnly:!0,value:0,get:function(){return this.updating?this.updatingPercentageValue:0}}}.apply(null,n))||(e.exports=i)},1437:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(8),r(15),r(0),r(501),r(1413)],void 0===(i=function(e,t,r,n,i,a,o,l,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.slicePlaneEnabled=!1,t.supportsHeightUnitConversion=!1,t}return r(t,e),t.prototype.postscript=function(e){this.inherited(arguments),l.mayHaveHeightModelInfo(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())},t.prototype._validateHeightModelInfo=function(){var e=this;return i.create(function(t,r){a.whenFalseOnce(e.view.defaultsFromMap,"isHeightModelInfoSearching",function(){var n=l.rejectLayerError(e.layer,e.view.heightModelInfo,e.supportsHeightUnitConversion);n?r(n):t()})})},n([o.property()],t.prototype,"view",void 0),n([o.property()],t.prototype,"slicePlaneEnabled",void 0),n([o.subclass("esri.views.3d.layers.LayerView3D")],t)}(o.declared(s))}.apply(null,n))||(e.exports=i)},1544:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8)],void 0===(i=function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.layerLookupMap={CSVLayer:function(){return n.create(function(e){return Promise.resolve().then(function(){var t=[r(247)];e.apply(null,t)}.bind(this)).catch(r.oe)})},ElevationLayer:function(){return n.create(function(e){return Promise.all([r.e(7),r.e(21)]).then(function(){var t=[r(1310)];e.apply(null,t)}.bind(this)).catch(r.oe)})},FeatureLayer:function(){return n.create(function(e){return Promise.resolve().then(function(){var t=[r(99)];e.apply(null,t)}.bind(this)).catch(r.oe)})},GroupLayer:function(){return n.create(function(e){return r.e(15).then(function(){var t=[r(1312)];e.apply(null,t)}.bind(this)).catch(r.oe)})},GeoRSSLayer:function(){return n.create(function(e){return r.e(24).then(function(){var t=[r(1319)];e.apply(null,t)}.bind(this)).catch(r.oe)})},ImageryLayer:function(){return n.create(function(e){return r.e(39).then(function(){var t=[r(1316)];e.apply(null,t)}.bind(this)).catch(r.oe)})},KMLLayer:function(){return n.create(function(e){return r.e(26).then(function(){var t=[r(1321)];e.apply(null,t)}.bind(this)).catch(r.oe)})},MapImageLayer:function(){return n.create(function(e){return r.e(17).then(function(){var t=[r(1314)];e.apply(null,t)}.bind(this)).catch(r.oe)})},MapNotesLayer:function(){return n.create(function(e){return r.e(68).then(function(){var t=[r(1656)];e.apply(null,t)}.bind(this)).catch(r.oe)})},OpenStreetMapLayer:function(){return n.create(function(e){return r.e(27).then(function(){var t=[r(1322)];e.apply(null,t)}.bind(this)).catch(r.oe)})},PointCloudLayer:function(){return n.create(function(e){return r.e(38).then(function(){var t=[r(1323)];e.apply(null,t)}.bind(this)).catch(r.oe)})},SceneLayer:function(){return n.create(function(e){return Promise.resolve().then(function(){var t=[r(248)];e.apply(null,t)}.bind(this)).catch(r.oe)})},BuildingSceneLayer:function(){return n.create(function(e){return r.e(23).then(function(){var t=[r(1318)];e.apply(null,t)}.bind(this)).catch(r.oe)})},IntegratedMeshLayer:function(){return n.create(function(e){return r.e(25).then(function(){var t=[r(1320)];e.apply(null,t)}.bind(this)).catch(r.oe)})},StreamLayer:function(){return n.create(function(e){return r.e(20).then(function(){var t=[r(1317)];e.apply(null,t)}.bind(this)).catch(r.oe)})},TileLayer:function(){return n.create(function(e){return Promise.all([r.e(6),r.e(69)]).then(function(){var t=[r(478)];e.apply(null,t)}.bind(this)).catch(r.oe)})},UnknownLayer:function(){return n.create(function(e){return r.e(70).then(function(){var t=[r(1657)];e.apply(null,t)}.bind(this)).catch(r.oe)})},UnsupportedLayer:function(){return n.create(function(e){return r.e(71).then(function(){var t=[r(1658)];e.apply(null,t)}.bind(this)).catch(r.oe)})},VectorTileLayer:function(){return n.create(function(e){return Promise.all([r.e(8),r.e(28)]).then(function(){var t=[r(1311)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WebTileLayer:function(){return n.create(function(e){return r.e(29).then(function(){var t=[r(1313)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WMSLayer:function(){return n.create(function(e){return r.e(30).then(function(){var t=[r(1324)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WMTSLayer:function(){return n.create(function(e){return r.e(96).then(function(){var t=[r(1659)];e.apply(null,t)}.bind(this)).catch(r.oe)})},BingMapsLayer:function(){return n.create(function(e){return r.e(12).then(function(){var t=[r(245)];e.apply(null,t)}.bind(this)).catch(r.oe)})}}}.apply(null,n))||(e.exports=i)},1607:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1310),r(478),r(1311),r(1651),r(1644),r(1645)],void 0===(i=function(e,t,r,n,i,a,o,l){function s(e){return e&&"esri.views.3d.layers.TileLayerView3D"===e.declaredClass}function c(e){return e&&"esri.views.3d.layers.VectorTileLayerView3D"===e.declaredClass}function u(e){return e&&"esri.views.3d.layers.WMTSLayerView3D"===e.declaredClass}function p(e){return e&&"esri.views.3d.layers.ElevationLayerView3D"===e.declaredClass}function d(){for(var e in y={},a)a[e].baseMapLayers.forEach(function(e){y[e.url]=19});y["//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"]=20}function f(e,t,r,n){return h["local"===n||"planar"===n?"planar":"spherical"].checkIfTileInfoSupportedForViewSR(e,t,r)}Object.defineProperty(t,"__esModule",{value:!0});var h={planar:o,spherical:l};t.weakAssert=function(e,t){e||console.warn("Terrain: "+t)},t.autoUpdateSkirtsVisibility=function(e,t,r){var n,i=h[e.manifold],a=i.isInsideExtent(e,t);if(a)n=e.getElevation(t);else{var o=e.getElevationBounds();n=.5*(o[0]+o[1])}var l=t[2]-n,s=.9*Math.abs(l)<r?0:l<0?-1:1;if(!a)if(i.isInsideExtent(e,t,e.hideSkirtsDistanceFromExtentMargin)){var c=i.tiltToExtentEdge(e,t);c>e.hideSkirtsMinimumCameraTilt&&c<e.hideSkirtsMaximumCameraTilt&&(s=0)}else s=0;e.skirtScale=s},t.isTiledLayer=function(e){return e&&"base-tile"===e.type||"tile"===e.type||"elevation"===e.type||"base-elevation"===e.type||"open-street-map"===e.type||"web-tile"===e.type||"wmts"===e.type||"vector-tile"===e.type},t.isVectorTileLayer=function(e){return e&&e.isInstanceOf(i)},t.isTileLayerView=s,t.isVectorTileLayerView=c,t.isWMTSLayerView=u,t.isElevationLayerView=p,t.isTiledLayerView=function(e){return e&&(s(e)||p(e)||c(e)||u(e))},t.useFetchTileForLayer=function(e){return e.fetchTile&&!(e.fetchTile===n.prototype.fetchTile||e.fetchTile===r.prototype.fetchTile)};var y=null;t.getKnownTiledServiceLevelCap=function(e){y||d();var t=e&&e.replace(/https?:/,"");return t in y?y[t]:1/0},t.prepareKnownTiledServiceLevelCaps=d,t.checkIfTileInfoSupportedForView=f,t.getTiledLayerInfo=function(e,t,r){var n,i;if("wmts"===e.type){var a=e.activeLayer;if(a){var o=a.tileMatrixSet;if(o)n=o.tileInfo,i=o.fullExtent;else{var l=a.tileMatrixSets;if(l){var s=l.find(function(e){return null==f(e.tileInfo,e.fullExtent,t,r)});if(s)return{tileInfo:s.tileInfo,fullExtent:s.fullExtent}}}}}else n="vector-tile"===e.type?e.compatibleTileInfo256:e.tileInfo,i=e.fullExtent;return n&&i&&null==f(n,i,t,r)?{tileInfo:n,fullExtent:i}:{tileInfo:null,fullExtent:null}}}.apply(null,n))||(e.exports=i)},1643:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(9),r(0),r(1437),r(1428),r(1607)],void 0===(i=function(e,t,r,n,i,a,o,l,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.minDataLevel=0,t.maxDataLevel=1/0,t._isUpdating=!1,t}return r(t,e),Object.defineProperty(t.prototype,"imageFormatIsOpaque",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOpaque",{get:function(){return this.fullOpacity>=1&&this.imageFormatIsOpaque},enumerable:!0,configurable:!0}),t.prototype.getTileUrl=function(e,t,r){return this.layer.getTileUrl(e,t,r)},t.prototype.updatingChanged=function(e){this._isUpdating=e,this.notifyChange("updating")},t.prototype.isUpdating=function(){return this._isUpdating},t.prototype._getTileInfoSupportError=function(e,t){var r=s.checkIfTileInfoSupportedForView(e,t,this.view.spatialReference,this.view.basemapTerrain.manifold);if(r){var n={layer:this.layer,error:r},a=void 0;switch(r.name){case"tilingscheme:local-gcs-not-supported":a=new i("layerview:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes",n);break;case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":a=new i("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",n);break;default:a=new i("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",n)}return a}return null},t.prototype._getTileInfoCompatibilityError=function(e,t){return t.compatibleWith(e)?null:new i("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")},t.prototype._updateMinMaxDataLevel=function(){var e,t=1/0,r=0;this.tileInfo.lods.forEach(function(e){t=Math.min(e.level,t),r=Math.max(e.level,r)}),e=[t,r],this.minDataLevel=e[0],this.maxDataLevel=e[1]},n([a.property({readOnly:!0})],t.prototype,"imageFormatIsOpaque",null),n([a.property(l.updatingPercentage)],t.prototype,"updatingPercentage",void 0),n([a.property(l.updatingPercentageValue)],t.prototype,"updatingPercentageValue",void 0),n([a.property()],t.prototype,"fullExtent",void 0),n([a.property({readOnly:!0,dependsOn:["fullOpacity","imageFormatIsOpaque"]})],t.prototype,"isOpaque",null),n([a.property()],t.prototype,"layer",void 0),n([a.property()],t.prototype,"minDataLevel",void 0),n([a.property()],t.prototype,"maxDataLevel",void 0),n([a.property()],t.prototype,"tileInfo",void 0),n([a.subclass("esri.views.3d.layers.TiledLayerView3D")],t)}(a.declared(o))}.apply(null,n))||(e.exports=i)},1644:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9),r(34),r(81),r(507),r(484)],void 0===(i=function(e,t,r,n,i,a,o){function l(e,t,r,i){n.vec3.copy(c,r),c[i]=t[i];var a,o=n.vec3.subtract(c,c,t),l=n.vec3.subtract(u,e,t),s=n.vec3.dot(l,o),p=n.vec3.dot(o,o);a=s<=0?t:p<=s?r:n.vec3.add(c,t,n.vec3.scale(o,o,s/p));var d=n.vec3.subtract(c,e,a);return Math.PI/2-Math.atan(d[2]/Math.sqrt(d[0]*d[0]+d[1]*d[1]))}function s(e,t){var n=e.lods,l=n[0].resolution*Math.pow(2,n[0].level),s=[l*e.size[0],l*e.size[1]],c=[e.origin.x,e.origin.y],u=i.fromExtent(t),p=i.create();o.computeRowColExtent(u,s,c,p);var d=(p[2]-p[0])*(p[3]-p[1]);if(d>a.MAX_ROOT_TILES){var f=n[0].scale*Math.pow(2,n[0].level),h=Math.max((u[3]-u[1])/e.size[1],(u[2]-u[0])/e.size[0])*f/l,y=Math.floor(Math.log(h)/Math.log(10));return h=Math.ceil(h/Math.pow(10,y))*Math.pow(10,y),new r("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(f).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+h.toLocaleString()+".",{level0Scale:f,suggestedLevel0Scale:h,requiredNumRootTiles:d,allowedNumRootTiles:a.MAX_ROOT_TILES})}return null}Object.defineProperty(t,"__esModule",{value:!0});var c=n.vec3f64.create(),u=n.vec3f64.create(),p=n.vec3f64.create(),d=n.vec3f64.create();t.isInsideExtent=function(e,t,r){void 0===r&&(r=0);var n=e.extent;if(0===r)return i.containsPoint(n,t);var a=Math.min(n[2]-n[0],n[3]-n[1]);return i.containsPointWithMargin(n,t,r*a)},t.tiltOnEdge=l,t.tiltToExtentEdge=function(e,t){var r=e.getElevationBounds(),n=e.extent,i=.5*(r[0]+r[1]);p[0]=n[0],p[1]=n[1],p[2]=i,d[0]=n[2],d[1]=n[3],d[2]=i;var a=1/0,o=1/0;return t[0]<p[0]?a=l(t,p,d,0):t[0]>d[0]&&(a=l(t,d,p,0)),t[1]<p[1]?o=l(t,p,d,1):t[1]>d[1]&&(o=l(t,d,p,1)),Math.min(a,o)},t.checkIfTileInfoSupportedForViewSR=function(e,t,n){if(e.spatialReference.isGeographic)return new r("tilingscheme:local-gcs-not-supported","Geographic coordinate systems are not supported in local scenes");var i=o.checkUnsupported(e);return i||s(e,t)||(n&&!e.spatialReference.equals(n)?new r("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null)}}.apply(null,n))||(e.exports=i)},1645:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9),r(484)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isInsideExtent=function(e,t,r){return void 0===r&&(r=0),!0},t.tiltToExtentEdge=function(e,t){return 0},t.checkIfTileInfoSupportedForViewSR=function(e,t,i){var a=e.lods.length-1;if(e.spatialReference.isWebMercator){if(!n.makeWebMercatorAuxiliarySphere(a).compatibleWith(e))return new r("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!e.spatialReference.isWGS84)return new r("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!n.makeWGS84WithTileSize(e.size[1],a).compatibleWith(e))return new r("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme")}if(i&&!e.spatialReference.equals(i))return new r("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}}.apply(null,n))||(e.exports=i)},1766:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(251),r(9),r(8),r(125)],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0}),t.checkArcGISServiceVersionCompatibility=function(e){if(!a.isHostedAgolService(e.url)){if(e.version<10.22){var t=new n("layerview:service-version-too-old","Tiled Map Layers on servers prior to 10.2.2 are not supported. Detected version: "+e.version,{minVersion:10.22,detectedVersion:e.version});return i.reject(t)}if(10.22!==e.version||a.isHostedSecuredProxyService(e.url,e.get("portalItem.id")))return i.resolve();var o=function(e){var t=null,r=e.search(/\/rest\/services\//i);return r>0&&(t=e.substring(0,r+6)),t}(e.url),l=new n("tiledlayerview3d:service-missing-cors-patch","Tiled Map Layers from 10.2.2 servers are only supported if all server updates have been applied.");return r(o+"self?f=json",{headers:{"X-Requested-With":null},timeout:1e4,handleAs:"json"}).then(function(e){if(!e||e.error)throw l}).catch(function(){throw l})}},t.throwIfError=function(e){if(e)throw e}}.apply(null,n))||(e.exports=i)},2350:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(9),r(8),r(15),r(0),r(1643),r(1766)],void 0===(i=function(e,t,r,n,i,a,o,l,s,c){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.initialize=function(){var e=this,t=this.get("view.map.ground.layers"),r=this.get("view.map.allLayers"),n=r&&r.includes(this.layer),l=t&&t.includes(this.layer);if(n&&!l){var s=new i("layerview:elevation-layer-only","3D elevation layer '"+this.layer.id+"' can only be added in the map ground");this.addResolvingPromise(a.reject(s))}var u=this._getTileInfoSupportError(this.tileInfo,this.layer.fullExtent);if(u)this.addResolvingPromise(a.reject(u));else{var p=o.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){var t=e.view.basemapTerrain.tilingScheme;c.throwIfError(e._getTileInfoCompatibilityError(e.tileInfo,t))});this.addResolvingPromise(p)}this.addResolvingPromise(c.checkArcGISServiceVersionCompatibility(this.layer)),this._updateMinMaxDataLevel()},n([l.property({aliasOf:"layer.fullExtent"})],t.prototype,"fullExtent",void 0),n([l.property()],t.prototype,"layer",void 0),n([l.property({aliasOf:"layer.tileInfo"})],t.prototype,"tileInfo",void 0),n([l.subclass("esri.views.3d.layers.ElevationLayerView3D")],t)}(l.declared(s))}.apply(null,n))||(e.exports=i)}}]);