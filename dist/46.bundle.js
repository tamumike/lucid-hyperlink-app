(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/sources/support/CSVSourceWorker":525,"esri/views/3d/layers/SceneLayerWorker":1325,"esri/views/3d/layers/PointCloudWorker":1327,"esri/views/vectorTiles/WorkerTileHandler":1343,"esri/views/2d/layers/features/Pipeline":1344,"esri/views/webgl/Util":1365,"esri/views/3d/support/buffer/typedArrayUtil":1378,"esri/views/vectorTiles/GeometryUtils":1402,"esri/views/2d/engine/webgl/definitions":1403,"esri/core/asyncUtils":1404,"esri/views/3d/support/orientedBoundingBox":1427,"esri/views/3d/layers/i3s/I3SBinaryReader":1435,"esri/views/2d/engine/webgl/Rect":1526,"esri/views/2d/engine/webgl/Geometry":1529,"esri/views/2d/engine/webgl/GeometryUtils":1532,"esri/views/3d/layers/i3s/LEPCC":1543,"esri/core/sql/WhereGrammar":1546,"esri/views/2d/layers/features/support/Tile":1549,"esri/views/2d/engine/webgl/TileClipper":1553,"esri/views/2d/support/Evented":1555,"esri/views/3d/support/dito":1556,"esri/core/sql/WhereClause":1557,"esri/core/sql/AggregateFunctions":1558,"esri/core/sql/StandardizedFunctions":1559,"esri/views/3d/layers/i3s/I3SProjectionUtil":1609,"esri/views/2d/layers/features/support/TileStore":1633,"esri/renderers/PointCloudRenderer":1634,"esri/views/2d/engine/webgl/TextShaping":1666,"esri/views/2d/engine/webgl/LineTess":1667,"esri/renderers/support/pointCloud/PointSizeAlgorithm":1673,"esri/views/3d/layers/i3s/I3SGeometryUtil":1674,"esri/layers/graphics/data/FeatureStore":1676,"esri/layers/graphics/data/attributeSupport":1677,"esri/views/vectorTiles/MemoryBuffer":1704,"esri/layers/graphics/data/QueryEngine":1705,"esri/views/vectorTiles/Bucket":1725,"esri/views/vectorTiles/style/StyleLayer":1726,"esri/renderers/PointCloudClassBreaksRenderer":1727,"esri/renderers/support/pointCloud/PointSizeFixedSizeAlgorithm":1728,"esri/renderers/support/pointCloud/PointSizeSplatAlgorithm":1729,"esri/renderers/PointCloudStretchRenderer":1730,"esri/renderers/PointCloudUniqueValueRenderer":1731,"esri/layers/graphics/data/utils":1732,"esri/views/2d/layers/features/controllers":1776,"esri/views/3d/layers/i3s/PointCloudRendererUtil":1777,"esri/views/2d/tiling/enums":1812,"esri/views/vectorTiles/style/Filter":1813,"esri/views/vectorTiles/style/StyleDefinition":1814,"esri/views/vectorTiles/style/StyleProperty":1815,"esri/views/vectorTiles/style/StyleRepository":1816,"esri/renderers/support/pointCloud/ColorModulation":1817,"esri/renderers/support/pointCloud/pointSizeAlgorithmJSONUtils":1818,"esri/renderers/support/pointCloud/pointSizeAlgorithmTypeUtils":1819,"esri/renderers/support/pointCloud/ColorClassBreakInfo":1820,"esri/renderers/support/pointCloud/StopInfo":1821,"esri/renderers/support/pointCloud/ColorUniqueValueInfo":1822,"dstore/Csv":1826,"esri/layers/graphics/data/QueryEngineResult":1827,"esri/layers/graphics/data/AttributesBuilder":1828,"esri/layers/graphics/data/spatialQuerySupport":1829,"esri/views/vectorTiles/FillBucket":1908,"esri/core/executeAsync":1909,"esri/views/vectorTiles/BackgroundBucket":1910,"esri/views/vectorTiles/CircleBucket":1911,"esri/views/vectorTiles/LineBucket":1912,"esri/views/vectorTiles/Placement":1913,"esri/views/vectorTiles/SymbolBucket":1914,"esri/views/vectorTiles/WorkerTile":2255,"esri/views/vectorTiles/IndexMemoryBuffer":2256,"esri/views/vectorTiles/Conflict":2257,"esri/views/vectorTiles/TileParser":2258,"esri/views/vectorTiles/Feature":2259,"esri/views/vectorTiles/SourceLayerData":2260,"esri/views/vectorTiles/VertexMemoryBuffer":2261,"esri/views/2d/layers/features/processors":2262})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[46,11,14,55],{1325:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8),r(34),r(19),r(1674),r(1609),r(1635),r(1427),r(80),r(1527),r(1355)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,f){var h=function(){function e(){}return e.prototype.process=function(e){var t=[e.geometryBuffer];return r.resolve({result:this.transform(e,t),transferList:t})},e.prototype.transform=function(e,t){var r=i.fromJSON(e.indexSR),h=i.fromJSON(e.vertexSR),v=i.fromJSON(e.renderSR),y=!1,m=0,g=[],x=a.computeGlobalTransformation(e.mbs,e.elevationOffset,r,v),_=e.obb?null:u.create([0,0,0],[-1,-1,-1],[0,0,0,1]);n.vec3.copy(p,e.mbs),p[2]+=e.elevationOffset,n.vec3.copy(d,p);for(var b=0,I=e.geometryData;b<I.length;b++)for(var w=I[b],C=w.geometries,P=w.componentOffsets,T=0,S=C;T<S.length;T++){var D=S[T],A=e.layouts[m];++m;var M=[{name:f.VertexAttrConstants.COLOR,byteValue:255}],E=[f.VertexAttrConstants.NORMAL,f.VertexAttrConstants.NORMALCOMPRESSED,f.VertexAttrConstants.SYMBOLCOLOR,f.VertexAttrConstants.COMPONENTINDEX],B=o.interleaveGeometryBuffer(D,e.geometryBuffer,A,M,E),N=new c(new Float32Array(B),A,void 0,void 0,void 0,!0),V=N.getAttribute(f.VertexAttrConstants.POSITION);if(a.reprojectPoints(V,e.mbs,x,e.elevationOffset,r,h,v),_&&this._updateObb(_,V,x),e.needNormals){var O={normals:N.getAttribute(f.VertexAttrConstants.NORMALCOMPRESSED),positions:V,normalInd:N.getIndices(f.VertexAttrConstants.NORMALCOMPRESSED),positionInd:N.getIndices(f.VertexAttrConstants.POSITION)};o.processAndInterleaveNormals(e.normalReferenceFrame,D,e.geometryBuffer,x,O)}var L=N.getAttribute(f.VertexAttrConstants.COMPONENTINDEX);L&&this._createComponentNumbers(L,P);var F=N.getAttribute(f.VertexAttrConstants.COLOR);F&&!y&&(y=this._hasColors(F));var z={globalTrafo:x},R=A[0].stride,j=1-.8*R/(R+4),k=s.deduplicate(B,R/4,j);if(null!=k){var U=k.uniqueCount<65536?new Uint16Array(k.indices):k.indices,Y=o.extractPositionData(k.buffer,A,U);g.push({layout:A,interleavedVertexData:k.buffer,indices:U,corMatrices:z,hasColors:y,positionData:Y}),t&&(t.push(k.buffer),t.push(U.buffer),t.push(Y.data.buffer),t.push(Y.indices.buffer))}else{Y=o.extractPositionData(B,A);g.push({layout:A,interleavedVertexData:B,corMatrices:z,hasColors:y,positionData:Y}),t&&(t.push(B),t.push(Y.data.buffer),t.push(Y.indices.buffer))}}return _&&(n.vec3.transformMat4(_.center,_.center,x),l.vectorToVector(_.center,v,_.center,r),_.center[2]-=e.elevationOffset),{geometryBuffer:e.geometryBuffer,transformedGeometries:g,obb:_}},e.prototype._hasColors=function(e){for(var t=e.data,r=e.size,n=e.offsetIdx,i=e.strideIdx,o=n;o<t.length;o+=i)for(var a=0;a<r;a++)if(255!==t[o+a])return!0;return!1},e.prototype._createComponentNumbers=function(e,t){for(var r=e.data,n=e.offsetIdx,i=e.strideIdx,o=r.length/i,a=0,s=n,u=0;u<o;u++)u>=t[a+1]&&a++,r[s]=a,s+=i},e.prototype._updateObb=function(e,t,r){if(e.halfSize[0]>0){n.vec3.subtract(p,e.center,e.halfSize),n.vec3.add(d,e.center,e.halfSize);for(var i=t.offsetIdx;i<t.data.length;i+=t.strideIdx)p[0]=Math.min(p[0],t.data[i]),p[1]=Math.min(p[1],t.data[i+1]),p[2]=Math.min(p[2],t.data[i+2]),d[0]=Math.max(d[0],t.data[i]),d[1]=Math.max(d[1],t.data[i+1]),d[2]=Math.max(d[2],t.data[i+2]);n.vec3.subtract(e.halfSize,d,p),n.vec3.scale(e.halfSize,e.halfSize,.5),n.vec3.add(e.center,p,d),n.vec3.scale(e.center,e.center,.5)}else{u.compute(t,e);var o=2*Math.sqrt(1+r[0]+r[5]+r[10]);v[0]=(r[9]-r[6])/o,v[1]=(r[2]-r[8])/o,v[2]=(r[4]-r[1])/o,v[3]=.25*o,n.quat.conjugate(v,v),n.quat.multiply(e.quaternion,v,e.quaternion)}},e}(),p=n.vec3f64.create(),d=n.vec3f64.create(),v=n.quatf32.create();return h}.apply(null,n))||(e.exports=i)},1327:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8),r(34),r(19),r(1435),r(1543),r(1777),r(80)],void 0===(i=function(e,t,r,n,i,o,a,s,u){var l=function(){function e(){}return e.prototype.transform=function(e,t){return this.thread?this.thread.invoke("_process",e,{transferList:t}):r.resolve(this._transform(e))},e.prototype._process=function(e){var t=this._transform(e);return r.resolve({result:t,transferList:[t.points.buffer,t.rgb.buffer]})},e.prototype._transform=function(e){var t=this.readGeometry(e.schema,e.geometryBuffer),r=t.length/3,n=s.evaluateRenderer(e.rendererInfo,e.primaryAttribute,e.modulationAttribute,t,r);e.filterInfo&&e.filterInfo.length>0&&(r=s.filterInPlace(t,n,e.filterInfo,e.filterAttributes)),3*r<n.length&&(n=new Uint8Array(n.buffer.slice(0,3*r))),this._applyElevationOffsetInPlace(t,r,e.elevationOffset);var o=this._transformCoordinates(t,r,e.obb,i.fromJSON(e.inSR),i.fromJSON(e.outSR));return{obb:e.obb,points:o,rgb:n}},e.prototype.readGeometry=function(e,t){if(null==e.encoding||""===e.encoding){for(var r=o.createGeometryDataIndex(t,e,!1),n=o.createTypedView(t,r.vertexAttributes.position),i=r.header.fields,s=[i.offsetX,i.offsetY,i.offsetZ],u=[i.scaleX,i.scaleY,i.scaleZ],l=n.length/3,c=new Float64Array(3*l),f=0;f<l;f++)c[3*f]=n[3*f]*u[0]+s[0],c[3*f+1]=n[3*f+1]*u[1]+s[1],c[3*f+2]=n[3*f+2]*u[2]+s[2];return c}if("lepcc-xyz"===e.encoding)return a.decodeXYZ(t).result},e.prototype._transformCoordinates=function(e,t,r,i,o){if(!u.bufferToBuffer(e,i,0,e,o,0,t))throw Error("Can't reproject");var a=n.vec3f32.fromValues(r.center[0],r.center[1],r.center[2]),s=n.vec3f32.create(),l=n.vec3f32.create();n.quat.conjugate(c,r.quaternion);for(var f=new Float32Array(3*t),h=0;h<t;h++)s[0]=e[3*h]-a[0],s[1]=e[3*h+1]-a[1],s[2]=e[3*h+2]-a[2],n.vec3.transformQuat(l,s,c),r.halfSize[0]=Math.max(r.halfSize[0],Math.abs(l[0])),r.halfSize[1]=Math.max(r.halfSize[1],Math.abs(l[1])),r.halfSize[2]=Math.max(r.halfSize[2],Math.abs(l[2])),f[3*h]=s[0],f[3*h+1]=s[1],f[3*h+2]=s[2];return f},e.prototype._applyElevationOffsetInPlace=function(e,t,r){if(0!==r)for(var n=0;n<t;n++)e[3*n+2]+=r},e}(),c=n.quatf32.create();return l}.apply(null,n))||(e.exports=i)},1343:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(36),r(8),r(1812),r(2255),r(1816)],void 0===(i=function(e,t,r,n,i,o,a){return function(){function e(){this._tiles=new Map,this._spriteInfo={},this._glyphInfo={}}return e.prototype.reset=function(){this._spriteInfo={},this._glyphInfo={};var e=this._tiles;return e.forEach(function(e){return e.setObsolete()}),e.clear(),n.resolve()},e.prototype.getLayers=function(){return this._layers},e.prototype.setLayers=function(e){var t=new a(e);return this._layers=t.layers,n.resolve({data:""})},e.prototype.getTile=function(e,t){var a=this,s=e.key,u=e.cacheTile,l=o.pool.acquire();return l.initialize(e.key,e.refKey,this,e.rotation),r(e.url,{responseType:"array-buffer",signal:t&&t.signal}).then(function(e){return l.setDataAndParse(e.data,t)}).then(function(e){return u&&l.status!==i.TileStatus.INVALID&&a._tiles.set(s,l),e}).catch(function(e){return l.setObsolete(),o.pool.release(l),a._tiles.has(l.tileKey)&&a._tiles.delete(l.tileKey),n.reject(e)}).catch(function(e){return e}).then(function(e){return u||o.pool.release(l),e})},e.prototype.updateSymbols=function(e){var t=this._tiles.get(e.key);return t?t.updateSymbols(e.rotation):n.reject()},e.prototype.updateStyle=function(e,t){var r=new a(e);return this._layers=r.layers,this._tiles.forEach(function(e,r){e.reparse(t).then(function(r){t.client.invoke("updateTileData",{tileId:e.tileKey,tileData:r.result})})}),n.resolve({data:""})},e.prototype.destructTileData=function(e){return this._tiles.has(e)&&(o.pool.release(this._tiles.get(e)),this._tiles.delete(e)),n.resolve()},e.prototype.fetchSprites=function(e,t){var r=[],i=this._spriteInfo;return e.forEach(function(e){void 0===i[e]&&r.push(e)}),0===r.length?n.resolve():t.invoke("getSprites",r).then(function(e){for(var t in e){var r=e[t];i[t]=r}})},e.prototype.getSpriteItems=function(){return this._spriteInfo},e.prototype.fetchGlyphs=function(e,t,r,i){var o=[],a=this._glyphInfo[t];return a?r.forEach(function(e){a[e]||o.push(e)}):(a=this._glyphInfo[t]=[],r.forEach(function(e){return o.push(e)})),0===o.length?n.resolve():i.invoke("getGlyphs",{tileID:e,font:t,codePoints:o}).then(function(e){for(var t in e)a[t]=e[t]})},e.prototype.getGlyphItems=function(e){return this._glyphInfo[e]},e}()}.apply(null,n))||(e.exports=i)},1344:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(474),r(158),r(5),r(1404),r(8),r(0),r(237),r(46),r(533),r(1776),r(2262),r(1633),r(508)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,f,h,p,d,v,y){Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=null,t.processor=null,t.remoteClient=null,t.serviceAndViewInfo=null,t.tileStore=null,t.viewState=null,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.watch("updating",function(t){e.remoteClient.invoke("setUpdating",t)})},t.prototype.destroy=function(){this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){var e=this.controller,t=this.processor;return!e||!t||e.updating||t.updating||!1},enumerable:!0,configurable:!0}),t.prototype.startup=function(e){var t=new y(c.fromJSON(e.tileInfo));this.serviceAndViewInfo=e,this.tileStore=new v.default(t)},t.prototype.configure=function(e){return s.safeCast(this._configure(e))},t.prototype.setViewState=function(e){var t=h.fromJSON(e);this._set("viewState",t),this.tileStore.setViewState(t),this.controller&&this.controller.setViewState(t)},t.prototype._configure=function(e){return i(this,void 0,void 0,function(){var t,r,n;return o(this,function(i){switch(i.label){case 0:return[4,u.all([s.safeCast(this._handleControllerConfig(e.controller)),s.safeCast(this._handleProcessorConfig(e.processor))])];case 1:return t=i.sent(),r=t[0],n=t[1],(r||n)&&(this.controller.processor=this.processor),[2]}})})},t.prototype._handleControllerConfig=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return e?[2,this._createController(e)]:[2,null]})})},t.prototype._handleProcessorConfig=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(r){return e?(t=this._createProcessor(e),[2,"symbol"===e.type&&e.hasGeometryExpr?f.enableGeometryOperations().then(function(){return t}):t]):[2,null]})})},t.prototype._createController=function(e){return i(this,void 0,void 0,function(){var t,r,n,i,a,s;return o(this,function(o){switch(o.label){case 0:return r=(t=this).remoteClient,n=t.tileStore,i=t.serviceAndViewInfo,a={remoteClient:r,tileStore:n,serviceAndViewInfo:i},[4,p.createController(e.type,a)];case 1:return s=o.sent(),this.controller&&this.controller.destroy(),s.configuration=e,s.setViewState(this.viewState),this.controller=s,[2,s]}})})},t.prototype._createProcessor=function(e){return i(this,void 0,void 0,function(){var t,r,n,i,a,s;return o(this,function(o){switch(o.label){case 0:return r=(t=this).remoteClient,n=t.tileStore,i=t.serviceAndViewInfo,a={remoteClient:r,tileStore:n,serviceAndViewInfo:i},[4,d.createProcessor(e.type,a)];case 1:return s=o.sent(),this.processor&&this.processor.destroy(),s.configuration=e,this.processor=s,[2,s]}})})},n([l.property()],t.prototype,"controller",void 0),n([l.property()],t.prototype,"processor",void 0),n([l.property({dependsOn:["controller.updating","processor.updating"]})],t.prototype,"updating",null),n([l.property()],t.prototype,"viewState",void 0),n([l.subclass()],t)}(l.declared(a));t.default=m}.apply(null,n))||(e.exports=i)},1365:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(9)],void 0===(i=function(e,t,r,n){function i(e){return e[0].stride}function o(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1;default:throw new Error("Unknown data type")}}Object.defineProperty(t,"__esModule",{value:!0}),t.vertexCount=function(e,t){return e.vertexBuffers[t].size/i(e.layout[t])},t.getStride=i,t.getBytesPerElement=o,t.addDescriptor=function(e,t,r,n,i,a){var s=o(n);if(e.length>0){var u=e[0].stride,l=u+s*r;e.forEach(function(e){return e.stride=l}),e.push({name:t,count:r,type:n,offset:u,stride:l,normalized:i,divisor:a})}else e.push({name:t,count:r,type:n,offset:0,stride:s*r,normalized:i,divisor:a})},t.assertCompatibleVertexAttributeLocations=function(e,t){var r=e.locations===t.locations;return r||console.error("VertexAttributeLocations are incompatible"),r},t.hasAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return!0;return!1},t.findAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return e[r];return null},t.copyFramebufferToTexture=function(e,t,r,n,i){void 0===i&&(i=0);var o=e.getBoundFramebufferObject(),a=e.getBoundTexture(0);e.bindFramebuffer(t),e.bindTexture(r,0),e.gl.copyTexImage2D(e.gl.TEXTURE_2D,i,r.descriptor.pixelFormat,n[0],n[1],n[2],n[3],0),e.gl.flush(),e.bindFramebuffer(o),e.bindTexture(a,0)},t.assert=function(e,t){if(!e)throw new n(t)},t.setBaseInstanceOffset=function(e,t){var n={};for(var i in e)n[i]=e[i].map(function(e){return e.divisor?r({},e,{baseInstance:t}):e});return n},t.bindVertexBufferLayout=function(e,t,r,n,i){var o=e.gl,a=e.capabilities.instancing;e.bindBuffer(r),n.forEach(function(e){var r=t[e.name],n=(i||(0+e.baseInstance?e.baseInstance:0))*e.stride;if(void 0===r&&console.error("There is no location for vertex attribute '"+e.name+"' defined."),e.baseInstance&&!e.divisor&&console.error("Vertex attribute '"+e.name+"' uses baseInstanceOffset without divisor."),e.count<=4)o.vertexAttribPointer(r,e.count,e.type,e.normalized,e.stride,e.offset+n),o.enableVertexAttribArray(r),e.divisor&&e.divisor>0&&a&&a.vertexAttribDivisor(r,e.divisor);else if(9===e.count)for(var s=0;s<3;s++)o.vertexAttribPointer(r+s,3,e.type,e.normalized,e.stride,e.offset+12*s+n),o.enableVertexAttribArray(r+s),e.divisor&&e.divisor>0&&a&&a.vertexAttribDivisor(r+s,e.divisor);else if(16===e.count)for(s=0;s<4;s++)o.vertexAttribPointer(r+s,4,e.type,e.normalized,e.stride,e.offset+16*s+n),o.enableVertexAttribArray(r+s),e.divisor&&e.divisor>0&&a&&a.vertexAttribDivisor(r+s,e.divisor);else console.error("Unsupported vertex attribute element count: "+e.count)})},t.unbindVertexBufferLayout=function(e,t,r,n){var i=e.gl,o=e.capabilities.instancing;e.bindBuffer(r),n.forEach(function(e){var r=t[e.name];if(e.count<=4)i.disableVertexAttribArray(r),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(r,0);else if(9===e.count)for(var n=0;n<3;n++)i.disableVertexAttribArray(r+n),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(r+n,0);else if(16===e.count)for(n=0;n<4;n++)i.disableVertexAttribArray(r+n),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(r+n,0);else console.error("Unsupported vertex attribute element count: "+e.count)}),e.unbindBuffer(34962)}}.apply(null,n))||(e.exports=i)},1378:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=function(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r],r,e)},t.slice=function(e,t,r){if(e.slice)return e.slice(t,r);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===r?r=e.length:(r<0&&(r+=e.length),r=Math.min(e.length,Math.max(0,r)));for(var n=Math.max(0,r-t),i=new(0,e.constructor)(n),o=0;o<n;o++)i[o]=e[t+o];return i},t.isArrayBuffer=function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name},t.isInt8Array=function(e){return e instanceof Int8Array||e&&e.constructor&&"Int8Array"===e.constructor.name},t.isUint8Array=function(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name},t.isInt16Array=function(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name},t.isUint16Array=function(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name},t.isInt32Array=function(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name},t.isUint32Array=function(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name},t.isFloat32Array=function(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name},t.isFloat64Array=function(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name},t.toArray=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}}.apply(null,n))||(e.exports=i)},1402:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=r,t.radToByte=function(e){return r(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return r(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}.apply(null,n))||(e.exports=i)},1403:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=32,t.COLLISION_BOX_PADDING=8,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0}.apply(null,n))||(e.exports=i)},1404:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(158),r(474),r(8)],void 0===(i=function(e,t,r,n,i){function o(e){return e}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=function(e,t,r){return i.eachAlways(e.map(function(e,n){return t.apply(r,[e,n])}))},t.map=function(e,t,r){return i.eachAlways(e.map(function(e,n){return t.apply(r,[e,n])})).then(function(e){return e.map(function(e){return e.value})})},t.result=function(e){return e.then(function(e){return{ok:!0,value:e}}).catch(function(e){return{ok:!1,error:e}})},t.assertResult=function(e){if(!0===e.ok)return e.value;throw e.error},t.safeCast=o,t.safeCastCall=function(e){return o(e())},t.safeCastReturn=function(e){return e}}.apply(null,n))||(e.exports=i)},1427:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34),r(1359),r(1556),r(1368)],void 0===(i=function(e,t,r,n,i,o){function a(e,t,n){return{center:r.vec3f64.clone(e),halfSize:r.vec3f32.clone(t),quaternion:r.quatf32.clone(n)}}function s(e,t){var r=o.plane.signedDistance(t,e.center),n=u(e,t);return r>n?1:r<-n?-1:0}function u(e,t){r.quat.conjugate(l,e.quaternion),r.vec3.transformQuat(c,t,l);var n=e.halfSize;return Math.abs(c[0]*n[0])+Math.abs(c[1]*n[1])+Math.abs(c[2]*n[2])}Object.defineProperty(t,"__esModule",{value:!0});var l=r.quatf32.create(),c=r.vec3f32.create(),f=r.vec3f32.create(),h=r.mat3f32.create(),p=function(){return function(e){var t=56*e;this.buffer=new ArrayBuffer(t),this.obbs=new Array(e);for(var n=0;n<e;n++)this.obbs[n]={center:r.vec3f64.createView(this.buffer,56*n+0),halfSize:r.vec3f32.createView(this.buffer,56*n+24),quaternion:r.quatf32.createView(this.buffer,56*n+36)}}}();t.ObbArray=p,t.create=a,t.clone=function(e){return a(e.center,e.halfSize,e.quaternion)},t.set=function(e,t){r.vec3.copy(t.center,e.center),r.vec3.copy(t.halfSize,e.halfSize),r.quat.copy(t.quaternion,e.quaternion)},t.compute=function(e,t){return t||(t=a([0,0,0],[-1,-1,-1],[0,0,0,1])),i.computeOBB(e,t),t},t.intersectPlane=s,t.toAaBoundingBox=function(e,t){t||(t=n.create());var i=r.mat3.fromQuat(h,e.quaternion),o=e.halfSize[0]*Math.abs(i[0])+e.halfSize[1]*Math.abs(i[3])+e.halfSize[2]*Math.abs(i[6]),a=e.halfSize[0]*Math.abs(i[1])+e.halfSize[1]*Math.abs(i[4])+e.halfSize[2]*Math.abs(i[7]),s=e.halfSize[0]*Math.abs(i[2])+e.halfSize[1]*Math.abs(i[5])+e.halfSize[2]*Math.abs(i[8]);return t[0]=e.center[0]-o,t[1]=e.center[1]-a,t[2]=e.center[2]-s,t[3]=e.center[0]+o,t[4]=e.center[1]+a,t[5]=e.center[2]+s,t},t.minimumDistancePlane=function(e,t){return o.plane.signedDistance(t,e.center)-u(e,t)},t.maximumDistancePlane=function(e,t){return o.plane.signedDistance(t,e.center)+u(e,t)},t.isVisible=function(e,t){return s(e,t.planes[0])<=0&&s(e,t.planes[1])<=0&&s(e,t.planes[2])<=0&&s(e,t.planes[3])<=0&&s(e,t.planes[4])<=0&&s(e,t.planes[5])<=0},t.intersectLine=function(e,t,n,i){void 0===i&&(i=0),r.quat.conjugate(l,e.quaternion),r.vec3.subtract(c,t,e.center);for(var o=r.vec3.transformQuat(c,c,l),a=r.vec3.transformQuat(f,n,l),s=-1/0,u=1/0,h=0;h<3;h++)if(Math.abs(a[h])>1e-6){var p=(i+e.halfSize[h]-o[h])/a[h],d=(-i-e.halfSize[h]-o[h])/a[h];s=Math.max(s,Math.min(p,d)),u=Math.min(u,Math.max(p,d))}else if(o[h]>e.halfSize[h]+i||o[h]<-e.halfSize[h]-i)return!1;return s<=u}}.apply(null,n))||(e.exports=i)},1435:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9),r(4),r(7),r(1543)],void 0===(i=function(e,t,r,n,i,o){function a(e,t,n){for(var i="",o=0;o<n;){var a=e[t+o];if(a<128)i+=String.fromCharCode(a),o++;else if(a>=192&&a<224){if(o+1>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var s=(31&a)<<6|63&e[t+o+1];i+=String.fromCharCode(s),o+=2}else if(a>=224&&a<240){if(o+2>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");s=(15&a)<<12|(63&e[t+o+1])<<6|63&e[t+o+2];i+=String.fromCharCode(s),o+=3}else{if(!(a>=240&&a<248))throw new r("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(o+3>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");if((s=(7&a)<<18|(63&e[t+o+1])<<12|(63&e[t+o+2])<<6|63&e[t+o+3])>=65536){var u=55296+(s-65536>>10),l=56320+(1023&s);i+=String.fromCharCode(u,l)}else i+=String.fromCharCode(s);o+=4}}return i}function s(e,r){for(var n={byteOffset:0,byteCount:0,fields:Object.create(null)},i=0,o=0;o<r.length;o++){var a=r[o],s=a.valueType||a.type,u=t.valueType2ArrayBufferReader[s];n.fields[a.property]=u(e,i),i+=t.valueType2TypedArrayClassMap[s].BYTES_PER_ELEMENT}return n.byteCount=i,n}function u(e,t,n){var i,o,s=[],u=0;for(o=0;o<e;o+=1){if((i=t[o])>0){if(s.push(a(n,u,i-1)),0!==n[u+i-1])throw new r("string-array-error","Invalid string array: missing null termination.")}else s.push(null);u+=i}return s}function l(e,r){return new(0,t.valueType2TypedArrayClassMap[r.valueType])(e,r.byteOffset,r.count*r.valuesPerElement)}function c(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function f(e,t,i){for(var o=null!=t.header?s(e,t.header):{byteOffset:0,byteCount:0,fields:{count:i}},a={header:o,byteOffset:o.byteCount,byteCount:0,entries:Object.create(null)},u=o.byteCount,l=0;l<t.ordering.length;l++){var c=t.ordering[l],f=n.clone(t[c]);if(f.count=o.fields.count,"String"===f.valueType){if(f.byteOffset=u,f.byteCount=o.fields[c+"ByteCount"],"UTF-8"!==f.encoding)throw new r("unsupported-encoding","Unsupported String encoding.",{encoding:f.encoding})}else{if(!p(f.valueType))throw new r("unsupported-value-type","Unsupported binary valueType",{valueType:f.valueType});var h=d(f.valueType);u+=u%h!=0?h-u%h:0,f.byteOffset=u,f.byteCount=h*f.valuesPerElement*f.count}u+=f.byteCount,a.entries[c]=f}return a.byteCount=u-a.byteOffset,a}function h(e,t,n){if(t!==e&&v.error("Invalid "+n+" buffer size\n expected: "+e+", actual: "+t+")"),t<e)throw new r("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function p(e){return t.valueType2TypedArrayClassMap.hasOwnProperty(e)}function d(e){return p(e)&&t.valueType2TypedArrayClassMap[e].BYTES_PER_ELEMENT}Object.defineProperty(t,"__esModule",{value:!0});var v=i.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");t.readHeader=s,t.readStringArray=u,t.createTypedView=l,t.createRawView=c,t.createAttributeDataIndex=f,t.createGeometryDataIndex=function(e,t,r){var i=s(e,t&&t.header),o=i.byteCount,a={header:i,byteOffset:i.byteCount,byteCount:0,vertexAttributes:n.clone(t.vertexAttributes)},u=a.vertexAttributes;r||null==u.region||delete u.region;for(var l=i.fields,c=null!=l.vertexCount?l.vertexCount:l.count,f=0;f<t.ordering.length;f++){var p=t.ordering[f];null!=u[p]&&(u[p].byteOffset=o,u[p].count=c,o+=d(u[p].valueType)*u[p].valuesPerElement*c)}var v=l.faceCount;if(t.faces&&v){a.faces=n.clone(t.faces);var y=a.faces;for(f=0;f<t.ordering.length;f++){var m=t.ordering[f];null!=y[m]&&(y[m].byteOffset=o,y[m].count=v,o+=d(y[m].valueType)*y[m].valuesPerElement*v)}}var g=l.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&g){a.featureAttributes=n.clone(t.featureAttributes);var x=a.featureAttributes;for(f=0;f<t.featureAttributeOrder.length;f++){var _=t.featureAttributeOrder[f];x[_].byteOffset=o,x[_].count=g;var b=d(x[_].valueType);"UInt64"===x[_].valueType&&(b=8),o+=b*x[_].valuesPerElement*g}}return h(o,e.byteLength,"geometry"),a.byteCount=o-a.byteOffset,a},t.readBinaryAttribute=function(e,t,n){if("lepcc-rgb"===e.encoding)return o.decodeRGB(t);if("lepcc-intensity"===e.encoding)return o.decodeIntensity(t);if(null!=e.encoding&&""!==e.encoding)throw new r("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(v.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(v.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");var i=f(t,e,n);h(i.byteOffset+i.byteCount,t.byteLength,"attribute");var a=i.entries.attributeValues||i.entries.objectIds;if(a){if("String"===a.valueType){var s=i.entries.attributeByteCounts,p=l(t,s),d=c(t,a);return u(s.count,p,d)}return l(t,a)}throw new r("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},t.valueType2ArrayBufferReader={Float32:function(e,t){return new DataView(e,0).getFloat32(t,!0)},Float64:function(e,t){return new DataView(e,0).getFloat64(t,!0)},UInt8:function(e,t){return new DataView(e,0).getUint8(t)},Int8:function(e,t){return new DataView(e,0).getInt8(t)},UInt16:function(e,t){return new DataView(e,0).getUint16(t,!0)},Int16:function(e,t){return new DataView(e,0).getInt16(t,!0)},UInt32:function(e,t){return new DataView(e,0).getUint32(t,!0)},Int32:function(e,t){return new DataView(e,0).getInt32(t,!0)}},t.isValueType=p,t.getBytesPerValue=d}.apply(null,n))||(e.exports=i)},1526:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=r,this.height=n}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=i)},1529:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);this.x/=r,this.y/=r},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var r=this.x,n=this.y;this.x=r*e-n*t,this.y=r*t+n*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)},e.add=function(t,r){return new e(t.x+r.x,t.y+r.y)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y)},e}();t.Point=r}.apply(null,n))||(e.exports=i)},1532:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var r=1/Math.LN2;function n(e,t){return 0<=(e%=t)?e:e+t}t.positiveMod=n,t.radToByte=function(e){return n(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return n(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*r},t.sqr=function(e){return e*e},t.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return t<=e&&e<=r||r<=e&&e<=t}}.apply(null,n))||(e.exports=i)},1543:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9)],void 0===(i=function(e,t,r){function n(e,t,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,r+c.identifierOffset,c.identifierLength)),version:t.getUint16(r+c.versionOffset,l),checksum:t.getUint32(r+c.checksumOffset,l)}}function i(e,t){return{sizeLo:e.getUint32(t+f.sizeLo,l),sizeHi:e.getUint32(t+f.sizeHi,l),minX:e.getFloat64(t+f.minX,l),minY:e.getFloat64(t+f.minY,l),minZ:e.getFloat64(t+f.minZ,l),maxX:e.getFloat64(t+f.maxX,l),maxY:e.getFloat64(t+f.maxY,l),maxZ:e.getFloat64(t+f.maxZ,l),errorX:e.getFloat64(t+f.errorX,l),errorY:e.getFloat64(t+f.errorY,l),errorZ:e.getFloat64(t+f.errorZ,l),count:e.getUint32(t+f.count,l),reserved:e.getUint32(t+f.reserved,l)}}function o(e,t,r){var n=[];t=a(e,t,n);for(var i=[],o=0;o<n.length;o++){i.length=0,t=a(e,t,i);for(var s=0;s<i.length;s++)r.push(i[s]+n[o])}return t}function a(e,t,n){var i=new DataView(e,t),o=i.getUint8(0),a=31&o,s=!!(32&o),u=(192&o)>>6,c=0;if(0===u)c=i.getUint32(1,l),t+=5;else if(1===u)c=i.getUint16(1,l),t+=3;else{if(2!==u)throw new r("lepcc-decode-error","Bad count type");c=i.getUint8(1),t+=2}if(s)throw new r("lepcc-decode-error","LUT not implemented");for(var f=Math.ceil(c*a/8),h=new Uint8Array(e,t,f),p=0,d=0,v=0,y=-1>>>32-a,m=0;m<c;m++){for(;d<a;)p|=h[v]<<d,d+=8,v+=1;n[m]=p&y,p>>>=a,(d-=a)+a>32&&(p|=h[v-1]>>8-d)}return t+v}function s(e,t){return{sizeLo:e.getUint32(t+h.sizeLo,l),sizeHi:e.getUint32(t+h.sizeHi,l),count:e.getUint32(t+h.count,l),colorMapCount:e.getUint16(t+h.colorMapCount,l),lookupMethod:e.getUint8(t+h.lookupMethod),compressionMethod:e.getUint8(t+h.compressionMethod)}}function u(e,t){return{sizeLo:e.getUint32(t+p.sizeLo,l),sizeHi:e.getUint32(t+p.sizeHi,l),count:e.getUint32(t+p.count,l),scaleFactor:e.getUint16(t+p.scaleFactor,l),bitsPerPoint:e.getUint8(t+p.bitsPerPoint),reserved:e.getUint8(t+p.reserved)}}Object.defineProperty(t,"__esModule",{value:!0});var l=!0,c={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16},f={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};t.decodeXYZ=function(e){var t=new DataView(e,0),a=0,s=n(e,t,a),u=s.identifier,l=s.version;if(a+=c.byteCount,"LEPCC     "!==u)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var h=i(t,a);if(a+=f.byteCount,h.sizeHi*Math.pow(2,32)+h.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var p=new Float64Array(3*h.count),d=[],v=[],y=[],m=[];if((a=o(e,a=o(e,a=o(e,a=o(e,a,d),v),y),m))!==e.byteLength)throw new r("lepcc-decode-error","Bad length");for(var g=0,x=0,_=0;_<d.length;_++){x+=d[_];for(var b=0,I=0;I<v[_];I++){b+=y[g];var w=m[g];p[3*g]=Math.min(h.maxX,h.minX+2*h.errorX*b),p[3*g+1]=Math.min(h.maxY,h.minY+2*h.errorY*x),p[3*g+2]=Math.min(h.maxZ,h.minZ+2*h.errorZ*w),g++}}return{errorX:h.errorX,errorY:h.errorY,errorZ:h.errorZ,result:p}};var h={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};t.decodeRGB=function(e){var t=new DataView(e,0),i=0,o=n(e,t,i),a=o.identifier,u=o.version;if(i+=c.byteCount,"ClusterRGB"!==a)throw new r("lepcc-decode-error","Bad identifier");if(u>1)throw new r("lepcc-decode-error","Unknown version");var l=s(t,i);if(i+=h.byteCount,l.sizeHi*Math.pow(2,32)+l.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");if(2!==l.lookupMethod&&1!==l.lookupMethod||0!==l.compressionMethod){if(0===l.lookupMethod&&0===l.compressionMethod){if(3*l.count+i!==e.byteLength||0!==l.colorMapCount)throw new r("lepcc-decode-error","Bad count");return new Uint8Array(e,i).slice()}if(l.lookupMethod<=2&&1===l.compressionMethod){if(i+3!==e.byteLength||1!==l.colorMapCount)throw new r("lepcc-decode-error","Bad count");for(var f=t.getUint8(i),p=t.getUint8(i+1),d=t.getUint8(i+2),v=new Uint8Array(3*l.count),y=0;y<l.count;y++)v[3*y]=f,v[3*y+1]=p,v[3*y+2]=d;return v}throw new r("lepcc-decode-error","Bad method "+l.lookupMethod+","+l.compressionMethod)}if(3*l.colorMapCount+l.count+i!==e.byteLength||l.colorMapCount>256)throw new r("lepcc-decode-error","Bad count");var m=new Uint8Array(e,i,3*l.colorMapCount),g=new Uint8Array(e,i+3*l.colorMapCount,l.count);for(v=new Uint8Array(3*l.count),y=0;y<l.count;y++){var x=g[y];v[3*y]=m[3*x],v[3*y+1]=m[3*x+1],v[3*y+2]=m[3*x+2]}return v};var p={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};t.decodeIntensity=function(e){var t=new DataView(e,0),i=0,o=n(e,t,i),s=o.identifier,l=o.version;if(i+=c.byteCount,"Intensity "!==s)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var f=u(t,i);if(i+=p.byteCount,f.sizeHi*Math.pow(2,32)+f.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var h=new Uint16Array(f.count);if(8===f.bitsPerPoint){if(f.count+i!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(var d=new Uint8Array(e,i,f.count),v=0;v<f.count;v++)h[v]=d[v]*f.scaleFactor}else if(16===f.bitsPerPoint){if(2*f.count+i!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(d=new Uint16Array(e,i,f.count),v=0;v<f.count;v++)h[v]=d[v]*f.scaleFactor}else{if(a(e,i,d=[])!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(v=0;v<f.count;v++)h[v]=d[v]*f.scaleFactor}return h}}.apply(null,n))||(e.exports=i)},1546:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1550)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parse=function(e){return r.parse(e)},e}();t.WhereGrammar=n}.apply(null,n))||(e.exports=i)},1549:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(476),r(105),r(81),r(491),r(120)],void 0===(i=function(e,t,r,n,i,o,a){function s(e,t){var r=e.bounds,n=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&r[0]<=n[0]&&r[1]<=n[1]&&r[2]>=n[2]&&r[3]>=n[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=s,t.isChildOf=function(e,t){return s(t,e)};var u=function(){function e(e,t){this.bounds=i.create(),this.key=new a(0,0,0,0),this.objectIds=new r.default,this.key.set(t);var n=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=n.resolution,this.scale=n.scale,this.level=n.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),r=n.acquire(),i=0;i<t.length;i++)r[i]=new e(this.tileInfoView,t[i]);return r},e.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=u,t.default=u}.apply(null,n))||(e.exports=i)},1550:function(e,t,r){var n;void 0===(n=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function o(e){return a[e.type](e)}var a={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=o(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){function n(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function o(e){var r,n=di[e];if(n)return n;for(r=e-1;!di[r];)r--;for(n={line:(n=di[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return di[e]=n,n}function a(e,t){var r=o(e),n=o(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function s(e){pi<vi||(pi>vi&&(vi=pi,yi=[]),yi.push(e))}function u(){var e,t;return e=pi,fe()!==me&&(t=c())!==me&&fe()!==me?e=_e(t):(pi=e,e=me),e}function l(){var e,t,r,n,i,o,a,s;if(e=pi,(t=c())!==me){for(r=[],n=pi,(i=fe())!==me&&(o=ue())!==me&&(a=fe())!==me&&(s=c())!==me?n=i=[i,o,a,s]:(pi=n,n=me);n!==me;)r.push(n),n=pi,(i=fe())!==me&&(o=ue())!==me&&(a=fe())!==me&&(s=c())!==me?n=i=[i,o,a,s]:(pi=n,n=me);r!==me?e=t=be(t,r):(pi=e,e=me)}else pi=e,e=me;return e}function c(){var e,t,r,n,i,o,a,s;if(e=pi,(t=f())!==me){for(r=[],n=pi,(i=fe())!==me&&(o=Z())!==me&&(a=fe())!==me&&(s=f())!==me?n=i=[i,o,a,s]:(pi=n,n=me);n!==me;)r.push(n),n=pi,(i=fe())!==me&&(o=Z())!==me&&(a=fe())!==me&&(s=f())!==me?n=i=[i,o,a,s]:(pi=n,n=me);r!==me?e=t=Ie(t,r):(pi=e,e=me)}else pi=e,e=me;return e}function f(){var e,t,r,n,i,o,a,s;if(e=pi,(t=h())!==me){for(r=[],n=pi,(i=fe())!==me&&(o=Q())!==me&&(a=fe())!==me&&(s=h())!==me?n=i=[i,o,a,s]:(pi=n,n=me);n!==me;)r.push(n),n=pi,(i=fe())!==me&&(o=Q())!==me&&(a=fe())!==me&&(s=h())!==me?n=i=[i,o,a,s]:(pi=n,n=me);r!==me?e=t=Ie(t,r):(pi=e,e=me)}else pi=e,e=me;return e}function h(){var e,r,n,i,o;return e=pi,(r=q())===me&&(r=pi,33===t.charCodeAt(pi)?(n=we,pi++):(n=me,0===mi&&s(Ce)),n!==me?(i=pi,mi++,61===t.charCodeAt(pi)?(o=Pe,pi++):(o=me,0===mi&&s(Te)),mi--,o===me?i=void 0:(pi=i,i=me),i!==me?r=n=[n,i]:(pi=r,r=me)):(pi=r,r=me)),r!==me&&(n=fe())!==me&&(i=h())!==me?e=r=Se(i):(pi=e,e=me),e===me&&(e=function(){var e,t,r;return e=pi,(t=y())!==me&&fe()!==me?((r=function(){var e;return(e=function(){var e,t,r,n,i,o;if(pi,e=[],t=pi,(r=fe())!==me&&(n=p())!==me&&(i=fe())!==me&&(o=y())!==me?t=r=[r,n,i,o]:(pi=t,t=me),t!==me)for(;t!==me;)e.push(t),t=pi,(r=fe())!==me&&(n=p())!==me&&(i=fe())!==me&&(o=y())!==me?t=r=[r,n,i,o]:(pi=t,t=me);else e=me;return e!==me&&(e=Ae(e)),e}())===me&&(e=function(){var e,t,r,n;return e=pi,(t=v())!==me&&fe()!==me&&(r=le())!==me&&fe()!==me&&(n=l())!==me&&fe()!==me&&ce()!==me?(t=Xe(t,n),e=t):(pi=e,e=me),e===me&&(e=pi,(t=v())!==me&&fe()!==me&&(r=le())!==me&&fe()!==me&&(n=ce())!==me?(t=He(t),e=t):(pi=e,e=me),e===me&&(e=pi,(t=v())!==me&&fe()!==me&&(r=P())!==me?(t=We(t,r),e=t):(pi=e,e=me))),e}())===me&&(e=function(){var e,t,r,n,i,o;return e=pi,(t=q())!==me&&fe()!==me&&(r=J())!==me&&fe()!==me&&(n=y())!==me&&fe()!==me&&(i=Q())!==me&&fe()!==me&&(o=y())!==me?(t=Ge(r,n,o),e=t):(pi=e,e=me),e===me&&(e=pi,(t=J())!==me&&fe()!==me&&(r=y())!==me&&fe()!==me&&(n=Q())!==me&&fe()!==me&&(i=y())!==me?(t=qe(t,r,i),e=t):(pi=e,e=me)),e}())===me&&(e=function(){var e,t,r,n;return e=pi,(t=U())!==me&&fe()!==me&&(r=q())!==me&&fe()!==me&&(n=y())!==me?(t=Ue(t,n),e=t):(pi=e,e=me),e===me&&(e=pi,(t=U())!==me&&fe()!==me&&(r=y())!==me?(t=Ye(t,r),e=t):(pi=e,e=me)),e}())===me&&(e=function(){var e,t,r,n;return e=pi,(t=d())!==me&&fe()!==me&&(r=S())!==me&&fe()!==me&&G()!==me&&fe()!==me&&(n=D())!==me?(t=Ze(t,r,n),e=t):(pi=e,e=me),e===me&&(e=pi,(t=d())!==me&&fe()!==me&&(r=S())!==me?(t=Je(t,r),e=t):(pi=e,e=me)),e}()),e}())===me&&(r=null),r!==me?(t=De(t,r),e=t):(pi=e,e=me)):(pi=e,e=me),e}()),e}function p(){var e;return t.substr(pi,2)===Me?(e=Me,pi+=2):(e=me,0===mi&&s(Ee)),e===me&&(62===t.charCodeAt(pi)?(e=Be,pi++):(e=me,0===mi&&s(Ne)),e===me&&(t.substr(pi,2)===Ve?(e=Ve,pi+=2):(e=me,0===mi&&s(Oe)),e===me&&(t.substr(pi,2)===Le?(e=Le,pi+=2):(e=me,0===mi&&s(Fe)),e===me&&(60===t.charCodeAt(pi)?(e=ze,pi++):(e=me,0===mi&&s(Re)),e===me&&(61===t.charCodeAt(pi)?(e=Pe,pi++):(e=me,0===mi&&s(Te)),e===me&&(t.substr(pi,2)===je?(e=je,pi+=2):(e=me,0===mi&&s(ke)))))))),e}function d(){var e,t,r,n,i;return e=pi,t=pi,(r=q())!==me&&(n=fe())!==me&&(i=Y())!==me?t=r=[r,n,i]:(pi=t,t=me),t!==me&&(t=Qe(t)),(e=t)===me&&(e=Y()),e}function v(){var e,t,r,n,i;return e=pi,t=pi,(r=q())!==me&&(n=fe())!==me&&(i=k())!==me?t=r=[r,n,i]:(pi=t,t=me),t!==me&&(t=Qe(t)),(e=t)===me&&(e=k()),e}function y(){var e,t,r,n,i,o,a,s;if(e=pi,(t=g())!==me){for(r=[],n=pi,(i=fe())!==me&&(o=m())!==me&&(a=fe())!==me&&(s=g())!==me?n=i=[i,o,a,s]:(pi=n,n=me);n!==me;)r.push(n),n=pi,(i=fe())!==me&&(o=m())!==me&&(a=fe())!==me&&(s=g())!==me?n=i=[i,o,a,s]:(pi=n,n=me);r!==me?e=t=Ie(t,r):(pi=e,e=me)}else pi=e,e=me;return e}function m(){var e;return 43===t.charCodeAt(pi)?(e=Ke,pi++):(e=me,0===mi&&s($e)),e===me&&(45===t.charCodeAt(pi)?(e=et,pi++):(e=me,0===mi&&s(tt))),e}function g(){var e,t,r,n,i,o,a,s;if(e=pi,(t=_())!==me){for(r=[],n=pi,(i=fe())!==me&&(o=x())!==me&&(a=fe())!==me&&(s=_())!==me?n=i=[i,o,a,s]:(pi=n,n=me);n!==me;)r.push(n),n=pi,(i=fe())!==me&&(o=x())!==me&&(a=fe())!==me&&(s=_())!==me?n=i=[i,o,a,s]:(pi=n,n=me);r!==me?e=t=rt(t,r):(pi=e,e=me)}else pi=e,e=me;return e}function x(){var e;return 42===t.charCodeAt(pi)?(e=nt,pi++):(e=me,0===mi&&s(it)),e===me&&(47===t.charCodeAt(pi)?(e=ot,pi++):(e=me,0===mi&&s(at))),e}function _(){var e,t;return(e=function(){var e;return(e=D())===me&&(e=function(){var e,t,r,n;return e=pi,(t=function(){var e,t,r,n;return e=pi,(t=B())!==me&&(r=N())!==me&&(n=V())!==me?(t=Jt(t,r,n),e=t):(pi=e,e=me),e===me&&(e=pi,(t=B())!==me&&(r=N())!==me?(t=Xt(t,r),e=t):(pi=e,e=me),e===me&&(e=pi,(t=B())!==me&&(r=V())!==me?(t=Ht(t,r),e=t):(pi=e,e=me),e===me&&(e=pi,(t=B())!==me&&(t=Wt(t)),e=t))),e}())!==me?(r=pi,mi++,n=I(),mi--,n===me?r=void 0:(pi=r,r=me),r!==me?(t=Zt(t),e=t):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,t;return e=pi,(t=R())!==me&&(t=At()),(e=t)===me&&(e=pi,(t=j())!==me&&(t=Mt()),e=t),e}())===me&&(e=function(){var e;return pi,(e=z())!==me&&(e=Dt()),e}())===me&&(e=function(){var e,t,r;return e=pi,(t=re())!==me&&fe()!==me&&(r=S())!==me?(t=St(r),e=t):(pi=e,e=me),e}())===me&&(e=function(){var e,t,r;return e=pi,(t=te())!==me&&fe()!==me&&(r=S())!==me?(t=Tt(r),e=t):(pi=e,e=me),e}()),e}())===me&&(e=function(){var e,t,r,n;return e=pi,(t=K())!==me&&fe()!==me&&le()!==me&&fe()!==me&&(r=function(){var e;return(e=function(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===bn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(In)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=wn(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,5).toLowerCase()===Cn?(r=t.substr(pi,5),pi+=5):(r=me,0===mi&&s(Pn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=Tn(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,3).toLowerCase()===Sn?(r=t.substr(pi,3),pi+=3):(r=me,0===mi&&s(Dn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=An(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===Mn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(En)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=Bn(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,6).toLowerCase()===Nn?(r=t.substr(pi,6),pi+=6):(r=me,0===mi&&s(Vn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=On(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,6).toLowerCase()===Ln?(r=t.substr(pi,6),pi+=6):(r=me,0===mi&&s(Fn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=zn(),e=r):(pi=e,e=me)):(pi=e,e=me),e}()),e}())!==me&&fe()!==me&&X()!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&ce()!==me?(t=_t(r,n),e=t):(pi=e,e=me),e}())===me&&(e=function(){var e,t,r,n,i,o,a,s,u;return e=pi,(t=W())!==me&&fe()!==me&&le()!==me&&fe()!==me&&(r=c())!==me&&fe()!==me&&X()!==me&&fe()!==me&&(n=c())!==me&&fe()!==me?(i=pi,(o=H())!==me&&(a=fe())!==me&&(s=c())!==me&&(u=fe())!==me?i=o=[o,a,s,u]:(pi=i,i=me),i===me&&(i=null),i!==me&&(o=ce())!==me?(t=bt(r,n,i),e=t):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,t,r,n,i;return e=pi,(t=$())!==me&&fe()!==me&&le()!==me&&fe()!==me?((r=T())===me&&(r=null),r!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&X()!==me&&fe()!==me&&(i=c())!==me&&fe()!==me&&ce()!==me?(t=It(r,n,i),e=t):(pi=e,e=me)):(pi=e,e=me),e===me&&(e=pi,(t=$())!==me&&fe()!==me&&le()!==me&&fe()!==me?((r=T())===me&&(r=null),r!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&ce()!==me?(t=wt(r,n),e=t):(pi=e,e=me)):(pi=e,e=me)),e}())===me&&(e=function(){var e,t,r,n;return e=pi,(t=ee())!==me&&fe()!==me&&le()!==me&&fe()!==me&&(r=c())!==me&&fe()!==me&&k()!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&ce()!==me?(t=Ct(r,n),e=t):(pi=e,e=me),e}())===me&&(e=function(){var e,t,r;return e=pi,(t=pe())!==me&&fe()!==me&&le()!==me&&fe()!==me?((r=l())===me&&(r=null),r!==me&&fe()!==me&&ce()!==me?(t=Pt(t,r),e=t):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e;return(e=function(){var e,t,r,n,i,o;if(e=pi,(t=ne())!==me)if(fe()!==me)if((r=c())!==me)if(fe()!==me){for(n=[],i=M();i!==me;)n.push(i),i=M();n!==me&&(i=fe())!==me&&(o=ie())!==me?(t=kt(r,n),e=t):(pi=e,e=me)}else pi=e,e=me;else pi=e,e=me;else pi=e,e=me;else pi=e,e=me;if(e===me)if(e=pi,(t=ne())!==me)if(fe()!==me)if((r=c())!==me)if(fe()!==me){for(n=[],i=M();i!==me;)n.push(i),i=M();n!==me&&(i=fe())!==me&&(o=E())!==me&&fe()!==me&&ie()!==me?(t=Ut(r,n,o),e=t):(pi=e,e=me)}else pi=e,e=me;else pi=e,e=me;else pi=e,e=me;else pi=e,e=me;return e}())===me&&(e=function(){var e,t,r,n,i;if(e=pi,(t=ne())!==me)if(fe()!==me){for(r=[],n=A();n!==me;)r.push(n),n=A();r!==me&&(n=fe())!==me&&(i=ie())!==me?(t=Yt(r),e=t):(pi=e,e=me)}else pi=e,e=me;else pi=e,e=me;if(e===me)if(e=pi,(t=ne())!==me)if(fe()!==me){for(r=[],n=A();n!==me;)r.push(n),n=A();r!==me&&(n=fe())!==me&&(i=E())!==me&&fe()!==me&&ie()!==me?(t=Gt(r,i),e=t):(pi=e,e=me)}else pi=e,e=me;else pi=e,e=me;return e}()),e}())===me&&(e=function(){var e;return pi,(e=function(){var e;return pi,(e=function(){var e,t,r,n;if(e=pi,(t=I())!==me){for(r=[],n=C();n!==me;)r.push(n),n=C();r!==me?(t=ct(t,r),e=t):(pi=e,e=me)}else pi=e,e=me;return e}())!==me&&(e=lt(e)),e}())!==me&&(e=ut(e)),e}())===me&&(e=P())===me&&(e=pi,le()!==me&&fe()!==me&&(t=c())!==me&&fe()!==me&&ce()!==me?e=st(t):(pi=e,e=me)),e}function b(){var e,t,r,n;if(e=pi,(t=I())!==me){for(r=[],n=w();n!==me;)r.push(n),n=w();r!==me?e=t=ct(t,r):(pi=e,e=me)}else pi=e,e=me;return e}function I(){var e;return ft.test(t.charAt(pi))?(e=t.charAt(pi),pi++):(e=me,0===mi&&s(ht)),e}function w(){var e;return pt.test(t.charAt(pi))?(e=t.charAt(pi),pi++):(e=me,0===mi&&s(dt)),e}function C(){var e;return vt.test(t.charAt(pi))?(e=t.charAt(pi),pi++):(e=me,0===mi&&s(yt)),e}function P(){var e,r,n;return pi,e=pi,64===t.charCodeAt(pi)?(r=mt,pi++):(r=me,0===mi&&s(gt)),r!==me&&(n=b())!==me?e=r=[r,n]:(pi=e,e=me),e!==me&&(e=xt(e)),e}function T(){var e;return(e=function(){var e,r,n,i;return e=pi,t.substr(pi,7).toLowerCase()===hn?(r=t.substr(pi,7),pi+=7):(r=me,0===mi&&s(pn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=dn(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,8).toLowerCase()===vn?(r=t.substr(pi,8),pi+=8):(r=me,0===mi&&s(yn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=mn(),e=r):(pi=e,e=me)):(pi=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===gn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(xn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?(r=_n(),e=r):(pi=e,e=me)):(pi=e,e=me),e}()),e}function S(){var e;return(e=D())===me&&(e=P()),e}function D(){var e,r,n,i,o;if(e=pi,39===t.charCodeAt(pi)?(r=Et,pi++):(r=me,0===mi&&s(Bt)),r===me&&(t.substr(pi,2)===Nt?(r=Nt,pi+=2):(r=me,0===mi&&s(Vt))),r!==me){for(n=[],i=pi,t.substr(pi,2)===Ot?(o=Ot,pi+=2):(o=me,0===mi&&s(Lt)),o!==me&&(o=Ft()),(i=o)===me&&(zt.test(t.charAt(pi))?(i=t.charAt(pi),pi++):(i=me,0===mi&&s(Rt)));i!==me;)n.push(i),i=pi,t.substr(pi,2)===Ot?(o=Ot,pi+=2):(o=me,0===mi&&s(Lt)),o!==me&&(o=Ft()),(i=o)===me&&(zt.test(t.charAt(pi))?(i=t.charAt(pi),pi++):(i=me,0===mi&&s(Rt)));n!==me?(39===t.charCodeAt(pi)?(i=Et,pi++):(i=me,0===mi&&s(Bt)),i!==me?e=r=jt(n):(pi=e,e=me)):(pi=e,e=me)}else pi=e,e=me;return e}function A(){var e,t,r;return e=pi,oe()!==me&&fe()!==me&&(t=c())!==me&&fe()!==me&&ae()!==me&&fe()!==me&&(r=c())!==me?e=qt(t,r):(pi=e,e=me),e}function M(){var e,t,r;return e=pi,oe()!==me&&fe()!==me&&(t=c())!==me&&fe()!==me&&ae()!==me&&fe()!==me&&(r=c())!==me?e=qt(t,r):(pi=e,e=me),e}function E(){var e,t;return e=pi,se()!==me&&fe()!==me&&(t=c())!==me?e=Qt(t):(pi=e,e=me),e}function B(){var e,r,n;return(e=O())===me&&(e=pi,45===t.charCodeAt(pi)?(r=et,pi++):(r=me,0===mi&&s(tt)),r===me&&(43===t.charCodeAt(pi)?(r=Ke,pi++):(r=me,0===mi&&s($e))),r!==me&&(n=O())!==me?e=r=Kt(r,n):(pi=e,e=me)),e}function N(){var e,r,n;return e=pi,46===t.charCodeAt(pi)?(r=$t,pi++):(r=me,0===mi&&s(er)),r!==me?((n=O())===me&&(n=null),n!==me?e=r=tr(n):(pi=e,e=me)):(pi=e,e=me),e}function V(){var e,t,r;return e=pi,(t=F())!==me&&(r=O())!==me?e=t=rr(t,r):(pi=e,e=me),e}function O(){var e,t;if(pi,e=[],(t=L())!==me)for(;t!==me;)e.push(t),t=L();else e=me;return e!==me&&(e=nr(e)),e}function L(){var e;return ir.test(t.charAt(pi))?(e=t.charAt(pi),pi++):(e=me,0===mi&&s(or)),e}function F(){var e,r,n;return e=pi,ar.test(t.charAt(pi))?(r=t.charAt(pi),pi++):(r=me,0===mi&&s(sr)),r!==me?(ur.test(t.charAt(pi))?(n=t.charAt(pi),pi++):(n=me,0===mi&&s(lr)),n===me&&(n=null),n!==me?e=r=cr(r,n):(pi=e,e=me)):(pi=e,e=me),e}function z(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===fr?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(hr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=[r,n]:(pi=e,e=me)):(pi=e,e=me),e}function R(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===pr?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(dr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=[r,n]:(pi=e,e=me)):(pi=e,e=me),e}function j(){var e,r,n,i;return e=pi,t.substr(pi,5).toLowerCase()===vr?(r=t.substr(pi,5),pi+=5):(r=me,0===mi&&s(yr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=[r,n]:(pi=e,e=me)):(pi=e,e=me),e}function k(){var e,r,n,i;return e=pi,t.substr(pi,2).toLowerCase()===mr?(r=t.substr(pi,2),pi+=2):(r=me,0===mi&&s(gr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=xr():(pi=e,e=me)):(pi=e,e=me),e}function U(){var e,r,n,i;return e=pi,t.substr(pi,2).toLowerCase()===_r?(r=t.substr(pi,2),pi+=2):(r=me,0===mi&&s(br)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Ir():(pi=e,e=me)):(pi=e,e=me),e}function Y(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===wr?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(Cr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Pr():(pi=e,e=me)):(pi=e,e=me),e}function G(){var e,r,n,i;return e=pi,t.substr(pi,6).toLowerCase()===Tr?(r=t.substr(pi,6),pi+=6):(r=me,0===mi&&s(Sr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Dr():(pi=e,e=me)):(pi=e,e=me),e}function q(){var e,r,n,i;return e=pi,t.substr(pi,3).toLowerCase()===Ar?(r=t.substr(pi,3),pi+=3):(r=me,0===mi&&s(Mr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Er():(pi=e,e=me)):(pi=e,e=me),e}function Q(){var e,r,n,i;return e=pi,t.substr(pi,3).toLowerCase()===Br?(r=t.substr(pi,3),pi+=3):(r=me,0===mi&&s(Nr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Vr():(pi=e,e=me)):(pi=e,e=me),e}function Z(){var e,r,n,i;return e=pi,t.substr(pi,2).toLowerCase()===Or?(r=t.substr(pi,2),pi+=2):(r=me,0===mi&&s(Lr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Fr():(pi=e,e=me)):(pi=e,e=me),e}function J(){var e,r,n,i;return e=pi,t.substr(pi,7).toLowerCase()===zr?(r=t.substr(pi,7),pi+=7):(r=me,0===mi&&s(Rr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=jr():(pi=e,e=me)):(pi=e,e=me),e}function X(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===kr?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(Ur)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Yr():(pi=e,e=me)):(pi=e,e=me),e}function H(){var e,r,n,i;return e=pi,t.substr(pi,3).toLowerCase()===Gr?(r=t.substr(pi,3),pi+=3):(r=me,0===mi&&s(qr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Qr():(pi=e,e=me)):(pi=e,e=me),e}function W(){var e,r,n,i;return e=pi,t.substr(pi,9).toLowerCase()===Zr?(r=t.substr(pi,9),pi+=9):(r=me,0===mi&&s(Jr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Xr():(pi=e,e=me)):(pi=e,e=me),e}function K(){var e,r,n,i;return e=pi,t.substr(pi,7).toLowerCase()===Hr?(r=t.substr(pi,7),pi+=7):(r=me,0===mi&&s(Wr)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Kr():(pi=e,e=me)):(pi=e,e=me),e}function $(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===$r?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(en)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=tn():(pi=e,e=me)):(pi=e,e=me),e}function ee(){var e,r,n,i;return e=pi,t.substr(pi,8).toLowerCase()===rn?(r=t.substr(pi,8),pi+=8):(r=me,0===mi&&s(nn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=on():(pi=e,e=me)):(pi=e,e=me),e}function te(){var e,r,n,i;return e=pi,t.substr(pi,9).toLowerCase()===an?(r=t.substr(pi,9),pi+=9):(r=me,0===mi&&s(sn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=un():(pi=e,e=me)):(pi=e,e=me),e}function re(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===ln?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(cn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=fn():(pi=e,e=me)):(pi=e,e=me),e}function ne(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===Rn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(jn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=kn():(pi=e,e=me)):(pi=e,e=me),e}function ie(){var e,r,n,i;return e=pi,t.substr(pi,3).toLowerCase()===Un?(r=t.substr(pi,3),pi+=3):(r=me,0===mi&&s(Yn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Gn():(pi=e,e=me)):(pi=e,e=me),e}function oe(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===qn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(Qn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Zn():(pi=e,e=me)):(pi=e,e=me),e}function ae(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===Jn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(Xn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=Hn():(pi=e,e=me)):(pi=e,e=me),e}function se(){var e,r,n,i;return e=pi,t.substr(pi,4).toLowerCase()===Wn?(r=t.substr(pi,4),pi+=4):(r=me,0===mi&&s(Kn)),r!==me?(n=pi,mi++,i=w(),mi--,i===me?n=void 0:(pi=n,n=me),n!==me?e=r=$n():(pi=e,e=me)):(pi=e,e=me),e}function ue(){var e;return 44===t.charCodeAt(pi)?(e=ei,pi++):(e=me,0===mi&&s(ti)),e}function le(){var e;return 40===t.charCodeAt(pi)?(e=ri,pi++):(e=me,0===mi&&s(ni)),e}function ce(){var e;return 41===t.charCodeAt(pi)?(e=ii,pi++):(e=me,0===mi&&s(oi)),e}function fe(){var e,t;for(e=[],t=he();t!==me;)e.push(t),t=he();return e}function he(){var e;return ai.test(t.charAt(pi))?(e=t.charAt(pi),pi++):(e=me,0===mi&&s(si)),e}function pe(){var e,r,n,i;if(e=pi,(r=b())!==me&&(r=lt(r)),(e=r)===me)if(e=pi,96===t.charCodeAt(pi)?(r=ui,pi++):(r=me,0===mi&&s(li)),r!==me){if(n=[],ci.test(t.charAt(pi))?(i=t.charAt(pi),pi++):(i=me,0===mi&&s(fi)),i!==me)for(;i!==me;)n.push(i),ci.test(t.charAt(pi))?(i=t.charAt(pi),pi++):(i=me,0===mi&&s(fi));else n=me;n!==me?(96===t.charCodeAt(pi)?(i=ui,pi++):(i=me,0===mi&&s(li)),i!==me?e=r=hi(n):(pi=e,e=me)):(pi=e,e=me)}else pi=e,e=me;return e}function de(e,t,r,n){var i={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(i.escape=n),i}function ve(e,t){for(var r=e,n=0;n<t.length;n++)r=de(t[n][1],r,t[n][3]);return r}r=void 0!==r?r:{};var ye,me={},ge={start:u},xe=u,_e=function(e){return e},be=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},Ie=function(e,t){return ve(e,t)},we="!",Ce=n("!",!1),Pe="=",Te=n("=",!1),Se=function(e){return function(e,t){return{type:"unary_expr",operator:e,expr:t}}("NOT",e)},De=function(e,t){return""==t||void 0==t||null==t?e:"arithmetic"==t.type?ve(e,t.tail):de(t.op,e,t.right,t.escape)},Ae=function(e){return{type:"arithmetic",tail:e}},Me=">=",Ee=n(">=",!1),Be=">",Ne=n(">",!1),Ve="<=",Oe=n("<=",!1),Le="<>",Fe=n("<>",!1),ze="<",Re=n("<",!1),je="!=",ke=n("!=",!1),Ue=function(e,t){return{op:e+"NOT",right:t}},Ye=function(e,t){return{op:e,right:t}},Ge=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}},qe=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}},Qe=function(e){return e[0]+" "+e[2]},Ze=function(e,t,r){return{op:e,right:t,escape:r.value}},Je=function(e,t){return{op:e,right:t,escape:""}},Xe=function(e,t){return{op:e,right:t}},He=function(e){return{op:e,right:{type:"expr_list",value:[]}}},We=function(e,t){return{op:e,right:t}},Ke="+",$e=n("+",!1),et="-",tt=n("-",!1),rt=function(e,t){return ve(e,t)},nt="*",it=n("*",!1),ot="/",at=n("/",!1),st=function(e){return e.paren=!0,e},ut=function(e){return{type:"column_ref",table:"",column:e}},lt=function(e){return e},ct=function(e,t){return e+t.join("")},ft=/^[A-Za-z_\x80-\uFFFF]/,ht=i([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),pt=/^[A-Za-z0-9_]/,dt=i([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),vt=/^[A-Za-z0-9_.\x80-\uFFFF]/,yt=i([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),mt="@",gt=n("@",!1),xt=function(e){return{type:"param",value:e[1]}},_t=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}},bt=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}},It=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}},wt=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}},Ct=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}},Pt=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}},Tt=function(e){return{type:"timestamp",value:e.value}},St=function(e){return{type:"date",value:e.value}},Dt=function(){return{type:"null",value:null}},At=function(){return{type:"bool",value:!0}},Mt=function(){return{type:"bool",value:!1}},Et="'",Bt=n("'",!1),Nt="N'",Vt=n("N'",!1),Ot="''",Lt=n("''",!1),Ft=function(){return"'"},zt=/^[^']/,Rt=i(["'"],!0,!1),jt=function(e){return{type:"string",value:e.join("")}},kt=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}},Ut=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}},Yt=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}},Gt=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}},qt=function(e,t){return{type:"when_clause",operand:e,value:t}},Qt=function(e){return{type:"else_clause",value:e}},Zt=function(e){return{type:"number",value:e}},Jt=function(e,t,r){return parseFloat(e+t+r)},Xt=function(e,t){return parseFloat(e+t)},Ht=function(e,t){return parseFloat(e+t)},Wt=function(e){return parseFloat(e)},Kt=function(e,t){return e[0]+t},$t=".",er=n(".",!1),tr=function(e){return"."+(null!=e?e:"")},rr=function(e,t){return e+t},nr=function(e){return e.join("")},ir=/^[0-9]/,or=i([["0","9"]],!1,!1),ar=/^[eE]/,sr=i(["e","E"],!1,!1),ur=/^[+\-]/,lr=i(["+","-"],!1,!1),cr=function(e,t){return"e"+(null===t?"":t)},fr="null",hr=n("NULL",!0),pr="true",dr=n("TRUE",!0),vr="false",yr=n("FALSE",!0),mr="in",gr=n("IN",!0),xr=function(){return"IN"},_r="is",br=n("IS",!0),Ir=function(){return"IS"},wr="like",Cr=n("LIKE",!0),Pr=function(){return"LIKE"},Tr="escape",Sr=n("ESCAPE",!0),Dr=function(){return"ESCAPE"},Ar="not",Mr=n("NOT",!0),Er=function(){return"NOT"},Br="and",Nr=n("AND",!0),Vr=function(){return"AND"},Or="or",Lr=n("OR",!0),Fr=function(){return"OR"},zr="between",Rr=n("BETWEEN",!0),jr=function(){return"BETWEEN"},kr="from",Ur=n("FROM",!0),Yr=function(){return"FROM"},Gr="for",qr=n("FOR",!0),Qr=function(){return"FOR"},Zr="substring",Jr=n("SUBSTRING",!0),Xr=function(){return"SUBSTRING"},Hr="extract",Wr=n("EXTRACT",!0),Kr=function(){return"EXTRACT"},$r="trim",en=n("TRIM",!0),tn=function(){return"TRIM"},rn="position",nn=n("POSITION",!0),on=function(){return"POSITION"},an="timestamp",sn=n("TIMESTAMP",!0),un=function(){return"TIMESTAMP"},ln="date",cn=n("DATE",!0),fn=function(){return"DATE"},hn="leading",pn=n("LEADING",!0),dn=function(){return"LEADING"},vn="trailing",yn=n("TRAILING",!0),mn=function(){return"TRAILING"},gn="both",xn=n("BOTH",!0),_n=function(){return"BOTH"},bn="year",In=n("YEAR",!0),wn=function(){return"YEAR"},Cn="month",Pn=n("MONTH",!0),Tn=function(){return"MONTH"},Sn="day",Dn=n("DAY",!0),An=function(){return"DAY"},Mn="hour",En=n("HOUR",!0),Bn=function(){return"HOUR"},Nn="minute",Vn=n("MINUTE",!0),On=function(){return"MINUTE"},Ln="second",Fn=n("SECOND",!0),zn=function(){return"SECOND"},Rn="case",jn=n("CASE",!0),kn=function(){return"CASE"},Un="end",Yn=n("END",!0),Gn=function(){return"END"},qn="when",Qn=n("WHEN",!0),Zn=function(){return"WHEN"},Jn="then",Xn=n("THEN",!0),Hn=function(){return"THEN"},Wn="else",Kn=n("ELSE",!0),$n=function(){return"ELSE"},ei=",",ti=n(",",!1),ri="(",ni=n("(",!1),ii=")",oi=n(")",!1),ai=/^[ \t\n\r]/,si=i([" ","\t","\n","\r"],!1,!1),ui="`",li=n("`",!1),ci=/^[^`]/,fi=i(["`"],!0,!1),hi=function(e){return e.join("")},pi=0,di=[{line:1,column:1}],vi=0,yi=[],mi=0;if("startRule"in r){if(!(r.startRule in ge))throw new Error("Can't start parsing from rule \""+r.startRule+'".');xe=ge[r.startRule]}if((ye=xe())!==me&&pi===t.length)return ye;throw ye!==me&&pi<t.length&&s({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(yi,vi<t.length?t.charAt(vi):null,vi<t.length?a(vi,vi+1):a(vi,vi))}}}.apply(null,[]))||(e.exports=n)},1553:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1403),r(1529),r(1532)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){this.ratio=e,this.x=t,this.y=r},a=function(){function e(e,t,n,i,o){void 0===i&&(i=8),void 0===o&&(o=8),this.lines=[],this.starts=[],this.pixelRatio=i,this.pixelMargin=o,this.tileSize=r.TILE_SIZE*i,this.dz=e,this.yPos=t,this.xPos=n}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var r=e>>this.dz;r<t&&(t=r),this.margin=t,this.xmin=r*this.xPos-t,this.ymin=r*this.yPos-t,this.xmax=this.xmin+r+2*t,this.ymax=this.ymin+r+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new n.Point(e,t),this._firstPt=new n.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var r,i,a,s,u,l,c,f,h=this._isIn(e,t),p=new n.Point(e,t),d=n.Point.distance(this._prevPt,p);if(h)this._prevIsIn?this._lineTo(e,t,!0):(r=this._prevPt,i=p,a=this._intersect(i,r),this.start=this._dist+d*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(i.x,i.y,!0));else if(this._prevIsIn)i=this._prevPt,r=p,a=this._intersect(i,r),this._lineTo(a.x,a.y,!0),this._lineTo(r.x,r.y,!1);else{var v=this._prevPt,y=p;if(v.x<=this.xmin&&y.x<=this.xmin||v.x>=this.xmax&&y.x>=this.xmax||v.y<=this.ymin&&y.y<=this.ymin||v.y>=this.ymax&&y.y>=this.ymax)this._lineTo(y.x,y.y,!1);else{var m=[];if((v.x<this.xmin&&y.x>this.xmin||v.x>this.xmin&&y.x<this.xmin)&&(s=(this.xmin-v.x)/(y.x-v.x),(f=v.y+s*(y.y-v.y))<=this.ymin?l=!1:f>=this.ymax?l=!0:m.push(new o(s,this.xmin,f))),(v.x<this.xmax&&y.x>this.xmax||v.x>this.xmax&&y.x<this.xmax)&&(s=(this.xmax-v.x)/(y.x-v.x),(f=v.y+s*(y.y-v.y))<=this.ymin?l=!1:f>=this.ymax?l=!0:m.push(new o(s,this.xmax,f))),(v.y<this.ymin&&y.y>this.ymin||v.y>this.ymin&&y.y<this.ymin)&&(s=(this.ymin-v.y)/(y.y-v.y),(c=v.x+s*(y.x-v.x))<=this.xmin?u=!1:c>=this.xmax?u=!0:m.push(new o(s,c,this.ymin))),(v.y<this.ymax&&y.y>this.ymax||v.y>this.ymax&&y.y<this.ymax)&&(s=(this.ymax-v.y)/(y.y-v.y),(c=v.x+s*(y.x-v.x))<=this.xmin?u=!1:c>=this.xmax?u=!0:m.push(new o(s,c,this.ymax))),0===m.length)u?l?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):l?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<m.length&&m[0].ratio>m[1].ratio)this.start=this._dist+d*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+d*m[0].ratio;for(var g=0;g<m.length;g++)this._lineTo(m[g].x,m[g].y,!0)}this._lineTo(y.x,y.y,!1)}}this._dist+=d,this._prevIsIn=h,this._prevPt=p},e.prototype.close=function(){if(2<this.line.length){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var r=this.line,n=r.length;4<=n&&(r[0].x===r[1].x&&r[0].x===r[n-2].x||r[0].y===r[1].y&&r[0].y===r[n-2].y);)r.pop(),r[0].x=r[n-2].x,r[0].y=r[n-2].y,--n}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&u.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var r=[],n=0;n<t;n++)r.push({line:e[n],start:this.starts[n]||0});return r},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var r,i,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((i=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),r=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),i=e.y+o*(t.y-e.y);else{i=t.y<=this.ymin?this.ymin:this.ymax;var a=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),s=(i-e.y)/(t.y-e.y);a<s?(o=a,i=e.y+a*(t.y-e.y)):(o=s,r=e.x+s*(t.x-e.x))}return this._r=o,new n.Point(r,i)},e.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,r){3!==this.type?r&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n.Point(e,t))):(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,r){var i,o;if(3!==this.type)if(r){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),0<this.line.length&&(i=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new n.Point(e,t))}else this.line&&0<this.line.length&&this._pushLine();else if(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){var a=(i=this.line[this.line.length-1]).x===e,s=i.y===t;if(a&&s)return;this._is_h&&a?(i.x=e,i.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&s?(i.x=e,i.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new n.Point(e,t)),this._is_h=a,this._is_v=s)}else this.line.push(new n.Point(e,t))},e}();t.TileClipper=a;var s=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var r=this._ratio;this.line.push(new n.Point(Math.round(e*r),Math.round(t*r)))},e.prototype.lineTo=function(e,t){var r=this._ratio;this.line.push(new n.Point(Math.round(e*r),Math.round(t*r)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&u.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=s;var u=function(){function e(){}return e.simplify=function(t,r,n){if(n){for(var i=-r,o=t+r,a=-r,s=t+r,u=[],l=[],c=n.length,f=0;f<c;++f){var h=n[f];if(h&&!(h.length<2))for(var p=h[0],d=void 0,v=h.length,y=1;y<v;++y)d=h[y],p.x===d.x&&(p.x<=i&&(p.y>d.y?(u.push(f),u.push(y),u.push(0),u.push(-1)):(l.push(f),l.push(y),l.push(0),l.push(-1))),p.x>=o&&(p.y<d.y?(u.push(f),u.push(y),u.push(1),u.push(-1)):(l.push(f),l.push(y),l.push(1),l.push(-1)))),p.y===d.y&&(p.y<=a&&(p.x<d.x?(u.push(f),u.push(y),u.push(2),u.push(-1)):(l.push(f),l.push(y),l.push(2),l.push(-1))),p.y>=s&&(p.x>d.x?(u.push(f),u.push(y),u.push(3),u.push(-1)):(l.push(f),l.push(y),l.push(3),l.push(-1)))),p=d}if(0!==u.length&&0!==l.length){e.fillParent(n,l,u),e.fillParent(n,u,l);var m=[];e.calcDeltas(m,l,u),e.calcDeltas(m,u,l),e.addDeltas(m,n)}}},e.fillParent=function(e,t,r){for(var n=r.length,o=t.length,a=0;a<o;a+=4){for(var s=t[a],u=t[a+1],l=t[a+2],c=e[s][u-1],f=e[s][u],h=8092,p=-1,d=0;d<n;d+=4)if(r[d+2]===l){var v=r[d],y=r[d+1],m=e[v][y-1],g=e[v][y];switch(l){case 0:case 1:i.between(c.y,m.y,g.y)&&i.between(f.y,m.y,g.y)&&(x=Math.abs(g.y-m.y))<h&&(h=x,p=d);break;case 2:case 3:var x;i.between(c.x,m.x,g.x)&&i.between(f.x,m.x,g.x)&&(x=Math.abs(g.x-m.x))<h&&(h=x,p=d)}}t[a+3]=p}},e.calcDeltas=function(t,r,n){for(var i=r.length,o=0;o<i;o+=4){var a=e.calcDelta(o,r,n,[]);t.push(r[o]),t.push(r[o+1]),t.push(r[o+2]),t.push(a)}},e.calcDelta=function(t,r,n,i){var o=r[t+3];if(-1===o)return 0;var a=i.length;return 1<a&&i[a-2]===o?0:(i.push(o),e.calcDelta(o,n,r,i)+1)},e.addDeltas=function(e,t){for(var r=e.length,n=0,i=0;i<r;i+=4)n<(s=e[i+3])&&(n=s);for(i=0;i<r;i+=4){var o=t[e[i]],a=e[i+1],s=n-e[i+3];switch(e[i+2]){case 0:o[a-1].x-=s,o[a].x-=s,1===a&&(o[o.length-1].x-=s),a===o.length-1&&(o[0].x-=s);break;case 1:o[a-1].x+=s,o[a].x+=s,1===a&&(o[o.length-1].x+=s),a===o.length-1&&(o[0].x+=s);break;case 2:o[a-1].y-=s,o[a].y-=s,1===a&&(o[o.length-1].y-=s),a===o.length-1&&(o[0].y-=s);break;case 3:o[a-1].y+=s,o[a].y+=s,1===a&&(o[o.length-1].y+=s),a===o.length-1&&(o[0].y+=s)}}},e}(),l=function(){function e(){this.linesIn=[],this.linesOut=[]}return e.prototype.cut=function(e,t){var r;if(this.xCut=t,e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var n=0,i=r;n<i.length;n++)if((d=i[n])&&!(d.length<this.minPts)){for(var o=!0,a=0,s=d;a<s.length;a++){var u=s[a];o?(this.moveTo(u),o=!1):this.lineTo(u)}this.closed&&this.close()}this._pushLineIn(),this._pushLineOut(),r=[];for(var l=0,c=this.linesIn;l<c.length;l++)(d=c[l])&&d.length>=this.minPts&&r.push(d);for(var f=-2*this.xCut,h=0,p=this.linesOut;h<p.length;h++){var d;if((d=p[h])&&d.length>=this.minPts){for(var v=0,y=d;v<y.length;v++)(u=y[v])[0]+=f;r.push(d)}}return this.closed?e.rings=r:e.paths=r,e},e.prototype.moveTo=function(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e},e.prototype.lineTo=function(e){var t=this._side(e[0]);if(t*this._prevSide==-1){var r=this._intersect(this._prevPt,e);this._lineTo(this.xCut,r,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e},e.prototype.close=function(){var e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this.lineIn),this._checkClosingPt(this.lineOut)},e.prototype._moveTo=function(e,t,r){this.closed?(this.lineIn.push([r<=0?e:this.xCut,t]),this.lineOut.push([0<=r?e:this.xCut,t])):(r<=0&&this.lineIn.push([e,t]),0<=r&&this.lineOut.push([e,t]))},e.prototype._lineTo=function(e,t,r){this.closed?(this._addPolyVertex(this.lineIn,r<=0?e:this.xCut,t),this._addPolyVertex(this.lineOut,0<=r?e:this.xCut,t)):r<0?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([e,t])):0<r?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([e,t])):this._prevSide<0?(this.lineIn.push([e,t]),this.lineOut.push([e,t])):0<this._prevSide&&(this.lineOut.push([e,t]),this.lineIn.push([e,t]))},e.prototype._addPolyVertex=function(e,t,r){var n=e.length;1<n&&e[n-1][0]===t&&e[n-2][0]===t?e[n-1][1]=r:e.push([t,r])},e.prototype._checkClosingPt=function(e){var t=e.length;3<t&&e[0][0]===this.xCut&&e[t-2][0]===this.xCut&&e[1][0]===this.xCut&&(e[0][1]=e[t-2][1],e.pop())},e.prototype._side=function(e){return e<this.xCut?-1:e>this.xCut?1:0},e.prototype._intersect=function(e,t){var r=(this.xCut-e[0])/(t[0]-e[0]);return e[1]+r*(t[1]-e[1])},e.prototype._pushLineIn=function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn),this.lineIn=[]},e.prototype._pushLineOut=function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut),this.lineOut=[]},e}();t.CutVertical=l}.apply(null,n))||(e.exports=i)},1555:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._listeners={}}return e.prototype.on=function(e,t){var r=this;null==this._listeners[e]&&(this._listeners[e]=new Map);var n={};return this._listeners[e].set(n,t),{remove:function(){return r._listeners[e].delete(n)}}},e.prototype.once=function(e,t){var r=this.on(e,function(e){r.remove(),t(e)});return r},e.prototype.emit=function(e,t){this.hasEventListener(e)&&this._listeners[e].forEach(function(e){return e(t)})},e.prototype.hasEventListener=function(e){return null!=this._listeners[e]&&this._listeners[e].size>0},e}();t.default=r}.apply(null,n))||(e.exports=i)},1556:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34)],void 0===(i=function(e,t,r){function n(e,t,n,i,o,s,u,l,c,f,h){return function(e,t,n){for(var i=r.vec3.squaredDistance(e.maxVert[0],e.minVert[0]),o=0,a=1;a<7;++a){var s=r.vec3.squaredDistance(e.maxVert[a],e.minVert[a]);s>i&&(i=s,o=a)}r.vec3.copy(t,e.minVert[o]),r.vec3.copy(n,e.maxVert[o])}(e,i,o),r.vec3.squaredDistance(i,o)<p?1:(r.vec3.subtract(u,i,o),r.vec3.normalize(u,u),function(e,t,n,i){for(var o=e.data,a=e.offsetIdx,s=e.strideIdx,u=Number.NEGATIVE_INFINITY,l=0,c=a;c<o.length;c+=s){r.vec3.set(C,o[c]-t[0],o[c+1]-t[1],o[c+2]-t[2]);var f=n[0]*C[0]+n[1]*C[1]+n[2]*C[2],h=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],p=C[0]*C[0]+C[1]*C[1]+C[2]*C[2],d=p-f*f/h;d>u&&(u=d,l=c)}return r.vec3.set(i,o[l],o[l+1],o[l+2]),u}(t,i,u,s)<p?2:(r.vec3.subtract(l,o,s),r.vec3.normalize(l,l),r.vec3.subtract(c,s,i),r.vec3.normalize(c,c),r.vec3.cross(n,l,u),r.vec3.normalize(n,n),a(t,n,u,l,c,f),0))}function i(e,t,n,i,s,u,l,c,f,h){o(e,t,n,i,s,y,m),void 0!==y[0]&&(r.vec3.subtract(g,y,n),r.vec3.normalize(g,g),r.vec3.subtract(x,y,i),r.vec3.normalize(x,x),r.vec3.subtract(_,y,s),r.vec3.normalize(_,_),r.vec3.cross(b,x,u),r.vec3.normalize(b,b),r.vec3.cross(I,_,l),r.vec3.normalize(I,I),r.vec3.cross(w,g,c),r.vec3.normalize(w,w),a(e,b,u,x,g,f),a(e,I,l,_,x,f),a(e,w,c,g,_,f)),void 0!==m[0]&&(r.vec3.subtract(g,m,n),r.vec3.normalize(g,g),r.vec3.subtract(x,m,i),r.vec3.normalize(x,x),r.vec3.subtract(_,m,s),r.vec3.normalize(_,_),r.vec3.cross(b,x,u),r.vec3.normalize(b,b),r.vec3.cross(I,_,l),r.vec3.normalize(I,I),r.vec3.cross(w,g,c),r.vec3.normalize(w,w),a(e,b,u,x,g,f),a(e,I,l,_,x,f),a(e,w,c,g,_,f))}function o(e,t,n,i,o,a,s){!function(e,t,n,i,o){var a=e.data,s=e.offsetIdx,u=e.strideIdx;r.vec3.set(i,a[s],a[s+1],a[s+2]),r.vec3.copy(o,i),n[0]=r.vec3.dot(B,t),n[1]=n[0];for(var l=s+u;l<a.length;l+=u){var c=a[l]*t[0]+a[l+1]*t[1]+a[l+2]*t[2];c<n[0]&&(n[0]=c,r.vec3.set(i,a[l],a[l+1],a[l+2])),c>n[1]&&(n[1]=c,r.vec3.set(o,a[l],a[l+1],a[l+2]))}}(e,t,P,s,a);var u=r.vec3.dot(n,t);P[1]-p<=u&&(a[0]=void 0),P[0]+p>=u&&(s[0]=void 0)}function a(e,t,n,i,o,a){if(!(r.vec3.squaredLength(t)<p)){r.vec3.cross(T,n,t),r.vec3.cross(S,i,t),r.vec3.cross(D,o,t),s(e,t,P),M[1]=P[0],A[1]=P[1],E[1]=A[1]-M[1];for(var u=[n,i,o],l=[T,S,D],c=0;c<3;++c){s(e,u[c],P),M[0]=P[0],A[0]=P[1],s(e,l[c],P),M[2]=P[0],A[2]=P[1],E[0]=A[0]-M[0],E[2]=A[2]-M[2];var f=h(E);f<a.quality&&(r.vec3.copy(a.b0,u[c]),r.vec3.copy(a.b1,t),r.vec3.copy(a.b2,l[c]),a.quality=f)}}}function s(e,t,r){var n=e.data,i=e.offsetIdx,o=e.strideIdx;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(var a=i;a<n.length;a+=o){var s=n[a]*t[0]+n[a+1]*t[1]+n[a+2]*t[2];r[0]=Math.min(r[0],s),r[1]=Math.max(r[1],s)}}function u(e,t,n){r.vec3.copy(n.center,e),r.vec3.scale(n.halfSize,t,.5),r.quat.identity(n.quaternion)}function l(e,t,n){r.vec3.copy(N,t),Math.abs(t[0])>Math.abs(t[1])&&Math.abs(t[0])>Math.abs(t[2])?N[0]=0:Math.abs(t[1])>Math.abs(t[2])?N[1]=0:N[2]=0,r.vec3.squaredLength(N)<p&&(N[0]=N[1]=N[2]=1),r.vec3.cross(V,t,N),r.vec3.normalize(V,V),r.vec3.cross(O,t,V),r.vec3.normalize(O,O),c(e,t,V,O,L,F),r.vec3.subtract(z,F,L),f(t,V,O,L,F,z,n)}function c(e,t,r,n,i,o){s(e,t,P),i[0]=P[0],o[0]=P[1],s(e,r,P),i[1]=P[0],o[1]=P[1],s(e,n,P),i[2]=P[0],o[2]=P[1]}function f(e,t,n,i,o,a,s){j[0]=e[0],j[1]=e[1],j[2]=e[2],j[3]=t[0],j[4]=t[1],j[5]=t[2],j[6]=n[0],j[7]=n[1],j[8]=n[2],r.quat.fromMat3(s.quaternion,j),r.vec3.add(k,i,o),r.vec3.scale(k,k,.5),r.vec3.scale(s.center,e,k[0]),r.vec3.scale(R,t,k[1]),r.vec3.add(s.center,s.center,R),r.vec3.scale(R,n,k[2]),r.vec3.add(s.center,s.center,R),r.vec3.scale(s.halfSize,a,.5)}function h(e){return e[0]*e[1]+e[0]*e[2]+e[1]*e[2]}Object.defineProperty(t,"__esModule",{value:!0});var p=1e-6,d=r.vec3f64.create(),v=r.vec3f64.create();t.computeOBB=function(e,t){var o=e.data,a=e.strideIdx,s=o.length/a;if(!(s<=0)){var p=new Y(e);r.vec3.add(d,p.minProj,p.maxProj),r.vec3.scale(d,d,.5),r.vec3.subtract(v,p.maxProj,p.minProj);var y=h(v),m=new G;m.quality=y,s<14&&(e={data:new Float64Array(p.buffer,112,42),size:3,offsetIdx:0,strideIdx:3});var g=r.vec3f64.create(),x=r.vec3f64.create(),_=r.vec3f64.create(),b=r.vec3f64.create(),I=r.vec3f64.create(),w=r.vec3f64.create(),C=r.vec3f64.create();switch(n(p,e,C,g,x,_,b,I,w,m)){case 1:return void u(d,v,t);case 2:return void l(e,b,t)}i(e,C,g,x,_,b,I,w,m),c(e,m.b0,m.b1,m.b2,L,F);var P=r.vec3f64.create();r.vec3.subtract(P,F,L),m.quality=h(P),m.quality<y?f(m.b0,m.b1,m.b2,L,F,P,t):u(d,v,t)}};var y=r.vec3f64.create(),m=r.vec3f64.create(),g=r.vec3f64.create(),x=r.vec3f64.create(),_=r.vec3f64.create(),b=r.vec3f64.create(),I=r.vec3f64.create(),w=r.vec3f64.create(),C=r.vec3f64.create(),P=r.vec2f64.create(),T=r.vec3f64.create(),S=r.vec3f64.create(),D=r.vec3f64.create(),A=r.vec3f64.create(),M=r.vec3f64.create(),E=r.vec3f64.create(),B=r.vec3f64.create(),N=r.vec3f64.create(),V=r.vec3f64.create(),O=r.vec3f64.create(),L=r.vec3f64.create(),F=r.vec3f64.create(),z=r.vec3f64.create(),R=r.vec3f64.create(),j=r.mat3f32.create(),k=r.vec3f64.create(),U=7,Y=function(){return function(e){this.minVert=new Array(U),this.maxVert=new Array(U);var t=64*U;this.buffer=new ArrayBuffer(t);var n=0;this.minProj=new Float64Array(this.buffer,n,U),n+=8*U,this.maxProj=new Float64Array(this.buffer,n,U),n+=8*U;for(var i=0;i<U;++i)this.minVert[i]=r.vec3f64.createView(this.buffer,n),n+=24;for(i=0;i<U;++i)this.maxVert[i]=r.vec3f64.createView(this.buffer,n),n+=24;for(i=0;i<U;++i)this.minProj[i]=Number.POSITIVE_INFINITY,this.maxProj[i]=Number.NEGATIVE_INFINITY;var o=new Array(U),a=new Array(U),s=e.data,u=e.offsetIdx,l=e.strideIdx;for(i=u;i<s.length;i+=l){var c=s[i];c<this.minProj[0]&&(this.minProj[0]=c,o[0]=i),c>this.maxProj[0]&&(this.maxProj[0]=c,a[0]=i),(c=s[i+1])<this.minProj[1]&&(this.minProj[1]=c,o[1]=i),c>this.maxProj[1]&&(this.maxProj[1]=c,a[1]=i),(c=s[i+2])<this.minProj[2]&&(this.minProj[2]=c,o[2]=i),c>this.maxProj[2]&&(this.maxProj[2]=c,a[2]=i),(c=s[i]+s[i+1]+s[i+2])<this.minProj[3]&&(this.minProj[3]=c,o[3]=i),c>this.maxProj[3]&&(this.maxProj[3]=c,a[3]=i),(c=s[i]+s[i+1]-s[i+2])<this.minProj[4]&&(this.minProj[4]=c,o[4]=i),c>this.maxProj[4]&&(this.maxProj[4]=c,a[4]=i),(c=s[i]-s[i+1]+s[i+2])<this.minProj[5]&&(this.minProj[5]=c,o[5]=i),c>this.maxProj[5]&&(this.maxProj[5]=c,a[5]=i),(c=s[i]-s[i+1]-s[i+2])<this.minProj[6]&&(this.minProj[6]=c,o[6]=i),c>this.maxProj[6]&&(this.maxProj[6]=c,a[6]=i)}for(i=0;i<U;++i){var f=o[i];r.vec3.set(this.minVert[i],s[f],s[f+1],s[f+2]),f=a[i],r.vec3.set(this.maxVert[i],s[f],s[f+1],s[f+2])}}}(),G=function(){return function(){this.b0=r.vec3f64.fromValues(1,0,0),this.b1=r.vec3f64.fromValues(0,1,0),this.b2=r.vec3f64.fromValues(0,0,1),this.quality=0}}()}.apply(null,n))||(e.exports=i)},1557:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(246),r(1426),r(249),r(1558),r(1559),r(1546)],void 0===(i=function(e,t,r,n,i,o,a,s){function u(e){return i(e,["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate()}function l(e){return i(e,["YYYY-M-D"]).toDate()}function c(e){return!0===e}function f(e){return Array.isArray(e)?e:[e]}function h(e){return null!==e?!0!==e:null}function p(e,t){if(null==e)return null;for(var r=!1,n=0,i=t;n<i.length;n++){var o=i[n];if(null==o)r=null;else if(e===o){r=!0;break}}return r}function d(e,t,r){if(null==e)return null;for(var n=t,i=r,o="",a="-[]/{}()*+?.\\^$|",s=0,u=0;u<n.length;u++){var l=n.charAt(u);switch(s){case 0:l===i?s=1:a.indexOf(l)>=0?o+="\\"+l:o+="%"===l?".*":"_"===l?".":l;break;case 1:a.indexOf(l)>=0?o+="\\"+l:o+=l,s=0}}return new RegExp("^"+o+"$").test(e)}function v(e){return e instanceof Date?e.valueOf():e}function y(e){for(var t=[],r={},n=0,i=e;n<i.length;n++){var o=i[n],a=o.toLowerCase();void 0===r[a]&&(t.push(o),r[a]=1)}return t}return function(){function e(){this.parseTree=null,this.parameters=null,this._hasStandardizedFunctions=null,this._hasAggregateFunctions=null}return e.create=function(t){var r=new e;r.parseTree=s.WhereGrammar.parse(t);var n=!0,i=!0;return r.visitAll(r.parseTree,function(e){if("function"===e.type){var t=e.name,r=e.args.value.length;n&&(n=a.isStandardized(t,r)),i&&(i=o.isAggregate(t,r))}}),r._hasStandardizedFunctions=n,r._hasAggregateFunctions=i,r},e.prototype.isStandardized=function(){return this._hasStandardizedFunctions},e.prototype.isAggregate=function(){return this._hasAggregateFunctions},e.prototype.setVariablesDictionary=function(e){this.parameters=e},e.prototype.testFeature=function(e){return!!this.evaluateNode(this.parseTree,e)},e.prototype.testSet=function(e){var t=this,r=new n.default;this.visitAll(this.parseTree,function(e){"column_ref"!==e.type||r.has(e.column)||r.set(e.column,e)});for(var i={},o=0,a=e;o<a.length;o++){!function(e){r.forEach(function(r,n){var o=t.featureValue(e,n,r);i[n]?i[n].push(o):i[n]=[o]})}(a[o])}return!!this.evaluateNode(this.parseTree,{attributes:i})},e.prototype.calculateValue=function(e){return this.evaluateNode(this.parseTree,e)},e.prototype.getFunctions=function(){var e=[];return this.visitAll(this.parseTree,function(t){"function"===t.type&&e.push(t.name.toLowerCase())}),y(e)},e.prototype.getExpressions=function(){var e=new n.default;return this.visitAll(this.parseTree,function(t){if("function"===t.type){var r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){var i=n.column,o=r+"-"+i;e.has(o)||e.set(o,{aggregateType:r,field:i})}}}),r.from(e.values())},e.prototype.getFields=function(){var e=[];return this.visitAll(this.parseTree,function(t){"column_ref"===t.type&&e.push(t.column)}),y(e)},e.prototype.getVariables=function(){var e=[];return this.visitAll(this.parseTree,function(t){"param"===t.type&&e.push(t.value.toLowerCase())}),y(e)},e.prototype.featureValue=function(e,t,r){var n=function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e,i=n[t];if(void 0!==i)return i;for(var o in n)if(t.toLowerCase()===o.toLowerCase())return r.column=o,n[o];return null},e.prototype.visitAll=function(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(var r=0,n=e.clauses;r<n.length;r++){var i=n[r];this.visitAll(i,t)}"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(var o=0,a=e.value;o<a.length;o++){i=a[o];this.visitAll(i,t)}break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}},e.prototype.evaluateNode=function(e,t){switch(e.type){case"case_expression":if("simple"===e.format){for(var r=v(this.evaluateNode(e.operand,t)),n=0;n<e.clauses.length;n++)if(r===v(this.evaluateNode(e.clauses[n].operand,t)))return this.evaluateNode(e.clauses[n].value,t);if(null!==e.else)return this.evaluateNode(e.else,t)}else{for(n=0;n<e.clauses.length;n++)if(c(this.evaluateNode(e.clauses[n].operand,t)))return this.evaluateNode(e.clauses[n].value,t);if(null!==e.else)return this.evaluateNode(e.else,t)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":for(var i=[],s=0,y=e.value;s<y.length;s++){var m=y[s];i.push(this.evaluateNode(m,t))}return i;case"unary_expr":return h(this.evaluateNode(e.expr,t));case"binary_expr":switch(e.operator){case"AND":return function(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t));case"OR":return function(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t);case"IN":var g=f(this.evaluateNode(e.right,t));return p(this.evaluateNode(e.left,t),g);case"NOT IN":g=f(this.evaluateNode(e.right,t));return h(p(this.evaluateNode(e.left,t),g));case"BETWEEN":var x=this.evaluateNode(e.left,t),_=this.evaluateNode(e.right,t);return null==x||null==_[0]||null==_[1]?null:x>=_[0]&&x<=_[1];case"NOTBETWEEN":x=this.evaluateNode(e.left,t),_=this.evaluateNode(e.right,t);return null==x||null==_[0]||null==_[1]?null:x<_[0]||x>_[1];case"LIKE":return d(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t),e.escape);case"NOT LIKE":return h(d(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return function(e,t,r){if(null==t||null==r)return null;var n=v(t),i=v(r);switch(e){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}(e.operator,this.evaluateNode(e.left,t),this.evaluateNode(e.right,t));case"*":return this.evaluateNode(e.left,t)*this.evaluateNode(e.right,t);case"-":return this.evaluateNode(e.left,t)-this.evaluateNode(e.right,t);case"+":return this.evaluateNode(e.left,t)+this.evaluateNode(e.right,t);case"/":return this.evaluateNode(e.left,t)/this.evaluateNode(e.right,t)}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return e.value;case"date":return l(e.value);case"timestamp":return u(e.value);case"column_ref":return"CURRENT_DATE"===e.column.toUpperCase()?((m=new Date).setHours(0,0,0,0),m):"CURRENT_TIMESTAMP"===e.column.toUpperCase()?new Date:this.featureValue(t,e.column,e);case"function":var b=this.evaluateNode(e.args,t);return this.isAggregate()?o.aggregateFunction(e.name,b):a.evaluateFunction(e.name,b)}throw new Error("Unsupported sql syntax "+e.type)},e}()}.apply(null,n))||(e.exports=i)},1558:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function n(e){for(var t=r(e),n=e.length,i=0,o=0,a=e;o<a.length;o++){var s=a[o];i+=Math.pow(s-t,2)}return n>1?i/(n-1):0}Object.defineProperty(t,"__esModule",{value:!0}),t.aggregateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isAggregate=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={min:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.min.apply(Math,e[0])}},max:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.max.apply(Math,e[0])}},avg:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:r(e[0])}},sum:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}(e[0])}},stddev:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sqrt(n(e[0]))}},count:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].length}},var:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:n(e[0])}}}}.apply(null,n))||(e.exports=i)},1559:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(165)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateFunction=function(e,t){var r=n[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isStandardized=function(e,t){var r=n[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var n={extract:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];if(null==r)return null;if(r instanceof Date)switch(t.toUpperCase()){case"SECOND":return r.getSeconds();case"MINUTE":return r.getMinutes();case"HOUR":return r.getHours();case"DAY":return r.getDate();case"MONTH":return r.getMonth()+1;case"YEAR":return r.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:function(e){if(2===e.length){var t=e[0],r=e[1];return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){t=e[0],r=e[1];var n=e[2];return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];return null==t||null==r?null:r.indexOf(t)+1}},trim:{minParams:2,maxParams:3,evaluate:function(e){var t=3===e.length,n=t?e[1]:" ",i=t?e[2]:e[1];if(null==n||null==i)return null;var o="("+r.escapeString(n)+")";switch(e[0]){case"BOTH":return i.replace(new RegExp("^"+o+"*|"+o+"*$","g"),"");case"LEADING":return i.replace(new RegExp("^"+o+"*","g"),"");case"TRAILING":return i.replace(new RegExp(o+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.abs(e[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.ceil(e[0])}},floor:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.floor(e[0])}},log:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])}},log10:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sin(e[0])}},cos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.cos(e[0])}},tan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.tan(e[0])}},asin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.asin(e[0])}},acos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.acos(e[0])}},atan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.atan(e[0])}},sign:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0]>0?1:e[1]<0?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])}},mod:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:e[0]%e[1]}},round:{minParams:1,maxParams:2,evaluate:function(e){var t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:function(e){return null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(e){return"string"==typeof e[0]||e[0]instanceof String?e[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(e){for(var t="",r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toUpperCase()}}}}.apply(null,n))||(e.exports=i)},1609:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34),r(483),r(80),r(1436)],void 0===(i=function(e,t,r,n,i,o){function a(e,t,i){var o,a,s,u=r.vec3f64.create(),l=e[3],c=Math.ceil(Math.log(l)*Math.LOG2E/h),p=Math.pow(2,c*h+f);if(i.isGeographic){var d=p/n.earthRadius*180/Math.PI;a=Math.round(e[1]/d);var v=Math.max(-90,Math.min(90,a*d)),y=d/Math.cos((Math.abs(v)-d/2)/180*Math.PI),m=(o=Math.round(e[0]/y))*y;u[0]=m,u[1]=v}else o=Math.round(e[0]/p),a=Math.round(e[1]/p),u[0]=o*p,u[1]=a*p;var g=e[2]+t;return s=Math.round(g/p),u[2]=s*p,{center:u,id:c+"_"+o+"_"+a+"_"+s}}Object.defineProperty(t,"__esModule",{value:!0});var s=1e3,u=new Float64Array(3*s),l=r.vec3f64.create(),c=r.mat4f64.create();t.computeGlobalTransformation=function(e,t,n,o){var s=a(e,t,n).center,u=r.mat4f64.create();return i.computeLinearTransformation(n,s,u,o),u},t.reprojectPoints=function(e,t,n,o,a,f,h){var p=e.data,d=e.offsetIdx,v=e.strideIdx;r.mat4.invert(c,n),r.vec3.copy(l,t),l[2]+=o;var y=[0,0,0],m=p.length/v;i.vectorToVector(l,a,y,f);for(var g=0;g<m;g+=s){for(var x=Math.min(s,m-g),_=0;_<x;_++){var b=d+v*(g+_);u[3*_]=p[b]+y[0],u[3*_+1]=p[b+1]+y[1],u[3*_+2]=p[b+2]+y[2]}for(i.bufferToBuffer(u,f,0,u,h,0,x),_=0;_<x;_++){var I=u[3*_],w=u[3*_+1],C=u[3*_+2],P=d+v*(g+_);p[P]=c[0]*I+c[4]*w+c[8]*C+c[12],p[P+1]=c[1]*I+c[5]*w+c[9]*C+c[13],p[P+2]=c[2]*I+c[6]*w+c[10]*C+c[14]}}},t.createOrigin=function(e,t,r,n){var s=a(e,t,r),u=s.center,l=s.id;return i.vectorToVector(u,r,u,n),o.fromVector(u,l)};var f=1,h=5-f}.apply(null,n))||(e.exports=i)},1633:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(476),r(16),r(1554),r(1549),r(1555),r(120)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l){Object.defineProperty(t,"__esModule",{value:!0});var c={added:[],removed:[]},f=new i.default,h=new l(0,0,0,0),p=function(e){function t(t){var r=e.call(this)||this;return r._tiles=new Map,r._index=a(9,o("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileScheme=t,r}return r(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var r="string"==typeof e?this.get(e):e;if(!r)return[];for(var n=t*r.resolution,i=r.bounds[0]-n,o=r.bounds[1]-n,a=r.bounds[2]+n,s=r.bounds[3]+n,u=[],l=0,c=this._index.search({minX:i,minY:o,maxX:a,maxY:s});l<c.length;l++){var f=c[l],h=f.bounds.slice();h[0]=Math.max(h[0],i),h[1]=Math.max(h[1],o),h[2]=Math.min(h[2],a),h[3]=Math.min(h[3],s),h[2]-h[0]>0&&h[3]-h[1]>0&&u.push({bounds:h,tile:f})}return u},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var r=t.spans,n=t.lodInfo,i=n.level;if(r.length>0)for(var o=0,a=r;o<a.length;o++)for(var u=a[o],l=u.row,p=u.colFrom,d=u.colTo,v=p;v<=d;v++){var y=h.set(i,l,n.normalizeCol(v),n.getWorldForColumn(v)).id;if(f.add(y),!this.has(y)){var m=new s.default(this.tileScheme,y);this._tiles.set(y,m),this._index.insert(m),this.tiles.push(m),c.added.push(m)}}for(var g=this.tiles.length-1;g>=0;g--){m=this.tiles[g];f.has(m.id)||(this._tiles.delete(m.id),this.tiles.splice(g,1),this._index.remove(m),c.removed.push(m))}(c.added.length||c.removed.length)&&this.emit("update",c),f.clear(),c.added.length=0,c.removed.length=0}},t}(u.default);t.default=p}.apply(null,n))||(e.exports=i)},1634:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(11),r(4),r(0),r(1817),r(1818),r(1819)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c){var f=o.strict()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"}),h=function(e){function t(t){var r=e.call(this)||this;return r.type=void 0,r.pointSizeAlgorithm=null,r.colorModulation=null,r.pointsPerInch=10,r}return r(t,e),t.prototype.clone=function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null},t.prototype.cloneProperties=function(){return{pointSizeAlgorithm:a.clone(this.pointSizeAlgorithm),colorModulation:a.clone(this.colorModulation),pointsPerInch:a.clone(this.pointsPerInch)}},n([s.property({type:f.apiValues,readOnly:!0,nonNullable:!0,json:{type:f.jsonValues,read:!1,write:f.write}})],t.prototype,"type",void 0),n([s.property({types:c.pointSizeAlgorithmTypes,json:{read:l.read,write:!0}})],t.prototype,"pointSizeAlgorithm",void 0),n([s.property({type:u.default,json:{write:!0}})],t.prototype,"colorModulation",void 0),n([s.property({json:{write:!0},nonNullable:!0,type:Number})],t.prototype,"pointsPerInch",void 0),n([s.subclass("esri.renderers.PointCloudRenderer")],t)}(s.declared(i));return(h||(h={})).fieldTransformTypeKebabDict=o({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"}),h}.apply(null,n))||(e.exports=i)},1666:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1526)],void 0===(i=function(e,t,r){return function(){function e(e,t,r,n,i,o,a,s){this._glyphItems=e,this._maxWidth=t,this._lineHeight=r,this._letterSpacing=n,this._offset=i,this._hAnchor=o,this._vAnchor=a,this._justify=s}return e.prototype.getShaping=function(e,t){for(var r=this._letterSpacing,n=this._lineHeight,i=this._justify,o=this._maxWidth,a=[],s=0,u=0,l=0,c=0,f=-1,h=0,p=-1,d=e.length,v=0;v<d;v++){var y=e.charCodeAt(v);if(10!==y){for(var m=void 0,g=0,x=this._glyphItems;g<x.length&&!(m=x[g][y]);g++);if(m){if(a.push({codePoint:y,x:s,y:u,glyphMosaicItem:m}),s+=m.metrics.advance+r,0<o&&o<s&&0<=p){var _=p+1;I=a[_].x,h=Math.max(I,h);for(var b=_;b<a.length;b++)t?a[b].y-=n:a[b].y+=n,a[b].x-=I;i&&this._applyJustification(a,c,p),t?u-=n:u+=n,s-=I,++l,c=_,p=-1}++f,32===y&&(p=a.length-1)}}else{if(v===d-1)continue;if(c<=f){var I=(w=a[f]).x+w.glyphMosaicItem.metrics.advance;h=Math.max(I,h),i&&this._applyJustification(a,c,f),c=a.length}t?u-=n:u+=n,s=0,++l}}if(c<=f){var w,C=(w=a[f]).x+w.glyphMosaicItem.metrics.advance;h=Math.max(h,C),i&&this._applyJustification(a,c,f)}if(0<a.length){var P=(i-this._hAnchor)*h,T=(-this._vAnchor*(l+1)+.5)*n;t&&l&&(T+=l*n),P+=this._offset[0],T+=this._offset[1];for(var S=0,D=a;S<D.length;S++){var A=D[S];A.x+=P,A.y+=T}}return a},e.getBox=function(e){if(!e.length)return null;for(var t=1/0,r=1/0,n=0,i=0,o=0,a=e;o<a.length;o++){var s=a[o],u=s.glyphMosaicItem.metrics,l=u.height,c=u.left,f=u.top,h=u.width,p=s.x,d=s.y-(l-Math.abs(f)),v=p+h+c,y=d+l;t=Math.min(t,p),n=Math.max(n,v),r=Math.min(r,d),i=Math.max(i,y)}return{x:t,y:r,width:n-t,height:i-r}},e.addDecoration=function(e,t){var n=e.length;if(0!==n){for(var i=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,a=1;a<n;a++){var s=e[a];if(s.y!==o){var u=e[a-1].x+e[a-1].glyphMosaicItem.metrics.left+e[a-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:i,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:u-i,height:8,left:0,top:0,advance:0},page:0}}),o=s.y,i=s.x+s.glyphMosaicItem.metrics.left}}var l=e[n-1].x+e[n-1].glyphMosaicItem.metrics.left+e[n-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:i,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:l-i,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,r){for(var n=e[r],i=n.glyphMosaicItem.metrics.advance,o=(n.x+i)*this._justify,a=t;a<=r;a++)e[a].x-=o},e}()}.apply(null,n))||(e.exports=i)},1667:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r,n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),(n=r=t.VectorRole||(t.VectorRole={}))[n.ENTRY=1]="ENTRY",n[n.EXIT=2]="EXIT",n[n.CAP=3]="CAP",(o=i=t.CapPosition||(t.CapPosition={}))[o.START=1]="START",o[o.END=2]="END",t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var a=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,s=-1,u=8/(2*Math.PI);function l(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push(void 0);return r}t.allocTriangles=function(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return r},t.allocExtrudeVectors=function(){var e=function(e){var t,r={items:new Array,count:0};for(t=0;t<30;++t)r.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return r}(),t={};return t[r.ENTRY]=l(20),t[r.EXIT]=l(20),t[r.CAP]=l(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var n;for(n=0;n<t.vectors.count;++n)e.vectors.items[n].vector[0]=t.vectors.items[n].vector[0],e.vectors.items[n].vector[1]=t.vectors.items[n].vector[1],e.vectors.items[n].texCoords[0]=t.vectors.items[n].texCoords[0],e.vectors.items[n].texCoords[1]=t.vectors.items[n].texCoords[1],e.vectors.items[n].direction[0]=t.vectors.items[n].direction[0],e.vectors.items[n].direction[1]=t.vectors.items[n].direction[1],e.vectors.items[n].base=t.vectors.items[n].base;e.vectors.count=t.vectors.count;var i=t.lists[r.ENTRY],o=e.lists[r.ENTRY],a=t.lists[r.EXIT],s=e.lists[r.EXIT],u=t.lists[r.CAP],l=e.lists[r.CAP];for(n=0;n<i.count;++n)o.items[n]=i.items[n];for(o.count=i.count,n=0;n<a.count;++n)s.items[n]=a.items[n];for(s.count=a.count,n=0;n<u.count;++n)l.items[n]=u.items[n];l.count=u.count,e.capCenter=t.capCenter};var c={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};function f(e,t){c.vector[0]=e.vector[0],c.vector[1]=e.vector[1],c.texCoords[0]=e.texCoords[0],c.texCoords[1]=e.texCoords[1],c.direction[0]=e.direction[0],c.direction[1]=e.direction[1],c.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=c.vector[0],t.vector[1]=c.vector[1],t.texCoords[0]=c.texCoords[0],t.texCoords[1]=c.texCoords[1],t.direction[0]=c.direction[0],t.direction[1]=c.direction[1],t.base=c.base}t.swapExtrudeVectors=f;var h,p=[];for(h=0;h<32;++h)p.push([void 0,void 0]);var d=function(e){var t,r={items:new Array,count:0};for(t=0;t<8;++t)r.items.push([void 0,void 0]);return r}();function v(e,t){return e[0]*t[0]+e[1]*t[1]}function y(e){return Math.sqrt(v(e,e))}function m(e,t){var r=y(t);return e[0]=t[0]/r,e[1]=t[1]/r,e}function g(e,t){return e[0]=-t[1],e[1]=t[0],e}function x(e,t){return e[0]*t[1]-e[1]*t[0]}function _(e,t){return e[0]=-t[0],e[1]=-t[1],e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function I(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function w(e,t,r){return n=e,o=r,((i=t)[0]-n[0])*(o[1]-n[1])-(o[0]-n[0])*(i[1]-n[1])<0;var n,i,o}function C(e,t){var r=v(e,t);return.999<r?0:r<-.999?Math.PI:Math.acos(r)}function P(e,t,r,n,i){if(0!==n){var o,a=y(t),s=(i?-1:1)*C(b(p[0],t,1/a),b(p[1],r,1/a))/n,u=Math.cos(s),l=Math.sin(s),c=t[0],f=t[1];for(o=0;o<n-1;++o){var h=c;c=u*h-l*f,f=l*h+u*f,e.items[o][0]=c,e.items[o][1]=f}e.count=n-1}else e.count=0}function T(e){var t,r=e.count,n=Math.floor(r/2);for(t=0;t<n;++t){var i=e.items[t];e.items[t]=e.items[r-t-1],e.items[r-t-1]=i}}t.length=y,t.normalize=m,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*u),1)},t.getRads=C,t.reverse=T;var S=[void 0,void 0],D=[void 0,void 0],A=[0,0],M=[0,0],E=[0,0],B=[0,0],N=Math.cos(Math.PI/4),V=Math.sin(Math.PI/4),O=Math.sqrt(2),L=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,n){var i,o,a,s,u=t.vectors,l=t.lists[r.EXIT],c=n.vectors,h=n.lists[r.ENTRY];if(l.count===h.count+1)i=l.items,o=u.items,a=h.items,s=c.items;else if(h.count===l.count+1)i=h.items,o=c.items,a=l.items,s=u.items;else{if(l.count!==h.count)return console.error("Cannot bridge "+l.count+" to "+h.count+"."),void(e.count=0);i=h.items,o=c.items,a=l.items,s=u.items}var p,d=l.count+h.count-2;for(e.count=d,S[0]=i,S[1]=a,D[0]=o,D[1]=s,p=0;p<d;++p){var v=e.items[p],y=(p+0)%2,m=Math.floor((p+0)/2),g=D[y][S[y][m]];v.v1.vector[0]=g.vector[0],v.v1.vector[1]=g.vector[1],v.v1.texCoords[0]=g.texCoords[0],v.v1.texCoords[1]=g.texCoords[1],v.v1.direction[0]=g.direction[0],v.v1.direction[1]=g.direction[1],v.v1.base=g.base;var x=(p+1)%2,_=Math.floor((p+1)/2),b=D[x][S[x][_]];v.v2.vector[0]=b.vector[0],v.v2.vector[1]=b.vector[1],v.v2.texCoords[0]=b.texCoords[0],v.v2.texCoords[1]=b.texCoords[1],v.v2.direction[0]=b.direction[0],v.v2.direction[1]=b.direction[1],v.v2.base=b.base;var I=(p+2)%2,C=Math.floor((p+2)/2),P=D[I][S[I][C]];v.v3.vector[0]=P.vector[0],v.v3.vector[1]=P.vector[1],v.v3.texCoords[0]=P.texCoords[0],v.v3.texCoords[1]=P.texCoords[1],v.v3.direction[0]=P.direction[0],v.v3.direction[1]=P.direction[1],v.v3.base=P.base;var T=v.v1.base&&v.v1.base.point||A,N=v.v2.base&&v.v2.base.point||A,V=v.v3.base&&v.v3.base.point||A;M[0]=T[0]+v.v1.vector[0],M[1]=T[1]+v.v1.vector[1],E[0]=N[0]+v.v2.vector[0],E[1]=N[1]+v.v2.vector[1],B[0]=V[0]+v.v3.vector[0],B[1]=V[1]+v.v3.vector[1],w(M,E,B)||f(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[r.CAP].count){if(1===t.lists[r.CAP].count)return console.error("A single vector is not enough to define a pie."),void(e.count=0);var n;for(e.count=t.lists[r.CAP].count-1,n=0;n<e.count;++n){var i=e.items[n],o=t.lists[r.CAP].items[n],a=t.vectors.items[o];i.v1.vector[0]=a.vector[0],i.v1.vector[1]=a.vector[1],i.v1.texCoords[0]=a.texCoords[0],i.v1.texCoords[1]=a.texCoords[1],i.v1.direction[0]=a.direction[0],i.v1.direction[1]=a.direction[1],i.v1.base=a.base;var s=t.lists[r.CAP].items[n+1],u=t.vectors.items[s];i.v2.vector[0]=u.vector[0],i.v2.vector[1]=u.vector[1],i.v2.texCoords[0]=u.texCoords[0],i.v2.texCoords[1]=u.texCoords[1],i.v2.direction[0]=u.direction[0],i.v2.direction[1]=u.direction[1],i.v2.base=u.base;var l=t.capCenter,c=t.vectors.items[l];i.v3.vector[0]=c.vector[0],i.v3.vector[1]=c.vector[1],i.v3.texCoords[0]=c.texCoords[0],i.v3.texCoords[1]=c.texCoords[1],i.v3.direction[0]=c.direction[0],i.v3.direction[1]=c.direction[1],i.v3.base=c.base;var h=i.v1.base&&i.v1.base.point||A,p=i.v2.base&&i.v2.base.point||A,d=i.v3.base&&i.v3.base.point||A;M[0]=h[0]+i.v1.vector[0],M[1]=h[1]+i.v1.vector[1],E[0]=p[0]+i.v2.vector[0],E[1]=p[1]+i.v2.vector[1],B[0]=d[0]+i.v3.vector[0],B[1]=d[1]+i.v3.vector[1],w(M,E,B)||f(i.v2,i.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,r){this.fastMiterJoin(e,t,r)},e.prototype.roundCap=function(e,t,n,o,a,s){void 0===s&&(s=0),this.fastMiterJoin(e,t,n);var u=o===i.START?0:1,l=o===i.START?1:0;e.capCenter=e.vectors.count;var c=e.vectors.items[e.capCenter];c.vector[0]=0,c.vector[1]=0,c.texCoords[0]=0,c.texCoords[1]=0,c.direction[0]=0,c.direction[1]=0,++e.vectors.count,P(d,e.vectors.items[u].vector,e.vectors.items[l].vector,a,!1);var f=e.vectors.count,h=e.lists[r.CAP];h.items[0]=u;var p,v=e.vectors.items[u].texCoords[1],y=e.vectors.items[l].texCoords[1];for(p=0;p<d.count;++p){var m=s*(1-Math.abs(d.count/2-p)/(d.count/2)),g=v+p/(d.count-1)*(y-v),x=d.items[p],_=e.vectors.items[f+p];_.vector[0]=x[0],_.vector[1]=x[1],_.texCoords[0]=m,_.texCoords[1]=g,_.direction[0]=0,_.direction[1]=0,h.items[p+1]=f+p}h.items[d.count+1]=l,h.count=d.count+2,e.vectors.count=f+d.count},e.prototype.squareCap=function(e,t,r,n){this.fastMiterJoin(e,t,r);var o=n===i.START?0:1,a=n===i.START?1:0,s=p[0],u=p[1],l=p[2],c=p[3],f=p[4],h=e.vectors.items[o].vector;s[0]=N*h[0]-V*h[1],s[1]=V*h[0]+N*h[1],b(c,s,O),u[0]=N*s[0]-V*s[1],u[1]=V*s[0]+N*s[1],l[0]=N*u[0]-V*u[1],l[1]=V*u[0]+N*u[1],b(f,l,O);var d=e.vectors.items[o];d.vector[0]=c[0],d.vector[1]=c[1];var v=e.vectors.items[a];v.vector[0]=f[0],v.vector[1]=f[1]},e.prototype.squareCapForDashedLines=function(e,t,n,o){if(o===i.START){var a=g(p[0],n),s=_(p[4],a),u=p[1],l=p[2],c=p[3];u[0]=N*a[0]-V*a[1],u[1]=V*a[0]+N*a[1],l[0]=N*u[0]-V*u[1],l[1]=V*u[0]+N*u[1],c[0]=N*l[0]-V*l[1],c[1]=V*l[0]+N*l[1],(f=p[5])[0]=0,f[1]=0,e.capCenter=0,(h=e.vectors.items)[0].vector[0]=f[0],h[0].vector[1]=f[1],h[0].direction[0]=0,h[0].direction[1]=0,h[0].texCoords[0]=0,h[0].texCoords[1]=0,h[1].vector[0]=a[0],h[1].vector[1]=a[1],h[1].direction[0]=0,h[1].direction[1]=0,h[1].texCoords[0]=0,h[1].texCoords[1]=-1,h[2].vector[0]=u[0]*O,h[2].vector[1]=u[1]*O,h[2].direction[0]=0,h[2].direction[1]=0,h[2].texCoords[0]=-1,h[2].texCoords[1]=-1,h[3].vector[0]=c[0]*O,h[3].vector[1]=c[1]*O,h[3].direction[0]=0,h[3].direction[1]=0,h[3].texCoords[0]=-1,h[3].texCoords[1]=1,h[4].vector[0]=s[0],h[4].vector[1]=s[1],h[4].direction[0]=0,h[4].direction[1]=0,h[4].texCoords[0]=0,h[4].texCoords[1]=1,e.vectors.count=5,e.lists[r.CAP].count=4,e.lists[r.CAP].items[0]=1,e.lists[r.CAP].items[1]=2,e.lists[r.CAP].items[2]=3,e.lists[r.CAP].items[3]=4,e.lists[r.ENTRY].count=0,e.lists[r.EXIT].count=3,e.lists[r.EXIT].items[0]=1,e.lists[r.EXIT].items[1]=0,e.lists[r.EXIT].items[2]=4}else{var f,h;a=g(p[0],n),s=_(p[4],a),u=p[1],l=p[2],c=p[3],u[0]=N*s[0]-V*s[1],u[1]=V*s[0]+N*s[1],l[0]=N*u[0]-V*u[1],l[1]=V*u[0]+N*u[1],c[0]=N*l[0]-V*l[1],c[1]=V*l[0]+N*l[1],(f=p[5])[0]=0,f[1]=0,e.capCenter=0,(h=e.vectors.items)[0].vector[0]=f[0],h[0].vector[1]=f[1],h[0].direction[0]=0,h[0].direction[1]=0,h[0].texCoords[0]=0,h[0].texCoords[1]=0,h[1].vector[0]=s[0],h[1].vector[1]=s[1],h[1].direction[0]=0,h[1].direction[1]=0,h[1].texCoords[0]=0,h[1].texCoords[1]=1,h[2].vector[0]=u[0]*O,h[2].vector[1]=u[1]*O,h[2].direction[0]=0,h[2].direction[1]=0,h[2].texCoords[0]=1,h[2].texCoords[1]=1,h[3].vector[0]=c[0]*O,h[3].vector[1]=c[1]*O,h[3].direction[0]=0,h[3].direction[1]=0,h[3].texCoords[0]=1,h[3].texCoords[1]=-1,h[4].vector[0]=a[0],h[4].vector[1]=a[1],h[4].direction[0]=0,h[4].direction[1]=0,h[4].texCoords[0]=0,h[4].texCoords[1]=-1,e.vectors.count=5,e.lists[r.CAP].count=4,e.lists[r.CAP].items[0]=1,e.lists[r.CAP].items[1]=2,e.lists[r.CAP].items[2]=3,e.lists[r.CAP].items[3]=4,e.lists[r.ENTRY].count=3,e.lists[r.ENTRY].items[0]=4,e.lists[r.ENTRY].items[1]=0,e.lists[r.ENTRY].items[2]=1,e.lists[r.EXIT].count=0}},e.prototype.fastMiterJoin=function(e,t,n){var i=g(p[0],n),o=i,a=_(p[1],i),u=e.vectors.items[0];u.vector[0]=o[0],u.vector[1]=o[1],u.texCoords[0]=0,u.texCoords[1]=s,u.direction[0]=0,u.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=a[0],l.vector[1]=a[1],l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0,e.vectors.count=2;var c=e.lists[r.ENTRY];c.items[0]=0,c.items[1]=1,c.count=2;var f=e.lists[r.EXIT];f.items[0]=0,f.items[1]=1,f.count=2,e.lists[r.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,n){var i=g(p[0],t),o=g(p[1],n),a=p[2];a[0]=i[0]+o[0],a[1]=i[1]+o[1];var u=m(p[3],a),l=v(u,i);u=b(p[4],u,1/l);var c=_(p[5],u);if(this._distanceAlongCorrection){(d=e.vectors.items[0]).vector[0]=u[0],d.vector[1]=u[1],d.texCoords[0]=0,d.texCoords[1]=s,d.direction[0]=t[0],d.direction[1]=t[1],(y=e.vectors.items[1]).vector[0]=c[0],y.vector[1]=c[1],y.texCoords[0]=0,y.texCoords[1]=1,y.direction[0]=t[0],y.direction[1]=t[1];var f=e.vectors.items[2];f.vector[0]=u[0],f.vector[1]=u[1],f.texCoords[0]=0,f.texCoords[1]=s,f.direction[0]=n[0],f.direction[1]=n[1];var h=e.vectors.items[3];h.vector[0]=c[0],h.vector[1]=c[1],h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=n[0],h.direction[1]=n[1],e.vectors.count=4,(x=e.lists[r.ENTRY]).items[0]=0,x.items[1]=1,x.count=2,(I=e.lists[r.EXIT]).items[0]=2,I.items[1]=3,I.count=2}else{var d,y,x,I;(d=e.vectors.items[0]).vector[0]=u[0],d.vector[1]=u[1],d.texCoords[0]=0,d.texCoords[1]=s,d.direction[0]=0,d.direction[1]=0,(y=e.vectors.items[1]).vector[0]=c[0],y.vector[1]=c[1],y.texCoords[0]=0,y.texCoords[1]=1,y.direction[0]=0,y.direction[1]=0,e.vectors.count=2,(x=e.lists[r.ENTRY]).items[0]=0,x.items[1]=1,x.count=2,(I=e.lists[r.EXIT]).items[0]=0,I.items[1]=1,I.count=2}e.lists[r.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,n,i){var o=i*i,u=x(t,n),l=0<u?[s,1]:[1,s],c=l[0],f=l[1],h=0<u?_(p[0],g(p[1],t)):g(p[2],t),d=0<u?_(p[3],g(p[4],n)):g(p[5],n),y=p[6];y[0]=h[0]+d[0],y[1]=h[1]+d[1];var w=m(p[7],y),C=_(p[8],w),P=v(w,h),S=x(w,h),D=Math.abs(S/P),A=1+D*D,M=A<a?[D,this._distanceAlongCorrection]:[Math.sqrt(a-1),!0],E=M[0],B=M[1],N=A<o?[D,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],V=N[0],O=N[1];if(O&&B){I((j=e.vectors.items[0]).vector,_(p[9],h),b(p[10],_(p[11],t),E)),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=this._distanceAlongCorrection?t[0]:0,j.direction[1]=this._distanceAlongCorrection?t[1]:0,I((k=e.vectors.items[1]).vector,_(p[12],d),b(p[13],n,E)),k.texCoords[0]=0,k.texCoords[1]=c,k.direction[0]=this._distanceAlongCorrection?n[0]:0,k.direction[1]=this._distanceAlongCorrection?n[1]:0,(F=e.vectors.items[2]).vector[0]=0,F.vector[1]=0,F.texCoords[0]=0,F.texCoords[1]=0,F.direction[0]=0,F.direction[1]=0,I((z=e.vectors.items[3]).vector,h,b(p[14],t,V)),z.texCoords[0]=0,z.texCoords[1]=f,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0;var L=e.vectors.items[4];I(L.vector,d,b(p[15],_(p[16],n),V)),L.texCoords[0]=0,L.texCoords[1]=f,L.direction[0]=this._distanceAlongCorrection?n[0]:0,L.direction[1]=this._distanceAlongCorrection?n[1]:0,e.vectors.count=5,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=2,U.items[2]=3,U.count=3,(Y=e.lists[r.EXIT]).items[0]=1,Y.items[1]=2,Y.items[2]=4,Y.count=3,A<o?((R=e.lists[r.CAP]).count=0,e.capCenter=void 0):((R=e.lists[r.CAP]).items[0]=3,R.items[1]=4,R.count=2,e.capCenter=2)}else if(!O&&B)I((j=e.vectors.items[0]).vector,_(p[9],h),b(p[10],_(p[11],t),E)),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=this._distanceAlongCorrection?t[0]:0,j.direction[1]=this._distanceAlongCorrection?t[1]:0,I((k=e.vectors.items[1]).vector,_(p[12],d),b(p[13],n,E)),k.texCoords[0]=0,k.texCoords[1]=c,k.direction[0]=this._distanceAlongCorrection?n[0]:0,k.direction[1]=this._distanceAlongCorrection?n[1]:0,(F=e.vectors.items[2]).vector[0]=0,F.vector[1]=0,F.texCoords[0]=0,F.texCoords[1]=0,F.direction[0]=0,F.direction[1]=0,b((z=e.vectors.items[3]).vector,w,1/P),z.texCoords[0]=0,z.texCoords[1]=f,z.direction[0]=0,z.direction[1]=0,e.vectors.count=4,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=2,U.items[2]=3,U.count=3,(Y=e.lists[r.EXIT]).items[0]=1,Y.items[1]=2,Y.items[2]=3,Y.count=3,e.lists[r.CAP].count=0,e.capCenter=void 0;else if(O&&!B){var F,z,R;b((j=e.vectors.items[0]).vector,C,1/P),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=0,j.direction[1]=0,(k=e.vectors.items[1]).vector[0]=0,k.vector[1]=0,k.texCoords[0]=0,k.texCoords[1]=0,k.direction[0]=0,k.direction[1]=0,I((F=e.vectors.items[2]).vector,h,b(p[9],t,V)),F.texCoords[0]=0,F.texCoords[1]=f,F.direction[0]=this._distanceAlongCorrection?t[0]:0,F.direction[1]=this._distanceAlongCorrection?t[1]:0,I((z=e.vectors.items[3]).vector,d,b(p[10],_(p[11],n),V)),z.texCoords[0]=0,z.texCoords[1]=f,z.direction[0]=this._distanceAlongCorrection?n[0]:0,z.direction[1]=this._distanceAlongCorrection?n[1]:0,e.vectors.count=4,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=1,U.items[2]=2,U.count=3,(Y=e.lists[r.EXIT]).items[0]=0,Y.items[1]=1,Y.items[2]=3,Y.count=3,A<o?((R=e.lists[r.CAP]).count=0,e.capCenter=void 0):((R=e.lists[r.CAP]).items[0]=2,R.items[1]=3,R.count=2,e.capCenter=1)}else if(!O&&!B){var j,k,U,Y;b((j=e.vectors.items[0]).vector,C,1/P),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=0,j.direction[1]=0,b((k=e.vectors.items[1]).vector,w,1/P),k.texCoords[0]=0,k.texCoords[1]=f,k.direction[0]=0,k.direction[1]=0,e.vectors.count=2,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=1,U.count=2,(Y=e.lists[r.EXIT]).items[0]=0,Y.items[1]=1,Y.count=2,e.lists[r.CAP].count=0,e.capCenter=void 0}u<0&&(T(e.lists[r.ENTRY]),T(e.lists[r.EXIT]))},e.prototype.roundJoin=function(e,t,n,i){var o=x(t,n),u=0<o?[s,1]:[1,s],l=u[0],c=u[1],f=0<o?_(p[0],g(p[1],t)):g(p[2],t),h=0<o?_(p[3],g(p[4],n)):g(p[5],n),y=p[6];y[0]=f[0]+h[0],y[1]=f[1]+h[1];var w=m(p[7],y),C=_(p[8],w),S=v(w,f),D=x(w,f),A=Math.abs(D/S),M=1+A*A<a?[A,this._distanceAlongCorrection]:[Math.sqrt(a-1),!0],E=M[0];if(M[1]){(N=e.vectors.items[0]).vector[0]=f[0],N.vector[1]=f[1],N.texCoords[0]=0,N.texCoords[1]=c,N.direction[0]=0,N.direction[1]=0,(V=e.vectors.items[1]).vector[0]=h[0],V.vector[1]=h[1],V.texCoords[0]=0,V.texCoords[1]=c,V.direction[0]=0,V.direction[1]=0,I((O=e.vectors.items[2]).vector,_(p[9],f),b(p[10],_(p[11],t),E)),O.texCoords[0]=0,O.texCoords[1]=l,O.direction[0]=this._distanceAlongCorrection?t[0]:0,O.direction[1]=this._distanceAlongCorrection?t[1]:0,I((L=e.vectors.items[3]).vector,_(p[12],h),b(p[13],n,E)),L.texCoords[0]=0,L.texCoords[1]=l,L.direction[0]=this._distanceAlongCorrection?n[0]:0,L.direction[1]=this._distanceAlongCorrection?n[1]:0;var B=e.vectors.items[4];B.vector[0]=0,B.vector[1]=0,B.texCoords[0]=0,B.texCoords[1]=0,B.direction[0]=0,B.direction[1]=0,e.vectors.count=5,(F=e.lists[r.ENTRY]).items[0]=2,F.items[1]=4,F.items[2]=0,F.count=3,(z=e.lists[r.EXIT]).items[0]=3,z.items[1]=4,z.items[2]=1,z.count=3,e.capCenter=4}else{var N,V,O,L,F,z;(N=e.vectors.items[0]).vector[0]=f[0],N.vector[1]=f[1],N.texCoords[0]=0,N.texCoords[1]=c,N.direction[0]=0,N.direction[1]=0,(V=e.vectors.items[1]).vector[0]=h[0],V.vector[1]=h[1],V.texCoords[0]=0,V.texCoords[1]=c,V.direction[0]=0,V.direction[1]=0,b((O=e.vectors.items[2]).vector,C,1/S),O.texCoords[0]=0,O.texCoords[1]=l,O.direction[0]=0,O.direction[1]=0,(L=e.vectors.items[3]).vector[0]=0,L.vector[1]=0,L.texCoords[0]=0,L.texCoords[1]=0,L.direction[0]=0,L.direction[1]=0,e.vectors.count=4,(F=e.lists[r.ENTRY]).items[0]=2,F.items[1]=3,F.items[2]=0,F.count=3,(z=e.lists[r.EXIT]).items[0]=2,z.items[1]=3,z.items[2]=1,z.count=3,e.capCenter=3}P(d,f,h,i,o<0);var R,j=e.vectors.count,k=e.lists[r.CAP];for(R=k.items[0]=0;R<d.count;++R){var U=d.items[R],Y=e.vectors.items[j+R];Y.vector[0]=U[0],Y.vector[1]=U[1],Y.texCoords[0]=0,Y.texCoords[1]=c,Y.direction[0]=0,Y.direction[1]=0,k.items[R+1]=j+R}k.items[d.count+1]=1,k.count=d.count+2,e.vectors.count=j+d.count,o<0&&(T(e.lists[r.ENTRY]),T(e.lists[r.EXIT]))},e.prototype.unitRoundJoin=function(e,t,n,i){var o=x(t,n),a=0<o?[s,1]:[1,s],u=a[0],l=a[1],c=0<o?_(p[0],g(p[1],t)):g(p[2],t),f=0<o?_(p[3],g(p[4],n)):g(p[5],n),h=e.vectors.items[0];h.vector[0]=c[0],h.vector[1]=c[1],h.texCoords[0]=0,h.texCoords[1]=l,h.direction[0]=0,h.direction[1]=0;var v=e.vectors.items[1];v.vector[0]=f[0],v.vector[1]=f[1],v.texCoords[0]=0,v.texCoords[1]=l,v.direction[0]=0,v.direction[1]=0;var y=e.vectors.items[2];_(y.vector,c),y.texCoords[0]=0,y.texCoords[1]=u,y.direction[0]=0,y.direction[1]=0;var m=e.vectors.items[3];_(m.vector,f),m.texCoords[0]=0,m.texCoords[1]=u,m.direction[0]=0,m.direction[1]=0;var b=e.vectors.items[4];b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,e.vectors.count=5;var I=e.lists[r.ENTRY];I.items[0]=2,I.items[1]=0,I.count=2;var w=e.lists[r.EXIT];w.items[0]=3,w.items[1]=1,w.count=2,e.capCenter=4,P(d,c,f,i,o<0);var C,S=e.vectors.count,D=e.lists[r.CAP];for(C=D.items[0]=0;C<d.count;++C){var A=d.items[C],M=e.vectors.items[S+C];M.vector[0]=A[0],M.vector[1]=A[1],M.texCoords[0]=0,M.texCoords[1]=l,M.direction[0]=0,M.direction[1]=0,D.items[C+1]=S+C}D.items[d.count+1]=1,D.count=d.count+2,e.vectors.count=S+d.count,o<0&&(T(e.lists[r.ENTRY]),T(e.lists[r.EXIT]))},e.prototype.rectJoin=function(e,t,n){var i=g(p[0],t),o=g(p[1],n),a=e.vectors.items[0];a.vector[0]=i[0],a.vector[1]=i[1],a.texCoords[0]=0,a.texCoords[1]=s,a.direction[0]=0,a.direction[1]=0;var u=e.vectors.items[1];u.vector[0]=o[0],u.vector[1]=o[1],u.texCoords[0]=0,u.texCoords[1]=s,u.direction[0]=0,u.direction[1]=0;var l=e.vectors.items[2];_(l.vector,i),l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0;var c=e.vectors.items[3];_(c.vector,o),c.texCoords[0]=0,c.texCoords[1]=1,c.direction[0]=0,c.direction[1]=0,e.vectors.count=4;var f=e.lists[r.ENTRY];f.items[0]=0,f.items[1]=2,f.count=2;var h=e.lists[r.EXIT];h.items[0]=1,h.items[1]=3,h.count=2,e.capCenter=void 0},e}();t.Tessellator=L}.apply(null,n))||(e.exports=i)},1673:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(11),r(0)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.typeKebabDictionary=o({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});var s=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),n([a.property({type:t.typeKebabDictionary.apiValues,readOnly:!0,nonNullable:!0,json:{type:t.typeKebabDictionary.jsonValues,read:!1,write:t.typeKebabDictionary.write}})],i.prototype,"type",void 0),n([a.subclass("esri.renderers.support.pointCloud.PointSizeAlgorithm")],i)}(a.declared(i));t.PointSizeAlgorithm=s,t.default=s}.apply(null,n))||(e.exports=i)},1674:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34),r(1435),r(1635),r(1355)],void 0===(i=function(e,t,r,n,i,o){function a(e,t,r,n,i,o,a){switch(r){case 1:for(var s=0;s<a;s++)n[i]=e[t],t+=1,i+=o;break;case 2:for(s=0;s<a;s++)n[i]=e[t],n[i+1]=e[t+1],t+=2,i+=o;break;case 3:for(s=0;s<a;s++)n[i]=e[t],n[i+1]=e[t+1],n[i+2]=e[t+2],t+=3,i+=o;break;case 4:for(s=0;s<a;s++)n[i]=e[t],n[i+1]=e[t+1],n[i+2]=e[t+2],n[i+3]=e[t+3],t+=4,i+=o;break;default:throw h("Unhandled stride size "+r)}}function s(e,t,r,n,i,o){switch(t){case 1:for(var a=0;a<o;a++)r[n]=e,n+=i;break;case 2:for(a=0;a<o;a++)r[n]=e,r[n+1]=e,n+=i;break;case 3:for(a=0;a<o;a++)r[n]=e,r[n+1]=e,r[n+2]=e,n+=i;break;case 4:for(a=0;a<o;a++)r[n]=e,r[n+1]=e,r[n+2]=e,r[n+3]=e,n+=i;break;default:throw h("Unhandled stride size "+t)}}function u(e){switch(e){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array}throw new Error("Unhandled data type: "+e)}function l(e){switch(e){case 5120:return"Int8";case 5126:return"Float32";case 5124:return"Int32";case 5122:return"Int16";case 5121:return"UInt8";case 5125:return"UInt32";case 5123:return"UInt16"}throw new Error("Unhandled data type: "+e)}function c(e){return e%Uint32Array.BYTES_PER_ELEMENT==0}function f(e){return e>0&&e%Uint32Array.BYTES_PER_ELEMENT==0}function h(e){return new Error("I3SGeometryUtil processing failed: "+e)}function p(e){var t=e.normals,n=e.positions,i=e.normalInd,a=e.positionInd;o.assert(e.normalInd.length===e.positionInd.length);for(var s=r.vec3f32.create(),u=r.vec3f32.create(),l=r.vec2f32.create(),c=n.data,f=n.offsetIdx,h=n.strideIdx,p=t.data,d=t.offsetIdx,v=t.strideIdx,y=0;y<a.length;y+=3){var m=a[y],g=f+h*m,x=c[g],_=c[g+1],b=c[g+2];g=f+h*(m=a[y+1]),s[0]=c[g]-x,s[1]=c[g+1]-_,s[2]=c[g+2]-b,g=f+h*(m=a[y+2]),u[0]=c[g]-x,u[1]=c[g+1]-_,u[2]=c[g+2]-b,r.vec3.cross(s,s,u),o.encodeNormal(s,l);for(var I=0;I<3;I++){var w=d+v*i[y+I];p[w]=o.encodeInt16(l[0]),p[w+1]=o.encodeInt16(l[1])}}}function d(e,t,r){var n=e.length/3,i=t.data,a=t.offsetIdx,s=t.strideIdx;if(null!=r)for(var u=r,l=u[0],c=u[1],f=u[2],h=u[4],p=u[5],d=u[6],v=u[8],y=u[9],x=u[10],_=0;_<n;_++){var b=e[3*_],I=e[3*_+1],w=e[3*_+2];m[0]=l*b+c*I+f*w,m[1]=h*b+p*I+d*w,m[2]=v*b+y*I+x*w,o.encodeNormal(m,g),i[a+_*s]=o.encodeInt16(g[0]),i[a+_*s+1]=o.encodeInt16(g[1])}else for(_=0;_<n;_++)m[0]=e[3*_],m[1]=e[3*_+1],m[2]=e[3*_+2],o.encodeNormal(m,g),i[a+_*s]=o.encodeInt16(g[0]),i[a+_*s+1]=o.encodeInt16(g[1])}Object.defineProperty(t,"__esModule",{value:!0});var v=new Uint8Array(64);t.interleaveGeometryBuffer=function(e,t,r,n,i){void 0===n&&(n=[]),void 0===i&&(i=[]);var o=e.params.vertexAttributes,p=o.position.count;if(!f(r[0].stride))throw h("Layout stride must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");for(var d=r[0].stride/Uint32Array.BYTES_PER_ELEMENT,y=new Uint32Array(d*p),m=0,g=r=r.slice(0).sort(function(e,t){return e.offset-t.offset});m<g.length;m++)!function(e){if(-1!==i.indexOf(e.name))return"continue";var r=o[e.name],d=u(e.type),m=void 0,g=!1;if(null==r){var x=n.filter(function(t){return t.name===e.name})[0];if(!x)throw h("Geometry definition is missing attribute");r={valueType:l(e.type),byteOffset:0,count:p,valuesPerElement:e.count};for(var _=0;_<v.length;_++)v[_]=x.byteValue;m=v.buffer,g=!0}else m=t;if(l(e.type)!==r.valueType)throw h("Geometry definition type must match attribute type");if(!c(r.byteOffset)||!c(e.offset))throw h(e.name+" offset must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");if(!f(r.valuesPerElement*d.BYTES_PER_ELEMENT)||!f(e.count*d.BYTES_PER_ELEMENT))throw h(e.name+" data must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");var b=new Uint32Array(m),I=r.byteOffset/Uint32Array.BYTES_PER_ELEMENT,w=r.valuesPerElement*d.BYTES_PER_ELEMENT/Uint32Array.BYTES_PER_ELEMENT,C=e.offset/Uint32Array.BYTES_PER_ELEMENT,P=e.stride/Uint32Array.BYTES_PER_ELEMENT;g?s(b[0],w,y,C,P,p):a(b,I,w,y,C,P,p)}(g[m]);return y.buffer},t.processAndInterleaveNormals=function(e,t,r,i,o){if("none"===e)p(o);else{var a=n.createTypedView(r,t.params.vertexAttributes.normal),s="earth-centered"===e?i:null;d(a,o.normals,s)}};var y=65536;t.extractPositionData=function(e,t,r){var n=t[0];if(null==n||"position"!==n.name||5126!==n.type)return null;for(var o=new Float32Array(e),a=n.stride/4,s=3*o.length/a,u=new Float32Array(s),l=0;l<s/3;l++)u[3*l]=o[l*a+n.offset],u[3*l+1]=o[l*a+n.offset+1],u[3*l+2]=o[l*a+n.offset+2];var c,f=i.deduplicate(u.buffer,3),h=f.uniqueCount<y;if(r)for(c=new(h?Uint16Array:Uint32Array)(r.length),l=0;l<r.length;l++)c[l]=f.indices[r[l]];else c=h?new Uint16Array(f.indices):f.indices;return{data:new Float32Array(f.buffer),indices:c}};var m=r.vec3f32.create(),g=r.vec2f32.create()}.apply(null,n))||(e.exports=i)},1676:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1426),r(9),r(16),r(7),r(1554),r(81),r(488)],void 0===(i=function(e,t,r,n,i,o,a,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=[],c=o.getLogger("esri.layers.graphics.data.FeatureStore"),f={minX:0,minY:0,maxX:0,maxY:0},h=function(){function e(e){this._featuresById=new r.default,this._boundsByFeature=new r.default,this._featuresByBounds=new r.default,this._index=a(9,i("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._geometryInfo=e}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var e=s.create(s.NEGATIVE_INFINITY);return this._boundsByFeature.forEach(function(t){t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]))}),e},enumerable:!0,configurable:!0}),e.prototype.setEngine=function(e){this._engine=e},e.prototype.add=function(e){this._add(e,l),this._index.load(l),this._clearCache(),l.length=0},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this._add(n,l)}this._index.load(l),this._clearCache(),l.length=0},e.prototype.clear=function(){this._featuresById.clear(),this._boundsByFeature.clear(),this._featuresByBounds.clear(),this._index.clear(),this._clearCache()},e.prototype.removeManyById=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t],i=this._featuresById.get(n);if(i){var o=this._boundsByFeature.get(i);o&&(this._index.remove(o),this._featuresByBounds.delete(o)),this._boundsByFeature.delete(i)}this._featuresById.delete(n)}this._clearCache()},e.prototype.forEachBounds=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r],o=this._boundsByFeature.get(i);o&&t(o,i)}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.hasFeature=function(e){return this._featuresById.has(e)},e.prototype.forEachFeature=function(e){this._featuresById.forEach(function(t){return e(t)})},e.prototype.forEachFeatureInBounds=function(e,t){for(var r=0,n=function(e,t){return f.minX=t[0],f.minY=t[1],f.maxX=t[2],f.maxY=t[3],e.search(f)}(this._index,e);r<n.length;r++){var i=n[r];t(this._featuresByBounds.get(i))}},e.prototype.transferIds=function(e,t){for(var r=[],n=0,i=t;n<i.length;n++){var o=i[n],a=this._featuresById.get(o);a&&(this._remove(a),r.push(a))}e.addMany(r),this._clearCache()},e.prototype.transferIdRange=function(e,t,r){for(var n=[],i=t;i<r;i++){var o=this._featuresById.get(i);o&&(this._remove(o),n.push(o))}e.addMany(n),this._clearCache()},e.prototype.transferIf=function(e,t){var r=this,n=[];this._featuresById.forEach(function(e,i){t(e)&&(r._remove(e),n.push(e))}),e.addMany(n),this._clearCache()},e.prototype.transferAll=function(e){var t=this,r=[];this._featuresById.forEach(function(e,n){t._remove(e),r.push(e)}),e.addMany(r),this._clearCache()},e.prototype._clearCache=function(){this._engine&&this._engine.clearCache()},e.prototype._add=function(e,t){if(e){var r=e.objectId;if(null==r)return void c.error(new n("featurestore:invalid-feature","feature id is missing",{feature:e}));var i,o=this._featuresById.get(r);if(o&&(i=this._boundsByFeature.get(o))&&(this._index.remove(i),this._boundsByFeature.delete(o),this._featuresByBounds.delete(i)),!e.geometry)return this._boundsByFeature.set(e,null),void this._featuresById.set(r,e);i=u.getBoundsOptimizedGeometry(i||s.create(),e.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(e,i),this._featuresByBounds.set(i,e),this._featuresById.set(r,e),t.push(i)}},e.prototype._remove=function(e){var t;e&&((t=this._boundsByFeature.get(e))&&(this._index.remove(t),this._boundsByFeature.delete(e),this._featuresByBounds.delete(t)),this._featuresById.delete(e.objectId))},e}();t.default=h}.apply(null,n))||(e.exports=i)},1677:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(476),r(9),r(516),r(1557)],void 0===(i=function(e,t,r,n,i,o){function a(e){if(!e)return null;var r=t.invalidClauseCache.get(e);if(void 0!==r)return r;var n,i=t.whereClausesCache.get(e);return void 0!==i?i:(n=o.create(e),t.whereClausesCache.put(e,n),n)}function s(e,t,r,i){void 0===i&&(i=!0);for(var o=[],c=0,f=t;c<f.length;c++){var h=f[c];if("*"!==h&&!e.has(h))if(i){var p=u(h);try{var d=a(p);if(!d.isStandardized())throw new n(l,"expression is not standard",{clause:d});s(e,d.getFields(),"expression contains missing fields")}catch(e){var v=e&&e.details;if(v&&v.clause)throw e;v&&v.missingFields?Array.prototype.push.apply(o,v.missingFields):o.push(h)}}else o.push(h)}if(o.length)throw new n(l,r,{missingFields:o})}function u(e){return e.split(c)[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.invalidClauseCache=new i(500),t.whereClausesCache=new i(50);var l="feature-store:unsupported-query",c=" as ",f=new r.default(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,r){if(!r)return!0;var i;try{i=o.create(r),t.whereClausesCache.put(r,i)}catch(e){throw t.invalidClauseCache.put(r,null),new n(l,"invalid SQL expression",{where:r})}if(!i.isStandardized())throw new n(l,"where clause is not standard",{where:r});return s(e,i.getFields(),"where clause contains missing fields"),!0},t.validateHaving=function(e,r,i){if(!r)return!0;var a;try{a=o.create(r),t.whereClausesCache.put(r,a)}catch(e){throw t.invalidClauseCache.put(r,null),new n(l,"invalid SQL expression",{having:r})}if(!a.isAggregate())throw new n(l,"having does not contain a valid aggregate function",{having:r});var u=a.getFields();if(s(e,u,"having contains missing fields"),!a.getExpressions().every(function(t){var r=t.aggregateType,n=t.field,o=e.has(n)&&e.get(n).name;return i.some(function(t){var n=t.onStatisticField,i=t.statisticType,a=n.toLowerCase().trim();return(e.has(a)&&e.get(a).name)===o&&i.toLowerCase().trim()===r})}))throw new n(l,"expressions in having should also exist in outStatistics",{having:r});return!0},t.getWhereClause=a,t.validateFields=s,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(c)[1]},t.hasInvalidFieldType=function(e,t){var r=!1;if(-1!==a(e).getFields().indexOf(e)){var n=t.get(e);r=!f.has(n.type)}return r}}.apply(null,n))||(e.exports=i)},1704:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}return Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.array.length=0},e.prototype.toBuffer=function(){return new Uint32Array(this._array).buffer},e.i1616to32=function(e,t){return 65535&e|t<<16},e.i8888to32=function(e,t,r,n){return 255&e|(255&t)<<8|(255&r)<<16|n<<24},e.i8816to32=function(e,t,r){return 255&e|(255&t)<<8|r<<16},e}()}.apply(null,n))||(e.exports=i)},1705:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(1426),r(476),r(32),r(9),r(7),r(480),r(8),r(1716),r(81),r(166),r(70),r(59),r(1677),r(1552),r(524),r(1827),r(1829),r(1732),r(97)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,f,h,p,d,v,y,m,g,x,_,b){function I(e){return e?JSON.parse(JSON.stringify(e,["latestWkid","wkid","wkt"])):e}function w(e,t,r,n,i,o,a,s){a&&!o?n.forEachFeatureInBounds(i,function(t){var n=_.getCentroid(r,t,s),i=t.attributes;n&&e.push(new P(i,null,n))}):o&&!a?n.forEachFeatureInBounds(i,function(n){var i=n.attributes,o=_.getGeometry(r,n,0,s);o&&(t.add(n.objectId),e.push(new P(i,o)))}):n.forEachFeatureInBounds(i,function(n){var i=n.attributes,o=_.getGeometry(r,n,0,s),a=_.getCentroid(r,n,s);o&&a&&(t.add(n.objectId),e.push(new P(i,o,a)))})}Object.defineProperty(t,"__esModule",{value:!0});var C=s.getLogger("esri.layers.graphics.data.QueryEngine"),P=function(){return function(e,t,r){this.attributes=e,this.geometry=t,this.centroid=r}}(),T={},S=new i.default,D=new u.Storage(2e6),A=0,M=function(){function e(e){var t=this;this.capabilities={query:m.queryCapabilities},this.fieldsMap=new n.default,this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.gdbVersion=e.gdbVersion,this.historicMoment=e.historicMoment,this.spatialIndex=e.spatialIndex,this.spatialIndex.setEngine(this),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new u(A+++"$$",D)),e.fields.forEach(function(e){t.fieldsMap.set(e.name.trim(),e),t.fieldsMap.set(e.name.trim().toLowerCase(),e)})}return e.prototype.destroy=function(){this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this.fieldsMap.clear()},Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.spatialIndex.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:I(this.spatialReference)}:null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null},e.prototype.executeQuery=function(e){var t=this;void 0===e&&(e=new b);var r=e.clone();return this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).catch(function(e){if(e===T)return new g.default([],t);throw e}).then(function(e){return e.createQueryResponse(r)})},e.prototype.executeQueryForCount=function(e){var t=this;void 0===e&&(e=new b);var r=e.clone();return r.returnGeometry=!1,r.returnCentroid=!1,r.outSpatialReference=null,this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).then(function(e){return e.size}).catch(function(e){if(e===T)return 0;throw e})},e.prototype.executeQueryForExtent=function(e){var t=this;void 0===e&&(e=new b);var r=e.clone(),n=r.outSpatialReference;return this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(){return r.returnGeometry=!0,r.returnCentroid=!1,r.outSpatialReference=null,r}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).then(function(e){var r=e.size;if(!r)return{count:r,extent:null};var i={xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:I(t.spatialReference)};t.spatialIndex.forEachBounds(e.items,function(e){i.xmin=Math.min(e[0],i.xmin),i.ymin=Math.min(e[1],i.ymin),i.xmax=Math.max(e[2],i.xmax),i.ymax=Math.max(e[3],i.ymax)});var o=y.project(i,e.spatialReference,n);if(o.spatialReference=I(n&&n.toJSON()||t.spatialReference),o.xmax-o.xmin==0){var a=p.getMetersPerUnitForSR(o.spatialReference);o.xmin-=a,o.xmax+=a}if(o.ymax-o.ymin==0){a=p.getMetersPerUnitForSR(o.spatialReference);o.ymin-=a,o.ymax+=a}return{count:r,extent:o}}).catch(function(e){if(e===T)return{count:0,extent:null};throw e})},e.prototype.executeQueryForIds=function(e){var t=this;void 0===e&&(e=new b);var r=e.clone();return r.returnGeometry=!1,r.returnCentroid=!1,r.outSpatialReference=null,this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).then(function(e){for(var t=e.items,r=[],n=0;n<t.length;n++)r[n]=t[n].objectId;return r}).catch(function(e){if(e===T)return[];throw e})},e.prototype.executeTileQuery=function(e,t){var r=this,n=t.returnGeometry,o=t.returnCentroid,a=t.pixelBuffer,s=new i.default,u=[],l=a*e.resolution,c=f.pad(e.bounds,l,f.create());if(w(u,s,this,this.spatialIndex,c,n,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),"esriGeometryPoint"===this.geometryType||o){var h=d.getInfo(this.spatialReference);if(h){var p=h.valid,v=p[0],y=p[1];if(c[0]<v){var m=f.fromValues(y-l,c[1],y,c[3]);w(u,s,this,this.spatialIndex,m,n,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[y,e.bounds[3]]})}if(c[2]>y){var g=f.fromValues(v,c[1],v+l,c[3]);w(u,s,this,this.spatialIndex,g,n,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[v-y+e.bounds[0],e.bounds[3]]})}}}return u.sort(function(e,t){return e.attributes[r.objectIdField]-t.attributes[r.objectIdField]}),{features:u,objectIds:s}},e.prototype.executeTileQueryForIds=function(e,t){var r=t.pixelBuffer*e.resolution,n=f.pad(e.bounds,r,f.create()),i=[];return this.spatialIndex.forEachFeatureInBounds(n,function(e){return i.push(e.objectId)}),i},e.prototype.executeQueryForLatestObservations=function(e){var t=this;return this.timeInfo?this.executeQuery(e).then(function(e){return t._filterLatest(e,t.timeInfo)}):void C.error(new a("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._filterLatest=function(e,t){for(var i=t.trackIdField,o=t.startTimeField,a=t.endTimeField||o,s=new n.default,u=[],l=0,c=e.features;l<c.length;l++){var f=c[l],h=f.attributes[i],p=f.attributes[a];(!s.has(h)||s.get(h).attributes[a]<p)&&s.set(h,f)}return s.forEach(function(e){return u.push(e)}),r({},e,{features:u})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.spatialIndex.forEachFeature(function(t){return e.push(t)}),this._allItems=new g.default(e,this)}return this._allItems},e.prototype._normalizeQuery=function(e){var t=this,r=this.definitionExpression,n=e.where,i=e.geometry,o=e.outFields,a=e.orderByFields,s=e.groupByFieldsForStatistics,u=e.outStatistics;if(e.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||r&&r===n)&&(e.where=null),o)for(var c=0;c<o.length;c++)o[c]=o[c].trim();if(a)for(c=0;c<a.length;c++)a[c]=a[c].trim();if(s)for(c=0;c<s.length;c++)s[c]=s[c].trim();if(u)for(c=0;c<u.length;c++)u[c].onStatisticField&&(u[c].onStatisticField=u[c].onStatisticField.trim());return i?(e.outSpatialReference||(e.outSpatialReference=i.spatialReference),this._getInputGeometry(e).then(function(t){return e.geometry=t}).then(function(e){return y.checkProjectionSupport(e.spatialReference,t.spatialReference)}).then(function(){return h.normalizeCentralMeridian(e.geometry)}).then(function(e){return y.project(e[0].toJSON(),e[0].spatialReference,t.spatialReference)}).then(function(r){if(!r)throw T;return r.spatialReference=t.spatialReference,e.read({geometry:r})})):l.resolve(e)},e.prototype._executeGeometryQuery=function(e){var t=this,r=e.geometry,n=e.outSpatialReference,i=e.spatialRelationship,o=d.isValid(n)&&!d.equals(this.spatialReference,n),a=o?JSON.stringify({geometry:r,spatialRelationship:i,outSpatialReference:n}):JSON.stringify({geometry:r,spatialRelationship:i});if(this.cacheSpatialQueries){var s=this._geometryQueryCache.get(a);if(void 0!==s)return l.resolve(s)}var u=null;if(r){var c=this._searchSpatialIndex(this._getQueryBBoxes(r));if(!c.length){var f=new g.default([],this);return this.cacheSpatialQueries&&this._geometryQueryCache.put(a,f,f.size||1),l.resolve(f)}u="envelope-intersects"===e.spatialRelationship||"esriGeometryPoint"===this.geometryType&&x.canQueryWithRBush(r)?l.resolve(new g.default(c,this)):x.getSpatialQueryOperator(i,r,this.geometryType).then(function(e){if(e){var r=c.filter(function(r){return e(_.getGeometry(t,r))});return new g.default(r,t)}})}else u=l.resolve(this._getAll());return u.then(function(r){return o&&(e.returnGeometry||e.returnCentroid)?r.project(n).then(function(e){return t.cacheSpatialQueries&&t._geometryQueryCache.put(a,e,e.size||1),e}):(t.cacheSpatialQueries&&t._geometryQueryCache.put(a,r,r.size||1),r)})},e.prototype._getInputGeometry=function(e){var t=e.geometry,r=e.distance,n=e.units;if(null==r)return l.resolve(t);var i=t.spatialReference,a=n||p.getUnitString(i);return(i&&(i.isGeographic||i.isWebMercator)?l.resolve(t):y.checkProjectionSupport(i,o.SpatialReference.WGS84).then(function(){return c.project(t,o.SpatialReference.WGS84)})).then(function(e){return x.getGeodesicBufferOperator().then(function(t){return t(e,r,a)})})},e.prototype._getQueryBBoxes=function(e){if("point"===e.type)return[f.fromValues(e.x,e.y,e.x,e.y)];var t=x.canQueryWithRBush(e)?e:e.extent;switch(t.type){case"extent":return[f.fromExtent(t)];case"polygon":return t.rings.map(function(e){return f.fromValues(e[0][0],e[0][1],e[2][0],e[2][1])})}},e.prototype._searchSpatialIndex=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];this.spatialIndex.forEachFeatureInBounds(i,function(e){S.has(e)||(t.push(e),S.add(e))})}return S.clear(),t},e.prototype._checkQuerySupport=function(e){return e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParameter||e.text||e.timeExtent?l.reject(new a("feature-store:unsupported-query","Unsupported query options",{query:e})):l.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),x.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),y.checkProjectionSupport(this.spatialReference,e.outSpatialReference)]).then(function(){return e})},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues;if(r&&r.length>0){var i=r.map(function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e});v.validateFields(this.fieldsMap,i,"orderByFields contains missing fields")}if(t&&t.length>0)v.validateFields(this.fieldsMap,t,"outFields contains missing fields");else if(n)throw new a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});v.validateWhere(this.fieldsMap,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){var t=e.outStatistics,r=e.groupByFieldsForStatistics,n=e.having,i=r&&r.length,o=t&&t.length;if(n){if(!i||!o)return l.reject(new a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e}));v.validateHaving(this.fieldsMap,n,t)}if(o){if(t.some(function(e){return"exceedslimit"===e.statisticType}))return;var s=t.map(function(e){return e.onStatisticField});v.validateFields(this.fieldsMap,s,"onStatisticFields contains missing fields"),i&&v.validateFields(this.fieldsMap,r,"groupByFieldsForStatistics contains missing fields");for(var u=0,c=t;u<c.length;u++){var f=c[u],h=f.onStatisticField,p=f.statisticType;if("exceedslimit"===p)return l.reject(new a("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:f,query:e}));if((!i||"count"!==p)&&h&&v.hasInvalidFieldType(h,this.fieldsMap))return l.reject(new a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:e}))}}},e}();t.default=M}.apply(null,n))||(e.exports=i)},1725:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=t,this._filter=e.getFeatureFilter()}return e.prototype.pushFeature=function(e){this._filter.filter(e)&&this._features.push(e)},e.prototype.hasFeatures=function(){return this._features.length>0},e.prototype.processFeatures=function(e,t){},e.prototype.assignBufferInfo=function(e){},e}()}.apply(null,n))||(e.exports=i)},1726:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1813),r(1814),r(1815)],void 0===(i=function(e,t,r,n,i,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,r){switch(this.type=e,this.typeName=t.type,this.id=t.id,this.source=t.source,this.sourceLayer=t["source-layer"],this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.filter=t.filter,this.layout=t.layout,this.paint=t.paint,this.z=r,e){case 0:this._layoutDefinition=o.StyleDefinition.backgroundLayoutDefinition,this._paintDefinition=o.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=o.StyleDefinition.fillLayoutDefinition,this._paintDefinition=o.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=o.StyleDefinition.lineLayoutDefinition,this._paintDefinition=o.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=o.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=o.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=o.StyleDefinition.circleLayoutDefinition,this._paintDefinition=o.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}return e.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=i.createFilter(this.filter)},e.prototype.getLayoutProperty=function(e){var t=this._layoutProperties;if(t)return t[e]},e.prototype.getPaintProperty=function(e){var t=this._paintProperties;if(t)return t[e]},e.prototype.getLayoutValue=function(e,t,r){var n,i=this._layoutProperties;if(i){var o=i[e];o&&(n=o.getValue(t,r))}var a=this._layoutDefinition[e];return void 0===n&&(n=a.default),"enum"===a.type&&(n=a.values.indexOf(n)),n},e.prototype.getPaintValue=function(e,t,r){var n,i=this._paintProperties;if(i){var o=i[e];o&&(n=o.getValue(t,r))}var a=this._paintDefinition[e];return void 0===n&&(n=a.default),"enum"===a.type&&(n=a.values.indexOf(n)),n},e.prototype._parseLayout=function(e){var t={};for(var r in e){var n=this._layoutDefinition[r];n&&(t[r]=new a(r,n,e[r]))}return t},e.prototype._parsePaint=function(e){var t={};for(var r in e){var n=this._paintDefinition[r];n&&(t[r]=new a(r,n,e[r]))}return t},e}();t.StyleLayer=s;var u=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return r(t,e),t}(s);t.BackgroundStyleLayer=u;var l=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.getPaintProperty("fill-color");i.hasDataDrivenColor=!!o&&o.isDataDriven;var a=i.getPaintProperty("fill-opacity");i.hasDataDrivenOpacity=!!a&&a.isDataDriven,i.hasDataDrivenFill=i.hasDataDrivenColor||i.hasDataDrivenOpacity;var s=i.getPaintProperty("fill-outline-color");return i.outlineUsesFillColor=!s,i.hasDataDrivenOutlineColor=!!s&&s.isDataDriven,i.hasDataDrivenOutline=(s?i.hasDataDrivenOutlineColor:i.hasDataDrivenColor)||i.hasDataDrivenOpacity,i}return r(t,e),t}(s);t.FillStyleLayer=l;var c=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.getPaintProperty("line-color");i.hasDataDrivenColor=!!o&&o.isDataDriven;var a=i.getPaintProperty("line-opacity");i.hasDataDrivenOpacity=!!a&&a.isDataDriven;var s=i.getPaintProperty("line-width");return i.hasDataDrivenWidth=!!s&&s.isDataDriven,i.hasDataDrivenLine=i.hasDataDrivenColor||i.hasDataDrivenOpacity||i.hasDataDrivenWidth,i}return r(t,e),t}(s);t.LineStyleLayer=c;var f=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.getPaintProperty("icon-color");i.hasDataDrivenIconColor=!!o&&o.isDataDriven;var a=i.getPaintProperty("icon-opacity");i.hasDataDrivenIconOpacity=!!a&&a.isDataDriven;var s=i.getLayoutProperty("icon-size");i.hasDataDrivenIconSize=!!s&&s.isDataDriven,i.hasDataDrivenIcon=i.hasDataDrivenIconColor||i.hasDataDrivenIconOpacity||i.hasDataDrivenIconSize;var u=i.getPaintProperty("text-color");i.hasDataDrivenTextColor=!!u&&u.isDataDriven;var l=i.getPaintProperty("text-opacity");i.hasDataDrivenTextOpacity=!!l&&l.isDataDriven;var c=i.getLayoutProperty("text-size");return i.hasDataDrivenTextSize=!!c&&c.isDataDriven,i.hasDataDrivenText=i.hasDataDrivenTextColor||i.hasDataDrivenTextOpacity||i.hasDataDrivenTextSize,i}return r(t,e),t}(s);t.SymbolStyleLayer=f;var h=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this,o=i.getPaintProperty("circle-radius");i.hasDataDrivenRadius=!!o&&o.isDataDriven;var a=i.getPaintProperty("circle-color");i.hasDataDrivenColor=!!a&&a.isDataDriven;var s=i.getPaintProperty("circle-opacity");i.hasDataDrivenOpacity=!!s&&s.isDataDriven;var u=i.getPaintProperty("circle-stroke-width");i.hasDataDrivenStrokeWidth=!!u&&u.isDataDriven;var l=i.getPaintProperty("circle-stroke-color");i.hasDataDrivenStrokeColor=!!l&&l.isDataDriven;var c=i.getPaintProperty("circle-stroke-opacity");i.hasDataDrivenStrokeOpacity=!!c&&c.isDataDriven;var f=i.getPaintProperty("circle-blur");return i.hasDataDrivenBlur=!!f&&f.isDataDriven,i}return r(t,e),t}(s);t.CircleStyleLayer=h;var p=function(){return function(e,t,r){this.cap=e.getLayoutValue("line-cap",t,r),this.join=e.getLayoutValue("line-join",t,r),this.miterLimit=e.getLayoutValue("line-miter-limit",t,r),this.roundLimit=e.getLayoutValue("line-round-limit",t,r)}}();t.LineLayout=p;var d=function(){return function(e,t,r,n){this.allowOverlap=e.getLayoutValue("icon-allow-overlap",t,n),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",t,n),this.optional=e.getLayoutValue("icon-optional",t,n),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",t,n),this.size=e.getLayoutValue("icon-size",t,n),this.rotate=e.getLayoutValue("icon-rotate",t,n),this.padding=e.getLayoutValue("icon-padding",t,n),this.keepUpright=e.getLayoutValue("icon-keep-upright",t,n),this.offset=e.getLayoutValue("icon-offset",t,n),2===this.rotationAlignment&&(this.rotationAlignment=r?0:1)}}();t.IconLayout=d;var v=function(){return function(e,t,r,n){this.allowOverlap=e.getLayoutValue("text-allow-overlap",t,n),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",t,n),this.optional=e.getLayoutValue("text-optional",t,n),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",t,n),this.fontArray=e.getLayoutValue("text-font",t,n),this.maxWidth=e.getLayoutValue("text-max-width",t,n),this.lineHeight=e.getLayoutValue("text-line-height",t,n),this.letterSpacing=e.getLayoutValue("text-letter-spacing",t,n),this.justify=e.getLayoutValue("text-justify",t,n),this.anchor=e.getLayoutValue("text-anchor",t,n),this.maxAngle=e.getLayoutValue("text-max-angle",t,n),this.size=e.getLayoutValue("text-size",t,n),this.rotate=e.getLayoutValue("text-rotate",t,n),this.padding=e.getLayoutValue("text-padding",t,n),this.keepUpright=e.getLayoutValue("text-keep-upright",t,n),this.transform=e.getLayoutValue("text-transform",t,n),this.offset=e.getLayoutValue("text-offset",t,n),2===this.rotationAlignment&&(this.rotationAlignment=r?0:1)}}();t.TextLayout=v}.apply(null,n))||(e.exports=i)},1727:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(4),r(0),r(1634),r(170),r(1820)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-class-breaks",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.colorClassBreakInfos=null,r}var c;return n(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:o.clone(this.colorClassBreakInfos),legendOptions:o.clone(this.legendOptions)}))},i([a.enumeration.serializable()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks"})],t.prototype,"type",void 0),i([a.property({json:{write:!0},type:String})],t.prototype,"field",void 0),i([a.property({type:u.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),i([a.property({type:s.fieldTransformTypeKebabDict.apiValues,json:{type:s.fieldTransformTypeKebabDict.jsonValues,read:s.fieldTransformTypeKebabDict.read,write:s.fieldTransformTypeKebabDict.write}})],t.prototype,"fieldTransformType",void 0),i([a.property({type:[l.default],json:{write:!0}})],t.prototype,"colorClassBreakInfos",void 0),c=i([a.subclass("esri.renderers.PointCloudClassBreaksRenderer")],t)}(a.declared(s))}.apply(null,n))||(e.exports=i)},1728:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(0),r(1673)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="fixed-size",t.size=0,t.useRealWorldSymbolSizes=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})},n([i.enumeration.serializable()({pointCloudFixedSizeAlgorithm:"fixed-size"})],t.prototype,"type",void 0),n([i.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"size",void 0),n([i.property({type:Boolean,json:{write:!0}})],t.prototype,"useRealWorldSymbolSizes",void 0),o=n([i.subclass("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],t)}(i.declared(o.default));t.PointSizeFixedSizeAlgorithm=a,t.default=a}.apply(null,n))||(e.exports=i)},1729:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(0),r(1673)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="splat",t.scaleFactor=1,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({scaleFactor:this.scaleFactor})},n([i.enumeration.serializable()({pointCloudSplatAlgorithm:"splat"})],t.prototype,"type",void 0),n([i.property({type:Number,value:1,nonNullable:!0,json:{write:!0}})],t.prototype,"scaleFactor",void 0),o=n([i.subclass("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],t)}(i.declared(o.default));t.PointSizeSplatAlgorithm=a,t.default=a}.apply(null,n))||(e.exports=i)},1730:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(4),r(0),r(1634),r(170),r(1821)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-stretch",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.stops=null,r}var c;return n(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),stops:o.clone(this.stops),legendOptions:o.clone(this.legendOptions)}))},i([a.enumeration.serializable()({pointCloudStretchRenderer:"point-cloud-stretch"})],t.prototype,"type",void 0),i([a.property({json:{write:!0},type:String})],t.prototype,"field",void 0),i([a.property({type:u.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),i([a.property({type:s.fieldTransformTypeKebabDict.apiValues,json:{type:s.fieldTransformTypeKebabDict.jsonValues,read:s.fieldTransformTypeKebabDict.read,write:s.fieldTransformTypeKebabDict.write}})],t.prototype,"fieldTransformType",void 0),i([a.property({type:[l.default],json:{write:!0}})],t.prototype,"stops",void 0),c=i([a.subclass("esri.renderers.PointCloudStretchRenderer")],t)}(a.declared(s))}.apply(null,n))||(e.exports=i)},1731:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(1),r(4),r(0),r(1634),r(170),r(1822)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-unique-value",r.field=null,r.fieldTransformType=null,r.colorUniqueValueInfos=null,r.legendOptions=null,r}var c;return n(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),colorUniqueValueInfos:o.clone(this.colorUniqueValueInfos),legendOptions:o.clone(this.legendOptions)}))},i([a.enumeration.serializable()({pointCloudUniqueValueRenderer:"point-cloud-unique-value"})],t.prototype,"type",void 0),i([a.property({json:{write:!0},type:String})],t.prototype,"field",void 0),i([a.property({type:s.fieldTransformTypeKebabDict.apiValues,json:{type:s.fieldTransformTypeKebabDict.jsonValues,read:s.fieldTransformTypeKebabDict.read,write:s.fieldTransformTypeKebabDict.write}})],t.prototype,"fieldTransformType",void 0),i([a.property({type:[l.default],json:{write:!0}})],t.prototype,"colorUniqueValueInfos",void 0),i([a.property({type:u.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),c=i([a.subclass("esri.renderers.PointCloudUniqueValueRenderer")],t)}(a.declared(s))}.apply(null,n))||(e.exports=i)},1732:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(488),r(253)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=new n.default,o=new n.default,a={esriGeometryPoint:r.convertToPoint,esriGeometryPolyline:r.convertToPolyline,esriGeometryPolygon:r.convertToPolygon,esriGeometryMultipoint:r.convertToMultipoint};t.getCentroid=function(e,t,i){if("esriGeometryPolygon"!==e.geometryType)return null;if(!t.centroid&&!t.geometry)return null;if(t.centroid||(t.centroid=r.getCentroidOptimizedGeometry(new n.default,t.geometry,e.hasZ,e.hasM)),i){var a=r.quantizeOptimizedGeometry(o,t.centroid,e.hasZ,e.hasM,"esriGeometryPoint",i);return r.convertToPoint(a,e.hasZ,e.hasM)}return r.convertToPoint(t.centroid,e.hasZ,e.hasM)},t.getGeometry=function(e,t,n,s){if(!t.geometry)return null;if(n){var u=r.generalizeOptimizedGeometry(i,t.geometry,e.hasZ,e.hasM,e.geometryType,n);return s?(u=r.quantizeOptimizedGeometry(o,u,e.hasZ,e.hasM,e.geometryType,s),a[e.geometryType](u,e.hasZ,e.hasM)):a[e.geometryType](u,e.hasZ,e.hasM)}if(s)return u=r.quantizeOptimizedGeometry(o,t.geometry,e.hasZ,e.hasM,e.geometryType,s),a[e.geometryType](u,e.hasZ,e.hasM);return a[e.geometryType](t.geometry,e.hasZ,e.hasM)}}.apply(null,n))||(e.exports=i)},1776:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(9),r(8)],void 0===(i=function(e,t,n,i,o){Object.defineProperty(t,"__esModule",{value:!0}),t.getControllerConfiguration=function(e){var t=e.source;return"stream"===e.type?o.resolve().then(function(){return{type:"stream",filter:function(e){if(!e)return null;var t={};return e.geometry&&(t.geometry=e.geometry.toJSON()),e.where&&(t.where=e.where),t}(e.filter),purgeOptions:e.purgeOptions}}):e.capabilities.operations.supportsQuery?function(e){return e&&"openPorts"in e}(t)?o.resolve().then(function(){return{type:"memory",processing:e.processing&&e.processing.toWorker()||null}}):o.resolve({type:"on-demand",gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),processing:e.processing&&e.processing.toWorker()||null}):o.reject(new i("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:e}))},t.createController=function(e,t){return("memory"===e?o.create(function(e){return Promise.all([r.e(37),r.e(61)]).then(function(){var t=[r(1933)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"stream"===e?o.create(function(e){return Promise.all([r.e(4),r.e(11),r.e(14),r.e(62)]).then(function(){var t=[r(1935)];e.apply(null,t)}.bind(this)).catch(r.oe)}):o.create(function(e){return Promise.all([r.e(4),r.e(11),r.e(14),r.e(37),r.e(63)]).then(function(){var t=[r(1936)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,i=t.remoteClient,o=t.tileStore;return new e(n({},r,{tileStore:o,remoteClient:i}))})}}.apply(null,n))||(e.exports=i)},1777:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1727),r(1730),r(1731),r(1435)],void 0===(i=function(e,t,r,n,i,o){function a(e){for(var t=0,r=0,n=e||[];r<n.length;r++)t|=1<<n[r];return t}function s(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.name===t&&null!=i.attributeValues&&"UInt8"===i.attributeValues.valueType&&3===i.attributeValues.valuesPerElement)return{storageInfo:i,useElevation:!1}}return null}function u(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.name===t){var o="embedded-elevation"===i.encoding;return{storageInfo:o?null:i,useElevation:o}}}return"elevation"===t.toLowerCase()?{storageInfo:null,useElevation:!0}:null}function l(e,t,r,n){if(e&&e.useElevation){for(var i=new Float64Array(n),a=0;a<n;a++)i[a]=r[3*a+2];return i}return e&&t?o.readBinaryAttribute(e.storageInfo,t,n):null}function c(e){return null==e||"none"===e?null:"low-four-bit"===e?function(e){return 15&e}:"high-four-bit"===e?function(e){return(240&e)>>4}:"absolute-value"===e?function(e){return Math.abs(e)}:"modulo-ten"===e?function(e){return e%10}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRendererInfo=function(e){var t=e.renderer,r=t&&t.type,n=t&&e.renderer.toJSON()||null,i=null,o=!1;"point-cloud-unique-value"===r?i=u(e.attributeStorageInfo,t.field):"point-cloud-stretch"===r?i=u(e.attributeStorageInfo,t.field):"point-cloud-class-breaks"===r?i=u(e.attributeStorageInfo,t.field):o="point-cloud-rgb"===r?null!=(i=s(e.attributeStorageInfo,t.field)):null!=(i=s(e.attributeStorageInfo,"RGB"));var a=null;return t&&t.colorModulation&&(a=u(e.attributeStorageInfo,t.colorModulation.field)),{rendererJSON:n,isRGBRenderer:o,primaryAttribute:i,modulationAttribute:a}},t.getFilterInfo=function(e){var t=e.filters;return t?t.map(function(t){return{filterJSON:t.toJSON(),attributeInfo:u(e.attributeStorageInfo,t.field)}}):[]},t.evaluateRenderer=function(e,t,o,a,s){var u=e.rendererJSON,f=e.isRGBRenderer,h=e.primaryAttribute,p=e.modulationAttribute,d=l(h,t,a,s),v=l(p,o,a,s),y=null,m=null;if(d&&f)y=d;else if(d&&"pointCloudUniqueValueRenderer"===u.type){var g=(m=i.fromJSON(u)).colorUniqueValueInfos;y=new Uint8Array(3*s);for(var x=c(m.fieldTransformType),_=0;_<s;_++)for(var b=(C=x?x(d[_]):d[_])+"",I=0;I<g.length;I++)if(g[I].values.indexOf(b)>=0){y[3*_]=g[I].color.r,y[3*_+1]=g[I].color.g,y[3*_+2]=g[I].color.b;break}}else if(d&&"pointCloudStretchRenderer"===u.type){var w=(m=n.fromJSON(u)).stops;for(y=new Uint8Array(3*s),x=c(m.fieldTransformType),_=0;_<s;_++){var C=x?x(d[_]):d[_],P=w.length-1;if(C<w[0].value)y[3*_]=w[0].color.r,y[3*_+1]=w[0].color.g,y[3*_+2]=w[0].color.b;else if(C>=w[P].value)y[3*_]=w[P].color.r,y[3*_+1]=w[P].color.g,y[3*_+2]=w[P].color.b;else for(I=1;I<w.length;I++)if(C<w[I].value){var T=(C-w[I-1].value)/(w[I].value-w[I-1].value);y[3*_]=w[I].color.r*T+w[I-1].color.r*(1-T),y[3*_+1]=w[I].color.g*T+w[I-1].color.g*(1-T),y[3*_+2]=w[I].color.b*T+w[I-1].color.b*(1-T);break}}}else if(d&&"pointCloudClassBreaksRenderer"===u.type){var S=(m=r.fromJSON(u)).colorClassBreakInfos;for(y=new Uint8Array(3*s),x=c(m.fieldTransformType),_=0;_<s;_++)for(C=x?x(d[_]):d[_],I=0;I<S.length;I++)if(C>=S[I].minValue&&C<=S[I].maxValue){y[3*_]=S[I].color.r,y[3*_+1]=S[I].color.g,y[3*_+2]=S[I].color.b;break}}else for(y=new Uint8Array(3*s),_=0;_<y.length;_++)y[_]=255;if(v&&m&&m.colorModulation){var D=m.colorModulation.minValue,A=m.colorModulation.maxValue;for(_=0;_<s;_++){var M=(C=v[_])>=A?1:C<=D?.3:.3+.7*(C-D)/(A-D);y[3*_]=M*y[3*_],y[3*_+1]=M*y[3*_+1],y[3*_+2]=M*y[3*_+2]}}return y},t.filterInPlace=function(e,t,r,n){for(var i=e.length/3,o=n.map(function(t,n){return l(r[n].attributeInfo,t,e,i)}),s=0,u=0;u<i;u++){for(var c=!0,f=0;f<r.length&&c;f++){var h=r[f].filterJSON,p=o[f][u];switch(h.type){case"pointCloudValueFilter":var d="exclude"===h.mode;-1!==h.values.indexOf(p)===d&&(c=!1);break;case"pointCloudBitfieldFilter":var v=a(h.requiredSetBits),y=a(h.requiredClearBits);(p&v)===v&&0==(p&y)||(c=!1);break;case"pointCloudReturnFilter":for(var m=15&p,g=p>>>4&15,x=g>1,_=1===m,b=m===g,I=!1,w=0,C=h.includedReturns;w<C.length;w++){var P=C[w];if("last"===P&&b||"firstOfMany"===P&&_&&x||"lastOfMany"===P&&b&&x||"single"===P&&!x){I=!0;break}}I||(c=!1)}}c&&(e[3*s]=e[3*u],e[3*s+1]=e[3*u+1],e[3*s+2]=e[3*u+2],t[3*s]=t[3*u],t[3*s+1]=t[3*u+1],t[3*s+2]=t[3*u+2],s++)}return s},t.getSplatSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"splat"===t.type?t:null},t.getFixedSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"fixed-size"===t.type?t:null},t.rendererUsesFixedSizes=function(e){var t=e&&e.pointSizeAlgorithm;return!(!t||!t.type)&&"fixed-size"===t.type}}.apply(null,n))||(e.exports=i)},1812:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,n))||(e.exports=i)},1813:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(t,r,n){this._op=t,"$type"===r?(n instanceof Array?this._val=n.map(function(t){return e._types.indexOf(t)}):this._val=e._types.indexOf(n),this._op+=11):(this._key=r,this._val=n)}return e.prototype.filter=function(e){switch(this._op){case 0:return this._val;case 1:return e.values[this._key]===this._val;case 2:return e.values[this._key]!==this._val;case 3:return e.values[this._key]<this._val;case 4:return e.values[this._key]>this._val;case 5:return e.values[this._key]<=this._val;case 6:return e.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(e.values[this._key]);case 8:return-1===this._val.indexOf(e.values[this._key]);case 9:for(var t=0,r=this._val;t<r.length;t++){if(r[t].filter(e))return!0}return!1;case 10:for(var n=0,i=this._val;n<i.length;n++){if(!i[n].filter(e))return!1}return!0;case 11:for(var o=0,a=this._val;o<a.length;o++){if(a[o].filter(e))return!1}return!0;case 12:return e.type===this._val;case 13:return e.type!==this._val;case 14:return e.type<this._val;case 15:return e.type>this._val;case 16:return e.type>=this._val;case 17:return e.type<=this._val;case 18:return-1!==this._val.indexOf(e.type);case 19:return-1===this._val.indexOf(e.type);case 20:return void 0!==e.values[this._key];case 21:return void 0===e.values[this._key]}},e.createFilter=function(t){if(!t)return new e(0,void 0,!0);var r=t[0];if(t.length<=1)return new e(0,void 0,"any"!==r);switch(r){case"==":return new e(1,t[1],t[2]);case"!=":return new e(2,t[1],t[2]);case">":return new e(4,t[1],t[2]);case"<":return new e(3,t[1],t[2]);case">=":return new e(6,t[1],t[2]);case"<=":return new e(5,t[1],t[2]);case"in":return new e(7,t[1],t.slice(2));case"!in":return new e(8,t[1],t.slice(2));case"any":return new e(9,void 0,t.slice(1).map(e.createFilter.bind(this)));case"all":return new e(10,void 0,t.slice(1).map(e.createFilter.bind(this)));case"none":return new e(11,void 0,t.slice(1).map(e.createFilter.bind(this)));case"has":return new e(20,t[1],void 0);case"!has":return new e(21,t[1],void 0);default:throw new Error("invalid operator: "+r)}},e._types=["Unknown","Point","LineString","Polygon"],e}()}.apply(null,n))||(e.exports=i)},1814:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},e.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",minimum:0,default:2},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",default:0},"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}},e.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}},e.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"fill-pattern":{type:"string"}},e.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",default:[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}},e.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}},e.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},e.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}},e}();t.StyleDefinition=r}.apply(null,n))||(e.exports=i)},1815:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(23),r(1402)],void 0===(i=function(e,t,r,n){return function(){function e(t,r,n){var i;switch(this.isDataDriven=!1,r.type){case"number":i=!0;break;case"color":i=!0,n=e._parseColor(n);break;case"array":i="number"===r.value;break;default:i=!1}null==n&&(n=r.default),i&&"interval"===n.type&&(i=!1);var o=n&&n.stops&&n.stops.length>0;if(o)for(var a=0,s=n.stops;a<s.length;a++){var u=s[a];u[1]=this._validate(u[1],r)}if(this.isDataDriven=!!n&&!!n.property,this.isDataDriven)if(void 0!==n.default&&(n.default=this._validate(n.default,r)),o)switch(n.type){case"identity":this.getValue=this._buildIdentity(n,r);break;case"categorical":this.getValue=this._buildCategorical(n,r);break;default:this.getValue=i?this._buildInterpolate(n,r):this._buildInterval(n,r)}else this.getValue=this._buildIdentity(n,r);else o?this.getValue=i?this._buildZoomInterpolate(n):this._buildZoomInterval(n):(n=this._validate(n,r),this.getValue=this._buildSimple(n))}return e.prototype._validate=function(e,t){if("number"===t.type){if(e<t.minimum)return t.minimum;if(e>t.maximum)return t.maximum}return e},e.prototype._buildSimple=function(e){return function(){return e}},e.prototype._buildIdentity=function(t,r){var n=this;return function(i,o){var a;return o&&(a=o.values[t.property],"color"===r.type&&(a=e._parseColor(a))),void 0===a&&(a=t.default),void 0!==a?n._validate(a,r):r.default}},e.prototype._buildCategorical=function(e,t){var r=this;return function(n,i){var o;return i&&(o=i.values[e.property]),void 0!==(o=r._categorical(o,e.stops))?o:void 0!==e.default?e.default:t.default}},e.prototype._buildInterval=function(e,t){var r=this;return function(n,i){var o;return i&&(o=i.values[e.property]),"number"==typeof o?r._interval(o,e.stops):void 0!==e.default?e.default:t.default}},e.prototype._buildInterpolate=function(e,t){var r=this;return function(n,i){var o;return i&&(o=i.values[e.property]),"number"==typeof o?r._interpolate(o,e.stops,e.base||1):void 0!==e.default?e.default:t.default}},e.prototype._buildZoomInterpolate=function(e){var t=this;return function(r){return t._interpolate(r,e.stops,e.base||1)}},e.prototype._buildZoomInterval=function(e){var t=this;return function(r){return t._interval(r,e.stops)}},e.prototype._categorical=function(e,t){for(var r=t.length,n=0;n<r;n++)if(t[n][0]===e)return t[n][1]},e.prototype._interval=function(e,t){for(var r=t.length,n=0,i=0;i<r&&t[i][0]<=e;i++)n=i;return t[n][1]},e.prototype._interpolate=function(e,t,r){for(var i,o,a=t.length,s=0;s<a;s++){var u=t[s];if(!(u[0]<=e)){o=u;break}i=u}if(i&&o){var l=o[0]-i[0],c=e-i[0],f=1===r?c/l:(Math.pow(r,c)-1)/(Math.pow(r,l)-1);if(Array.isArray(i[1])){var h=i[1],p=o[1],d=[];for(s=0;s<h.length;s++)d.push(n.interpolate(h[s],p[s],f));return d}return n.interpolate(i[1],o[1],f)}return i?i[1]:o?o[1]:void 0},e._isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},e._parseColor=function(t){if(Array.isArray(t))return t;if("string"!=typeof t)return t&&t.default&&(t.default=e._parseColor(t.default)),t&&t.stops&&(t.stops=t.stops.map(function(t){return[t[0],e._parseColor(t[1])]})),t;var n=new r(t);return this._isEmpty(n)?void 0:r.toUnitRGBA(n)},e}()}.apply(null,n))||(e.exports=i)},1816:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(16),r(1726)],void 0===(i=function(e,t,r,n){return function(){function e(t,n){if(this._layerByName={},this.styleJSON=t,this.version=parseFloat(t.version),this.sprite=n?n.spriteUrl:t.sprite,this.glyphs=n?n.glyphsUrl:t.glyphs,r("stable-symbol-rendering")){var i=(t.layers||[]).filter(function(e){return e.layout&&e.layout["text-font"]})[0];i&&(t.layers||[]).forEach(function(e){e.layout&&e.layout["text-font"]&&(e.layout["text-font"]=i.layout["text-font"])})}if(this.layers=(t.layers||[]).map(e._create),this.layers)for(var o=void 0,a=0;a<this.layers.length;a++)o=this.layers[a],this._layerByName[o.id.toLowerCase()]=o;this._identifyRefLayers()}return e.prototype.getStyleLayerId=function(e){return e>=this.layers.length?null:this.layers[e].id},e.prototype.getLayoutProperties=function(e){var t=this._layerByName[e.toLowerCase()];return t?t.layout:null},e.prototype.getPaintProperties=function(e){var t=this._layerByName[e.toLowerCase()];return t?t.paint:null},e.prototype.setPaintProperties=function(t,r){var n=this._layerByName[t.toLowerCase()];if(!n)return"";var i=this.layers.indexOf(n);this.styleJSON.layers[i].paint=r;var o={id:n.id,type:n.typeName,source:n.source,sourceLayer:n["source-layer"],minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:n.layout,paint:r},a=e._recreateLayer(o,n);return this.layers[i]=a,this._layerByName[n.id.toLowerCase()]=a,n.id},e.prototype.setLayoutProperties=function(t,r){var n=this._layerByName[t.toLowerCase()];if(!n)return"";var i=this.layers.indexOf(n);this.styleJSON.layers[i].layout=r;var o={id:n.id,type:n.typeName,source:n.source,sourceLayer:n["source-layer"],minzoom:n.minzoom,maxzoom:n.maxzoom,filter:n.filter,layout:r,paint:n.paint},a=e._recreateLayer(o,n);return this.layers[i]=a,this._layerByName[n.id.toLowerCase()]=a,n.id},e.prototype._identifyRefLayers=function(){for(var e=[],t=[],r=0,n=0,i=this.layers;n<i.length;n++){var o=i[n];if(1===o.type){var a=o,s=o.sourceLayer;s+="|"+JSON.stringify(o.minzoom),s+="|"+JSON.stringify(o.maxzoom),s+="|"+JSON.stringify(o.filter),(a.hasDataDrivenFill||a.hasDataDrivenOutline)&&(s+="|"+JSON.stringify(r)),e.push({key:s,layer:o})}if(2===o.type){var u=o;s=o.sourceLayer;s+="|"+JSON.stringify(o.minzoom),s+="|"+JSON.stringify(o.maxzoom),s+="|"+JSON.stringify(o.filter),s+="|"+JSON.stringify(o.layout&&o.layout["line-cap"]),s+="|"+JSON.stringify(o.layout&&o.layout["line-join"]),u.hasDataDrivenLine&&(s+="|"+JSON.stringify(r)),t.push({key:s,layer:o})}++r}this._assignRefLayers(e),this._assignRefLayers(t)},e.prototype._assignRefLayers=function(e){e.sort(function(e,t){return e.key<t.key?-1:e.key>t.key?1:0});for(var t,r,n=e.length,i=0;i<n;i++){var o=e[i];if(o.key===t)o.layer.refLayerId=r;else if(t=o.key,r=o.layer.id,1===o.layer.type&&!o.layer.getPaintProperty("fill-outline-color"))for(var a=i+1;a<n;a++){var s=e[a];if(s.key!==t)break;if(s.layer.getPaintProperty("fill-outline-color")){e[i]=s,e[a]=o,r=s.layer.id;break}}}},e._create=function(e,t,r){var i=1-(1+t)*(1/(r.length+1));switch(e.type){case"background":return new n.BackgroundStyleLayer(0,e,i);case"fill":return new n.FillStyleLayer(1,e,i);case"line":return new n.LineStyleLayer(2,e,i);case"symbol":return new n.SymbolStyleLayer(3,e,i);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new n.CircleStyleLayer(4,e,i)}throw new Error("Unknown vector tile layer")},e._recreateLayer=function(e,t){switch(e.type){case"background":return new n.BackgroundStyleLayer(0,e,t.z);case"fill":return new n.FillStyleLayer(1,e,t.z);case"line":return new n.LineStyleLayer(2,e,t.z);case"symbol":return new n.SymbolStyleLayer(3,e,t.z);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new n.CircleStyleLayer(4,e,t.z)}},e}()}.apply(null,n))||(e.exports=i)},1817:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(0)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.field=null,t.minValue=0,t.maxValue=255,t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({field:this.field,minValue:this.minValue,maxValue:this.maxValue})},n([o.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),n([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minValue",void 0),n([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxValue",void 0),i=n([o.subclass("esri.renderers.support.pointCloud.ColorModulation")],t)}(o.declared(i));t.ColorModulation=a,t.default=a}.apply(null,n))||(e.exports=i)},1818:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(76),r(1728),r(1729)],void 0===(i=function(e,t,r,n,i){function o(e){return e&&a[e.type]||null}Object.defineProperty(t,"__esModule",{value:!0});var a={pointCloudFixedSizeAlgorithm:n.default,pointCloudSplatAlgorithm:i.default};t.read=function(e,t,n){var i=o(e);if(i){var a=new i;return a.read(e,n),a}return n&&n.messages&&e&&n.messages.push(new r("pointsizealgorithm:unsupported","Point size algorithms of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:n})),null},t.fromJSON=function(e){var t=o(e);return t?t.fromJSON(e):null}}.apply(null,n))||(e.exports=i)},1819:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1673),r(1728),r(1729)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.pointSizeAlgorithmTypes={key:"type",base:r.default,typeMap:{"fixed-size":n.default,splat:i.default}}}.apply(null,n))||(e.exports=i)},1820:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(23),r(6),r(4),r(0),r(24)],void 0===(i=function(e,t,r,n,i,o,a,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.minValue=0,t.maxValue=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:a.clone(this.color)})},n([s.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([s.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([s.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],t.prototype,"minValue",void 0),n([s.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],t.prototype,"maxValue",void 0),n([s.property({type:i,json:{type:[u.Integer],write:!0}})],t.prototype,"color",void 0),o=n([s.subclass("esri.renderers.support.pointCloud.ColorClassBreakInfo")],t)}(s.declared(o));t.ColorClassBreakInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},1821:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(23),r(6),r(4),r(0),r(24)],void 0===(i=function(e,t,r,n,i,o,a,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.value=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({label:this.label,value:this.value,color:a.clone(this.color)})},n([s.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([s.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"value",void 0),n([s.property({type:i,json:{type:[u.Integer],write:!0}})],t.prototype,"color",void 0),o=n([s.subclass("esri.renderers.support.pointCloud.StopInfo")],t)}(s.declared(o));t.StopInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},1822:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(23),r(6),r(4),r(0),r(24)],void 0===(i=function(e,t,r,n,i,o,a,s,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.values=null,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,values:a.clone(this.values),color:a.clone(this.color)})},n([s.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([s.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([s.property({type:[String],json:{write:!0}})],t.prototype,"values",void 0),n([s.property({type:i,json:{type:[u.Integer],write:!0}})],t.prototype,"color",void 0),o=n([s.subclass("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],t)}(s.declared(o));t.ColorUniqueValueInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},1826:function(e,t,r){var n,i;n=[r(12),r(235)],void 0===(i=function(e,t){var r=/^\s*"([\S\s]*)"\s*$/,n=/""/g,i=/"/g;function o(e,t){var r,n={},i=e.length;for(r=0;r<i;r++)n[e[r]]=t[r];return n}return t(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(t){var i,a,s,u,l,c,f,h,p=[],d=t.split(this.newline),v=this.fieldNames,y=0,m=[],g="",x="";e:for(c=0,s=d.length;c<s;c++)if(e.trim(d[c])){for(f=0,u=(i=d[c].split(this.delimiter)).length;f<u;f++){for(h=-1,g+=x+(a=i[f]),x="";(h=a.indexOf('"',h+1))>=0;)y++;if(y%2==0){if(y>0){if(!(l=r.exec(g))){console.warn("Csv: discarding row with invalid value: "+g),m=[],g="",y=0;continue e}m.push(l[1].replace(n,'"'))}else m.push(this.trim||!v?e.trim(g):g);g="",y=0}else x=this.delimiter}0===y?(v?p.push(o(v,m)):v=this.fieldNames=m,m=[]):x=this.newline}return p},toCsv:function(e){return this.stringify(this.data,e)},stringify:function(e,t){var r,n,o,a,s=(t=t||{}).alwaysQuote,u=this.fieldNames,l=this.delimiter,c=this.newline,f="";for(r=-1;r<e.length;r++)for(r>-1&&(f+=c),n=0;n<u.length;n++)null!==(o=r<0?u[n]:e[r][u[n]])&&void 0!==o||(o=""),"string"!=typeof o&&(o=o.toString()),a=s||o.indexOf('"')>=0||o.indexOf(l)>=0,f+=(n>0?l:"")+(a?'"'+o.replace(i,'""')+'"':o);return t.trailingNewline&&(f+=c),f}})}.apply(null,n))||(e.exports=i)},1827:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(476),r(8),r(1417),r(59),r(488),r(1828),r(1677),r(1552),r(1732)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c){Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){this.items=e,this.definitionExpression=t.definitionExpression,this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.fieldsMap=t.fieldsMap}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){return e.outStatistics?e.outStatistics.some(function(e){return"exceedslimit"===e.statisticType})?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e)},e.prototype.executeAttributesQuery=function(e){var t=u.getWhereClause(e.where);if(!t)return n.resolve(this);if(t.isStandardized()){for(var r=0,i=[],o=0,a=this.items;o<a.length;o++){var s=a[o];t.testFeature(s.attributes)&&(i[r++]=s)}var l=this._createNew(i);return l.definitionExpression=e.where,n.resolve(l)}return n.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(e){if(!e.objectIds||!e.objectIds.length)return n.resolve(this);var t=new r.default(e.objectIds);return n.resolve(this._createNew(this.items.filter(function(e){return t.has(e.objectId)})))},e.prototype.project=function(t){var r=this;return!t||o.equals(this.spatialReference,t)?n.resolve(this):l.projectMany(this.items.map(function(e){return c.getGeometry(r,e)}),this.spatialReference,t).then(function(n){for(var i=[],o=0;o<r.items.length;o++)i[o]={attributes:r.items[o].attributes,geometry:n[o]};var s=[];return a.convertFromFeatures(s,i,r.geometryType,r.hasZ,r.hasM,r.objectIdField),new e(s,{definitionExpression:r.definitionExpression,geometryType:r.geometryType,hasM:r.hasM,hasZ:r.hasZ,objectIdField:r.objectIdField,spatialReference:t,fieldsMap:r.fieldsMap})})},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,n=this,o=n.geometryType,a=n.hasM,s=n.hasZ,u=n.objectIdField,l=n.spatialReference,c=e.outFields,f=e.outSpatialReference,h=e.quantizationParameters,p=!1;if(null!=e.num&&null!=e.start){var d=e.start+e.num;p=r.length>d,r=r.slice(e.start,Math.min(r.length,d))}return{exceededTransferLimit:p,features:this._createFeatures(e,r),fields:c&&c.map(function(e){return t.fieldsMap.get(e)}),geometryType:o,hasM:a,hasZ:s,objectIdFieldName:u,spatialReference:function(e){return e?JSON.parse(JSON.stringify(e,["latestWkid","wkid","wkt"])):e}(f?f.toJSON():l),transform:h&&i.toTransform(h)}},e.prototype._createFeatures=function(e,t){var r=new s.default(e,this.fieldsMap),n=e.quantizationParameters,o=e.returnGeometry,a=e.returnCentroid,u=e.maxAllowableOffset,l=e.orderByFields,f=[],h=0;if(t.length&&l&&l.length){var p=l[0].split(" "),d=p[0],v="DESC"===p[1];t.sort(function(e,t){var n=r.getFieldValue(e,d),i=r.getFieldValue(t,d);if("number"==typeof n&&"number"==typeof i)return v?i-n:n-i;if("string"==typeof n&&"string"==typeof i){var o=n.toUpperCase(),a=i.toUpperCase();return(v?o>a:o<a)?-1:(v?o<a:o>a)?1:0}})}if(o||a){var y=i.toTransform(n);if(o&&!a)for(var m=0,g=t;m<g.length;m++){var x=g[m];f[h++]={attributes:r.getAttributes(x),geometry:c.getGeometry(this,x,u,y)}}else if(!o&&a)for(var _=0,b=t;_<b.length;_++){x=b[_];f[h++]={attributes:r.getAttributes(x),centroid:c.getCentroid(this,x,y)}}else for(var I=0,w=t;I<w.length;I++){x=w[I];f[h++]={attributes:r.getAttributes(x),centroid:c.getCentroid(this,x,y),geometry:c.getGeometry(this,x,u,y)}}}else for(var C=0,P=t;C<P.length;C++){x=P[C];var T=r.getAttributes(x);T&&(f[h++]={attributes:T})}return f},e.prototype._createNew=function(t){return new e(t,this)},e.prototype._createExceedsLimitQueryResponse=function(e){var t=!1,r=null;e.outStatistics.some(function(e){return r=e,"exceedslimit"===e.statisticType});var n=null!=r.maxPointCount?r.maxPointCount:Number.POSITIVE_INFINITY,i=null!=r.maxRecordCount?r.maxRecordCount:Number.POSITIVE_INFINITY,o=null!=r.maxVertexCount?r.maxVertexCount:Number.POSITIVE_INFINITY;if("esriGeometryPoint"===this.geometryType)t=this.items.length>n;else if(this.items.length>i)t=!0;else{var a=this.hasZ?this.hasM?4:3:this.hasM?3:2;t=this.items.reduce(function(e,t){return e+(t.geometry&&t.geometry.coords.length||0)},0)/a>o}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new s.default(e,this.fieldsMap),r=e.outStatistics,n=[],i=[],o=e.groupByFieldsForStatistics,a=e.having,u=o&&o.length,l=u&&o[0],c={},f={},h={},p={attributes:{}},d=0,v=r;d<v.length;d++){var y=v[d],m=y.onStatisticField,g=y.outStatisticFieldName,x=y.statisticType,_="1"===m;if(u&&(m===l||_)&&"count"===x){c[m]||(c[m]=this._calculateUniqueValues(t,_?l:m));var b=c[m];for(var I in b){var w=b[I],C=w.count,P=w.data,T=w.items,S=f[P]||{attributes:{}};a&&!t.validateItems(T,a)||(S.attributes[g]=C,S.attributes[_?"EXPR_1":m]=P,f[P]=S)}i.push({name:g,alias:g,type:"esriFieldTypeString"})}else{if(u){var D=this._calculateUniqueValues(t,l);for(var I in D){var A=D[I];P=A.data,T=A.items;if(!a||t.validateItems(T,a)){S=f[P]||{attributes:{}};var M=this._calculateStatistics(T,t,m),E="var"===x?"variance":x;S.attributes[g]=M[E],S.attributes[l]=P,f[P]=S}}}else{h[m]||(h[m]=this._calculateStatistics(this.items,t,m));M=h[m],E="var"===x?"variance":x;p.attributes[g]=M[E]}i.push({name:g,alias:g,type:"esriFieldTypeDouble"})}}if(u)for(var B in f)n.push(f[B]);else n.push(p);return{fields:i,features:n}},e.prototype._calculateStatistics=function(e,t,r){for(var n=e.length,i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=null,s=null,u=null,l=null,c=[],f=0;f<n;f++){var h=e[f],p=c[f]=t.getFieldValue(h,r);isNaN(p)||(a+=p,i=Math.min(i,p),o=Math.max(o,p))}if(n){s=a/n;for(var d=0,v=0,y=c;v<y.length;v++){p=y[v];d+=Math.pow(p-s,2)}l=n>1?d/(n-1):0,u=Math.sqrt(l)}else i=null,o=null;return{avg:s,count:n,max:o,min:i,stddev:u,sum:a,variance:l}},e.prototype._calculateUniqueValues=function(e,t){for(var r={},n=0,i=this.items;n<i.length;n++){var o=i[n],a=e.getFieldValue(o,t);(null==a||"string"==typeof a&&""===a.trim())&&(a=null),null==r[a]?r[a]={count:1,data:a,items:[o]}:(r[a].count++,r[a].items.push(o))}return r},e}();t.default=f}.apply(null,n))||(e.exports=i)},1828:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1426),r(1677)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._fieldDataCache=new r.default,this._returnDistinctMap=new r.default,this.returnDistinctValues=e.returnDistinctValues,this.fieldsMap=t;var i=e.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;for(var o=0,a=0,s=i;a<s.length;a++){var u=s[a],l=n.getExpressionFromFieldName(u),c=this.fieldsMap.has(l),f=c?null:n.getWhereClause(l),h=c?this.fieldsMap.get(u).name:n.getAliasFromFieldName(u)||"FIELD_EXP_"+o++;this._fieldDataCache.set(u,{alias:h,clause:f})}}}return e.prototype.getAttributes=function(e){var t=e.attributes;return t=this._processAttributesForOutFields(t),this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t){var r=e.attributes,i=this.fieldsMap.has(t),o=i?this.fieldsMap.get(t).name:t,a=null;return this._fieldDataCache.has(o)?a=this._fieldDataCache.get(o).clause:i||(a=n.getWhereClause(t),this._fieldDataCache.set(o,{alias:o,clause:a})),i?r[o]:a.calculateValue(r)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t)}),this._fieldDataCache.get(t).clause.testFeature(e.attributes)},e.prototype.validateItems=function(e,t){var r=this;this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t)});var i=e.map(function(e){return r.getAttributes(e)});return this._fieldDataCache.get(t).clause.testSet(i)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!e||!t||!t.length)return e;for(var r={},n=0,i=t;n<i.length;n++){var o=i[n],a=this._fieldDataCache.get(o),s=a.alias,u=a.clause;r[s]=u?u.calculateValue(e):e[s]}return r},e.prototype._processAttributesForDistinctValues=function(e){if(!e||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n],a=this._fieldDataCache.get(o).alias;r.push(e[a])}else for(var a in e)r.push(e[a]);var s=(t||["*"]).join(",")+"="+r.join(","),u=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++u),u>1?null:e},e}();t.default=i}.apply(null,n))||(e.exports=i)},1829:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(9),r(8),r(85),r(259),r(59),r(1552)],void 0===(i=function(e,t,n,i,o,a,s,u){function l(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(255)];e.apply(null,t)}.bind(this)).catch(r.oe)})}Object.defineProperty(t,"__esModule",{value:!0});var c="feature-store:unsupported-query",f={spatialRelationship:{intersects:!0,contains:!0,within:!0,crosses:!0,touches:!0,overlaps:!0,"envelope-intersects":!0},queryGeometry:{point:!0,multipoint:!0,polyline:!0,polygon:!0,extent:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0}};t.importGeometryEngine=l,t.getGeodesicBufferOperator=function(){return l().then(function(e){return e.geodesicBuffer})},t.getSpatialQueryOperator=function(e,t,r){if("intersects"===e){if("polygon"===t.type&&"esriGeometryPoint"===r)return i.resolve(o.polygonContainsPoint.bind(null,t.toJSON()));if("extent"===t.type)return i.resolve(a.getExtentIntersector(r).bind(null,t))}return l().then(function(r){return r[e].bind(null,t.toJSON())})},t.checkSpatialQuerySupport=function(e,t,r){var o=e.spatialRelationship,a=e.geometry;return a?function(e){return!0===f.spatialRelationship[e]}(o)?s.isValid(a.spatialReference)&&s.isValid(r)?function(e){return!0===f.queryGeometry[e]}(a.type)?function(e){return!0===f.layerGeometry[e]}(t)?u.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSpatialReference):i.reject(new n(c,"Unsupported layer geometry type",{query:e})):i.reject(new n(c,"Unsupported query geometry type",{query:e})):i.resolve():i.reject(new n(c,"Unsupported query spatial relationship",{query:e})):null},t.canQueryWithRBush=function(e){switch(e.type){case"extent":return!0;case"polygon":return e.rings.every(function(e){return 5===e.length&&e[0][0]===e[1][0]&&e[0][0]===e[4][0]&&e[2][0]===e[3][0]&&e[0][1]===e[3][1]&&e[0][1]===e[4][1]&&e[1][1]===e[2][1]});default:return!1}}}.apply(null,n))||(e.exports=i)},1908:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(105),r(477),r(1529),r(1725)],void 0===(i=function(e,t,r,n,i,o,a,s){return function(e){function t(t,r,n,i,o,a){var s=e.call(this,t,r)||this;if(t.hasDataDrivenFill!==n.isDataDriven())throw new Error("incompatible fill buffer");if(t.hasDataDrivenOutline!==o.isDataDriven())throw new Error("incompatible outline buffer");return s._fillVertexBuffer=n,s._fillIndexBuffer=i,s._outlineVertexBuffer=o,s._outlineIndexBuffer=a,s}return r(t,e),Object.defineProperty(t.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._fillIndexStart=this._fillIndexStart,t._fillIndexCount=this._fillIndexCount,e.layer.getPaintProperty("fill-outline-color")?(t._outlineIndexStart=this._outlineIndexStart,t._outlineIndexCount=this._outlineIndexCount):(t._outlineIndexStart=0,t._outlineIndexCount=0)},t.prototype.processFeatures=function(e,t){this._fillIndexStart=this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=this._outlineIndexBuffer.index,this._outlineIndexCount=0;var r=this.layer,n=this.zoom,i=r.hasDataDrivenFill,o=r.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var a=r.getPaintValue("fill-pattern",n),s=r.getPaintValue("fill-antialias",n)&&void 0===a,u=[1,1,1,1],l=[1,1,1,1],c=1;if(r.outlineUsesFillColor){if(s&&!r.hasDataDrivenOpacity){var f=r.getPaintValue("fill-opacity",n),h=r.getPaintValue("fill-opacity",n+1);f<1&&h<1&&(s=!1)}if(s&&!r.hasDataDrivenColor){var p=r.getPaintValue("fill-color",n),d=r.getPaintValue("fill-color",n+1);p[3]<1&&d[3]<1&&(s=!1)}}for(var v=0,y=this._features;v<y.length;v++){var m=y[v];!a&&r.hasDataDrivenColor&&(u=r.getPaintValue("fill-color",n,m)),r.hasDataDrivenOpacity&&(c=r.getPaintValue("fill-opacity",n,m)),!a&&r.hasDataDrivenOutlineColor&&(l=r.getPaintValue("fill-outline-color",n,m));var g=void 0;i&&(g={color:u,opacity:c});var x=void 0;o&&(x={color:r.outlineUsesFillColor?u:l,opacity:c});var _=m.getGeometry(e);this._processFeature(_,s,r.outlineUsesFillColor,g,x)}},t.prototype._processFeature=function(e,r,n,i,o){if(e){var a=e.length;if(r&&(!n||!o||o.color[3]*o.opacity==1))for(var s=0;s<a;s++)this._processOutline(e[s],o);var u;for(s=0;s<a;s++){var l=t._area(e[s]);l>128?(void 0!==u&&this._processFill(e,u,i),u=[s]):l<-128&&void 0!==u&&u.push(s)}void 0!==u&&this._processFill(e,u,i)}},t.prototype._processOutline=function(e,t){var r,n,i,o=this._outlineVertexBuffer,s=this._outlineIndexBuffer,u=s.index,l=new a.Point(0,0),c=new a.Point(0,0),f=new a.Point(0,0),h=-1,p=-1,d=-1,v=-1,y=-1,m=!1,g=e.length;if(!(g<2)){for(var x=e[0],_=e[g-1];g&&_.isEqual(x);)_=e[--g-1];if(!(g-0<2)){for(var b=0;b<g;++b){0===b?(r=e[g-1],n=e[0],i=e[1],l.assignSub(n,r),l.normalize(),l.rightPerpendicular()):(r=n,n=i,i=b!==g-1?e[b+1]:e[0],l.assign(c));var I=this._isClipEdge(r,n);-1===v&&(m=I),c.assignSub(i,n),c.normalize(),c.rightPerpendicular();var w=l.x*c.y-l.y*c.x;f.assignAdd(l,c),f.normalize();var C=-f.x*-l.x+-f.y*-l.y,P=Math.abs(0!==C?1/C:1);P>8&&(P=8),w>=0?(d=o.add(n.x,n.y,l.x,l.y,0,1,t),-1===v&&(v=d),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d),p=o.add(n.x,n.y,P*-f.x,P*-f.y,0,-1,t),-1===y&&(y=p),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d),h=p,p=d,d=o.add(n.x,n.y,f.x,f.y,0,1,t),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d),p=o.add(n.x,n.y,c.x,c.y,0,1,t),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d)):(d=o.add(n.x,n.y,P*f.x,P*f.y,0,1,t),-1===v&&(v=d),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d),p=o.add(n.x,n.y,-l.x,-l.y,0,-1,t),-1===y&&(y=p),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d),h=p,p=d,d=o.add(n.x,n.y,-f.x,-f.y,0,-1,t),h>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d),(h=o.add(n.x,n.y,-c.x,-c.y,0,-1,t))>=0&&p>=0&&d>=0&&!I&&s.add(h,p,d))}h>=0&&p>=0&&v>=0&&!m&&s.add(h,p,v),h>=0&&v>=0&&y>=0&&!m&&s.add(h,y,v),this._outlineIndexCount+=3*(s.index-u)}}},t.prototype._processFill=function(e,t,r){var n;t.length>1&&(n=[]);for(var a=0,s=0,u=t;s<u.length;s++){var l=u[s];0!==a&&n.push(a),a+=e[l].length}for(var c=2*a,f=i.acquire(),h=0,p=t;h<p.length;h++)for(var d=e[l=p[h]],v=d.length,y=0;y<v;++y)f.push(d[y].x),f.push(d[y].y);var m=o(f,n,2),g=m.length;if(g>0){for(var x=this._fillVertexBuffer.index,_=0;_<c;)this._fillVertexBuffer.add(f[_++],f[_++],r);for(var b=0;b<g;)this._fillIndexBuffer.add(x+m[b++],x+m[b++],x+m[b++]);this._fillIndexCount+=g}i.release(f)},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t._area=function(e){for(var t=0,r=e.length-1,n=0;n<r;n++)t+=(e[n].x-e[n+1].x)*(e[n].y+e[n+1].y);return.5*(t+(e[r].x-e[0].x)*(e[r].y+e[0].y))},t}(s)}.apply(null,n))||(e.exports=i)},1909:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(16),r(510),r(122),r(8)],void 0===(i=function(e,t,r,n,i,o){function a(){var e=0===u.length;if(!e){for(var t=i();!e&&i()-t<s;){var r=u[c];if(r){if(!0===r()){var o=l.get(r);u[c]=null,l.delete(r),o()}c=(c+1)%u.length}else u.splice(c,1),(e=0===u.length)?c=0:c%=u.length}e||n(a)}}var s=r("host-browser")?6:200,u=[],l=new Map,c=0;return function(e){return e?o.create(function(t){u.push(e),l.set(e,t),1===u.length&&n(a)},function(){u[u.indexOf(e)]=null,l.delete(e)}):o.reject(new TypeError("callback is not a function"))}}.apply(null,n))||(e.exports=i)},1910:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1725)],void 0===(i=function(e,t,r,n,i){return function(e){function t(t,r){return e.call(this,t,r)||this}return r(t,e),t}(i)}.apply(null,n))||(e.exports=i)},1911:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1725)],void 0===(i=function(e,t,r,n,i){return function(e){function t(t,r,n,i){var o=e.call(this,t,r)||this;return o._circleVertexBuffer=n,o._circleIndexBuffer=i,o}return r(t,e),Object.defineProperty(t.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._circleIndexStart=this._circleIndexStart,t._circleIndexCount=this._circleIndexCount},t.prototype.processFeatures=function(e,t){var r=this._circleVertexBuffer,n=this._circleIndexBuffer;this._circleIndexStart=n.index,this._circleIndexCount=0;var i=this.layer,o=this.zoom;e&&e.setExtent(this.layerExtent);for(var a=1,s=[1,1,1,1],u=1,l=0,c=1,f=[1,1,1,1],h=1,p=0,d=this._features;p<d.length;p++){var v=d[p],y=v.getGeometry(e);if(y){i.hasDataDrivenRadius&&(a=i.getPaintValue("circle-radius",o,v)),i.hasDataDrivenColor&&(s=i.getPaintValue("circle-color",o,v)),i.hasDataDrivenOpacity&&(u=i.getPaintValue("circle-opacity",o,v)),i.hasDataDrivenStrokeWidth&&(c=i.getPaintValue("circle-stroke-width",o,v)),i.hasDataDrivenStrokeColor&&(f=i.getPaintValue("circle-stroke-color",o,v)),i.hasDataDrivenStrokeOpacity&&(h=i.getPaintValue("circle-stroke-opacity",o,v)),i.hasDataDrivenBlur&&(l=i.getPaintValue("circle-blur",o,v));for(var m=0,g=y;m<g.length;m++){var x=g[m];if(x)for(var _=0,b=x;_<b.length;_++){var I=b[_],w=r.index;r.add(I.x,I.y,0,0,a,s,u,l,c,f,h),r.add(I.x,I.y,0,1,a,s,u,l,c,f,h),r.add(I.x,I.y,1,0,a,s,u,l,c,f,h),r.add(I.x,I.y,1,1,a,s,u,l,c,f,h),n.add(w+0,w+1,w+2),n.add(w+1,w+2,w+3),this._circleIndexCount+=6}}}}},t}(i)}.apply(null,n))||(e.exports=i)},1912:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1667),r(1725),r(1726)],void 0===(i=function(e,t,r,n,i,o,a){var s=20,u=new i.Tessellator({distanceAlongCorrection:!0});return function(e){function t(t,r,n,o){var a=e.call(this,t,r)||this;if(a.extrudeVectorsDoubleBuffer=[i.allocExtrudeVectors(),i.allocExtrudeVectors()],a.firstExtrudeVectors=i.allocExtrudeVectors(),a.recycledTriangleBridge=i.allocTriangles(s),a.recycledTrianglePie=i.allocTriangles(s),t.hasDataDrivenLine!==n.isDataDriven())throw new Error("incompatible line buffer");return a._lineVertexBuffer=n,a._lineIndexBuffer=o,a}return r(t,e),Object.defineProperty(t.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._lineIndexStart=this._lineIndexStart,t._lineIndexCount=this._lineIndexCount},t.prototype.processFeatures=function(e,t){this._lineIndexStart=this._lineIndexBuffer.index,this._lineIndexCount=0;var r=this.layer,n=this.zoom,i=r.hasDataDrivenLine;e&&e.setExtent(this.layerExtent);for(var o=r.getPaintValue("line-pattern",n),s=[1,1,1,1],u=1,l=1,c=0,f=this._features;c<f.length;c++){var h=f[c],p=new a.LineLayout(r,n,h);!o&&r.hasDataDrivenColor&&(s=r.getPaintValue("line-color",n,h)),r.hasDataDrivenOpacity&&(u=r.getPaintValue("line-opacity",n,h)),r.hasDataDrivenWidth&&(l=r.getPaintValue("line-width",n,h));var d=void 0;if(!(i&&(d={color:s,opacity:u,size:Math.max(Math.min(l,256),0)},d.size<=0||d.opacity<=0||d.color[3]<=0))){var v=h.getGeometry(e);this._processFeature(p,v,d)}}},t.prototype._processFeature=function(e,t,r){if(t)for(var n=t.length,i=0;i<n;i++)this._processGeometry(t[i],e,r)},t.prototype._processGeometry=function(e,t,r){if(!(e.length<2)){for(var n=e[0],o=e[e.length-1],a=o.x-n.x,s=o.y-n.y,u=a*a+s*s<1e-6,l=e[0],c=1;c<e.length;)(a=e[c].x-l.x)*a+(s=e[c].y-l.y)*s<1e-6?e.splice(c,1):(l=e[c],++c);if(!(e.length<2)){this.vertices=e,this.verticesLen=e.length,this.isClosed=u,this.cap=t.cap,this.join=t.join,this.almostParallelRads=.05,this.veryShallowRads=.1,this.miterSafeRads=i.MITER_SAFE_RADS,this.miterLimitMag=Math.min(t.miterLimit,i.SYSTEM_MAG_LIMIT),this.roundLimitRads=Math.min(t.roundLimit,.5),this.newRoundJoinsSafeRads=2.3;for(var f=this._lineIndexBuffer.index,h=0,p=void 0,d=this.verticesLen,v=0;v<d;++v){var y=e[v],m=e[(v+d-1)%d],g=u&&this._isClipEdge(m,y),x=p===this.extrudeVectorsDoubleBuffer[v%2]?this.extrudeVectorsDoubleBuffer[(v+1)%2]:this.extrudeVectorsDoubleBuffer[v%2];if(v<d-1||!u||this.hasPattern?(this._computeExtrudeVectors(x,v),this._writeGPUVertices(y.x,y.y,h,x,r),!x.capCenter||u&&v===d-1||this._writeGPUPieElements(x,g),u&&0===v&&!this.hasPattern&&i.copyExtrudeVectors(this.firstExtrudeVectors,x)):i.copyExtrudeVectors(x,this.firstExtrudeVectors),p&&this._writeGPUBridgeElements(p,x,g),v<d-1){var _=e[v+1];h+=i.length([_.x-y.x,_.y-y.y])}p=x}this._lineIndexCount+=3*(this._lineIndexBuffer.index-f)}}},t.prototype._computeExtrudeVectors=function(e,t){var r=this.vertices,n=this.verticesLen,o=this.isClosed,a=r[t],s=[void 0,void 0],u=[void 0,void 0];if(t>0&&t<n-1){var l=r[(t+n-1)%n],c=r[(t+1)%n];i.normalize(s,[a.x-l.x,a.y-l.y]),i.normalize(u,[c.x-a.x,c.y-a.y])}else if(0===t){c=r[(t+1)%n];if(i.normalize(u,[c.x-a.x,c.y-a.y]),o){var f=r[n-2];i.normalize(s,[a.x-f.x,a.y-f.y])}else s=u}else{if(t!==n-1)return void console.error("Vertex index 'i' out of range.");l=r[(t+n-1)%n];if(i.normalize(s,[a.x-l.x,a.y-l.y]),o){var h=r[1];i.normalize(u,[h.x-a.x,h.y-a.y])}else u=s}o||0!==t?o||t!==n-1?this._computeJoinExtrudeVectors(e,s,u):this._computeCapExtrudeVectors(e,s,u,i.CapPosition.END):this._computeCapExtrudeVectors(e,s,u,i.CapPosition.START)},t.prototype._computeCapExtrudeVectors=function(e,t,r,n){0===this.cap?u.buttCap(e,t,r):1===this.cap?u.roundCap(e,t,r,n,i.getNumberOfSlices(Math.PI),n===i.CapPosition.START?-1:1):2===this.cap?u.squareCap(e,t,r,n):u.buttCap(e,t,r)},t.prototype._computeJoinExtrudeVectors=function(e,t,r){var n=i.getRads(t,r);if(n>Math.PI-this.almostParallelRads)u.rectJoin(e,t,r);else if(0===this.join&&n>=this.veryShallowRads)u.bevelJoin(e,t,r,1);else if(1===this.join&&n>=this.veryShallowRads){var o=i.getNumberOfSlices(n);n<this.newRoundJoinsSafeRads?o<2||n<this.roundLimitRads?u.bevelJoin(e,t,r,1):u.roundJoin(e,t,r,o):u.unitRoundJoin(e,t,r,o)}else n<this.almostParallelRads?u.fastMiterJoin(e,t,r):n<this.miterSafeRads?u.miterJoin(e,t,r):u.bevelJoin(e,t,r,this.miterLimitMag)},t.prototype._writeGPUVertices=function(e,t,r,n,i){for(var o=0;o<n.vectors.count;++o){var a=n.vectors.items[o].vector[0],s=n.vectors.items[o].vector[1],u=n.vectors.items[o].texCoords[0],l=n.vectors.items[o].texCoords[1];n.vectors.items[o].base=this._lineVertexBuffer.index,this._lineVertexBuffer.add(e,t,a,s,u,l,r,i)}},t.prototype._writeGPUBridgeElements=function(e,t,r){if(u.bridge(this.recycledTriangleBridge,e,t),!r)for(var n=0;n<this.recycledTriangleBridge.count;++n){var i=this.recycledTriangleBridge.items[n];this._lineIndexBuffer.add(i.v1.base,i.v2.base,i.v3.base)}},t.prototype._writeGPUPieElements=function(e,t){if(u.pie(this.recycledTrianglePie,e),!t)for(var r=0;r<this.recycledTrianglePie.count;++r){var n=this.recycledTrianglePie.items[r];this._lineIndexBuffer.add(n.v1.base,n.v2.base,n.v3.base)}},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t}(o)}.apply(null,n))||(e.exports=i)},1913:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1529),r(2257),r(1402)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t,r,n,i){void 0===r&&(r=0),void 0===n&&(n=-1),void 0===i&&(i=l),this.x=e,this.y=t,this.angle=r,this.segment=n,this.minzoom=i}}();t.Anchor=o;var a=function(){return function(e,t,r,n,o,a,s){void 0===o&&(o=!1),void 0===a&&(a=l),void 0===s&&(s=i.C_INFINITY),this.anchor=e,this.labelAngle=t,this.glyphAngle=r,this.page=n,this.upsideDown=o,this.minzoom=a,this.maxzoom=s}}(),s=function(){return function(e,t,r,n,i,o,a,s,u,l){this.tl=e,this.tr=t,this.bl=r,this.br=n,this.mosaicRect=i,this.labelAngle=o,this.anchor=a,this.minzoom=s,this.maxzoom=u,this.page=l}}();t.PlacedSymbol=s;var u=function(){return function(e,t){this.footprint=e,this.shapes=t}}();t.Placement=u;var l=.5,c=function(){function e(){this.mapAngle=0,this._conflictEngine=new n.ConflictEngine}return e.prototype.reset=function(){this._conflictEngine.reset()},e.prototype.setAngle=function(e){this.mapAngle=e,this._conflictEngine.setAngle(e)},e.prototype.getIconPlacement=function(e,t,o,a,c,f,h){var p=o.width/o.pixelRatio,d=o.height/o.pixelRatio,v=f.offset[0]-p/2,y=f.offset[1]-d/2,m=v+p,g=y+d,x=o.rect,_=o.sdf?17:2,b=v-_,I=y-_,w=b+x.width/o.pixelRatio,C=I+x.height/o.pixelRatio,P=new r.Point(b,I),T=new r.Point(w,C),S=new r.Point(b,C),D=new r.Point(w,I),A=f.rotate*i.C_DEG_TO_RAD,M=1===f.rotationAlignment;if(e.segment>=0&&!M&&(A+=e.angle),0!==A){var E=Math.cos(A),B=Math.sin(A);P.rotate(E,B),T.rotate(E,B),S.rotate(E,B),D.rotate(E,B)}var N=8*f.padding,V=new r.Point(e.x,e.y),O=new n.Footprint(this.mapAngle,N,M);O.addBox(V,new n.Box(v,y,m,g),a,A,t,l,i.C_INFINITY);var L=new s(P,D,S,T,x,0,V,l,i.C_INFINITY,0),F=new u(O,[L]),z=l;return f.allowOverlap||(z=this._conflictEngine.getMinZoom(F.footprint,z,h,M)),O.minzoom=z,F},e.prototype.getTextPlacement=function(e,t,o,c,f,h,p,d){for(var v,y=new r.Point(e.x,e.y),m=p.rotate*i.C_DEG_TO_RAD,g=0===p.rotationAlignment,x=p.keepUpright,_=l,b=!g,I=b?0:e.angle,w=e.segment>=0&&g,C=8*p.padding,P=new n.Footprint(this.mapAngle,C,b),T=[],S=!w,D=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,M=D,E=A,B=w?x:g&&x,N=0,V=c;N<V.length;N++){var O=V[N],L=O.glyphMosaicItem;if(L&&!L.rect.isEmpty){var F=L.rect,z=L.metrics,R=L.page;S&&(v&&v!==O.y&&(P.addBox(y,new n.Box(D,M,A,E),f,m,t,l,i.C_INFINITY),M=D=Number.POSITIVE_INFINITY,E=A=Number.NEGATIVE_INFINITY),v=O.y);var j=[];if(w){var k=.5*L.metrics.width,U=(o.x+O.x+z.left-4+k)*f;if(_=this._placeGlyph(e,_,U,h,e.segment,1,R,j),x&&(_=this._placeGlyph(e,_,U,h,e.segment,-1,R,j)),_>=2)break}else j.push(new a(y,I,I,R)),g&&x&&j.push(new a(y,I+i.C_PI,I+i.C_PI,R,!0));for(var Y=O.x+o.x+z.left,G=O.y+o.y-z.top,q=Y+z.width,Q=G+z.height,Z=new r.Point(Y-4,G-4),J=new r.Point(Z.x+F.width,Z.y+F.height),X=new r.Point(Z.x,J.y),H=new r.Point(J.x,Z.y),W=0,K=j;W<K.length;W++){var $=K[W],ee=Z.clone(),te=X.clone(),re=H.clone(),ne=J.clone(),ie=G,oe=Q,ae=$.glyphAngle+m;if(0!==ae){var se=Math.cos(ae),ue=Math.sin(ae);ee.rotate(se,ue),ne.rotate(se,ue),te.rotate(se,ue),re.rotate(se,ue)}T.push(new s(ee,re,te,ne,F,$.labelAngle,$.anchor,$.minzoom,$.maxzoom,$.page)),B&&!this._legible($.labelAngle)||(S?(Y<D&&(D=Y),ie<M&&(M=ie),q>A&&(A=q),oe>E&&(E=oe)):$.minzoom<2&&P.addBox($.anchor,new n.Box(Y,ie,q,oe),f,ae,t,$.minzoom,$.maxzoom))}}}if(_>=2)return null;S&&P.addBox(y,new n.Box(D,M,A,E),f,m,t,l,i.C_INFINITY);var le=new u(P,T);return p.allowOverlap||(_=this._conflictEngine.getMinZoom(le.footprint,_,d,b)),P.minzoom=_,le},e.prototype.add=function(e){this._conflictEngine.add(e.footprint)},e.prototype._legible=function(e){var t=i.radToByte(e);return t<65||t>=193},e.prototype._placeGlyph=function(e,t,n,o,s,u,l,c){var f=u,h=f<0?i.positiveMod(e.angle+i.C_PI,i.C_2PI):e.angle,p=this._legible(h),d=0;n<0&&(f*=-1,n*=-1,d=i.C_PI),f>0&&++s;var v=new r.Point(e.x,e.y),y=o[s],m=i.C_INFINITY;if(o.length<=s)return m;for(;;){var g=y.x-v.x,x=y.y-v.y,_=Math.sqrt(g*g+x*x),b=Math.max(n/_,t),I=g/_,w=x/_,C=i.positiveMod(Math.atan2(w,I)+d,i.C_2PI);if(c.push(new a(v,h,C,l,p,b,m)),b<=t)return b;v=y.clone();do{if(s+=f,o.length<=s||s<0)return b;y=o[s]}while(v.isEqual(y));var P=y.x-v.x,T=y.y-v.y,S=Math.sqrt(P*P+T*T);P*=_/S,T*=_/S,v.x-=P,v.y-=T,m=b}},e}();t.PlacementEngine=c}.apply(null,n))||(e.exports=i)},1914:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1722),r(1529),r(1666),r(1725),r(1402),r(1913),r(1726)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c){function f(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page<t.iconMosaicItem.page?-1:1:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}return function(e){function t(t,r,n,i,o,a,s,u){var l=e.call(this,t,r)||this;if(l._markerMap=new Map,l._glyphMap=new Map,l._glyphBufferDataStorage=new Map,l._sdfMarkers=!1,t.hasDataDrivenIcon!==n.isDataDriven())throw new Error("incompatible icon buffer");if(t.hasDataDrivenText!==o.isDataDriven())throw new Error("incompatible text buffer");return l._iconVertexBuffer=n,l._iconIndexBuffer=i,l._textVertexBuffer=o,l._textIndexBuffer=a,l._placementEngine=s,l._workerTileHandler=u,l}return r(t,e),Object.defineProperty(t.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0}),t.prototype.copy=function(e,r,n,i,o){var a=new t(this.layer,this.zoom,e,r,n,i,o,this._workerTileHandler);return a.layerIndex=this.layerIndex,a.layerExtent=this.layerExtent,a._iconIndexStart=r.index,a._textIndexStart=i.index,a._iconIndexCount=0,a._textIndexCount=0,a._symbolInstances=this._symbolInstances,a._workerTileHandler=this._workerTileHandler,a._fontArray=this._fontArray,a._textLayout=this._textLayout,a._iconLayout=this._iconLayout,a._isLinePlacement=this._isLinePlacement,a._avoidEdges=this._avoidEdges,a},t.prototype.getResources=function(e,r,n){var i=this.layer,o=this.zoom,a=i.hasDataDrivenIcon,s=i.hasDataDrivenText;e&&e.setExtent(this.layerExtent);for(var u=i.getLayoutProperty("icon-image"),l=i.getLayoutProperty("text-field"),c=i.getLayoutValue("text-font",o),f=i.getLayoutValue("text-transform",o),h=[],p=[1,1,1,1],d=1,v=1,y=[1,1,1,1],m=1,g=1,x=0,_=this._features;x<_.length;x++){var b=_[x],I=b.getGeometry(e);if(I&&0!==I.length){var w=void 0;u&&(w=i.getLayoutValue("icon-image",o,b),u.isDataDriven||(w=this._replaceKeys(w,b.values)),w&&r.add(w));var C=void 0,P=!1;if(l&&(C=i.getLayoutValue("text-field",o,b),l.isDataDriven||(C=this._replaceKeys(C,b.values)),C=C.replace(/\\n/g,"\n"))){switch(f){case 2:C=C.toLowerCase();break;case 1:C=C.toUpperCase()}if(t._bidiEngine.hasBidiChar(C)){var T;T="rtl"===t._bidiEngine.checkContextual(C)?"IDNNN":"ICNNN",C=t._bidiEngine.bidiTransform(C,T,"VLYSN"),P=!0}var S=C.length;if(S>0)for(var D=0,A=c;D<A.length;D++){var M=A[D],E=n[M];E||(E=n[M]=new Set);for(var B=0;B<S;B++){var N=C.charCodeAt(B);E.add(N)}}}if(w||C){var V=i.getLayoutValue("icon-size",o,b),O=i.getLayoutValue("text-size",o,b);i.hasDataDrivenIconColor&&(p=i.getPaintValue("icon-color",o,b)),i.hasDataDrivenIconOpacity&&(d=i.getPaintValue("icon-opacity",o,b)),i.hasDataDrivenIconSize&&(v=V),i.hasDataDrivenTextColor&&(y=i.getPaintValue("text-color",o,b)),i.hasDataDrivenTextOpacity&&(m=i.getPaintValue("text-opacity",o,b)),i.hasDataDrivenTextSize&&(g=O);var L={sprite:w,label:C,rtl:P,type:b.type,geometry:I,iconSize:V,iconRotate:i.getLayoutValue("icon-rotate",o,b),ddIconValues:a?{color:p,opacity:d,size:v}:null,textSize:O,textRotate:i.getLayoutValue("text-rotate",o,b),ddTextValues:s?{color:y,opacity:m,size:g}:null};h.push(L)}}}this._symbolFeatures=h},t.prototype.processFeatures=function(e,r){e&&e.setExtent(this.layerExtent);var n,i,o,s,h,p=this.layer,d=this.zoom,v=this._isLinePlacement=1===p.getLayoutValue("symbol-placement",d),y=this._avoidEdges=p.getLayoutValue("symbol-avoid-edges",d)&&!v,m=8*p.getLayoutValue("symbol-spacing",d),g=p.getLayoutProperty("icon-image"),x=p.getLayoutProperty("text-field"),_=this._workerTileHandler;if(g&&(this._iconLayout=new c.IconLayout(p,d,v),n=_.getSpriteItems(),i=this._getTranslate(!0)),x){var b=this._textLayout=new c.TextLayout(p,d,v);this._fontArray=b.fontArray;var I=.5;switch(b.anchor){case 5:case 1:case 7:I=0;break;case 6:case 2:case 8:I=1}var w=.5;switch(b.anchor){case 5:case 3:case 6:w=0;break;case 7:case 4:case 8:w=1}var C=.5;switch(b.justify){case 0:C=0;break;case 2:C=1}var P=24*b.letterSpacing,T=v?0:24*b.maxWidth,S=24*b.lineHeight,D=[24*b.offset[0],24*b.offset[1]];o=this._fontArray.map(function(e){return _.getGlyphItems(e)}),s=new a(o,T,S,P,D,I,w,C),h=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var A=[];this._symbolInstances=A;var M=this._textLayout,E=1;M&&M.size&&(E=M.size/24);for(var B=M?M.maxAngle*u.C_DEG_TO_RAD:0,N=M?8*M.size:0,V=0,O=this._symbolFeatures;V<O.length;V++){var L=O[V],F=void 0;L.sprite&&(F=n[L.sprite])&&F.sdf&&(this._sdfMarkers=!0);var z=void 0,R=L.label,j=0;if(R&&(z=s.getShaping(R,L.rtl))&&z.length>0){for(var k=1e30,U=-1e30,Y=0,G=z;Y<G.length;Y++){var q=G[Y];k=Math.min(k,q.x),U=Math.max(U,q.x)}j=(U-k+48)*E*8}for(var Q=0,Z=L.geometry;Q<Z.length;Q++){var J=Z[Q],X=void 0;if(v){if(z&&z.length>0&&M&&M.size){var H=8*M.size*(2+Math.min(2,4*Math.abs(M.offset[1])));t._smoothVertices(J,H)}X=t._findAnchors(J,m,j)}else X=3===L.type?t._findCentroid(J):[new l.Anchor(J[0].x,J[0].y)];for(var W=0,K=X;W<K.length;W++){var $=K[W];$.x<0||$.x>4096||$.y<0||$.y>4096||v&&j>0&&0===M.rotationAlignment&&!t._honorsTextMaxAngle(J,$,j,B,N)||A.push({shaping:z,line:J,iconMosaicItem:F,anchor:$,iconSize:L.iconSize,iconRotate:L.iconRotate,ddIconValues:L.ddIconValues,textSize:L.textSize,textRotate:L.textRotate,ddTextValues:L.ddTextValues})}}}A.sort(f);for(var ee=0,te=A;ee<te.length;ee++){var re=te[ee];this._processFeature(re,i,h,y)}this._addPlacedGlyphs()},t.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var e,t,r=this._avoidEdges,n=this.layer;n.getLayoutProperty("icon-image")&&(e=this._getTranslate(!0)),n.getLayoutProperty("text-field")&&(t=this._getTranslate(!1));for(var i=0,o=this._symbolInstances;i<o.length;i++){var a=o[i];this._processFeature(a,e,t,r)}this._addPlacedGlyphs()},t.prototype._getTranslate=function(e){var t=this.layer.getPaintValue(e?"icon-translate":"text-translate",this.zoom);if(0!==t[0]||0!==t[1]){var r=this._placementEngine.mapAngle;if(0!==r&&0===this.layer.getPaintValue(e?"icon-translate-anchor":"text-translate-anchor",this.zoom)){var n=Math.sin(r),i=Math.cos(r);return[8*(t[0]*i-t[1]*n),8*(t[0]*n+t[1]*i)]}return[8*t[0],8*t[1]]}},t.prototype._replaceKeys=function(e,t){return e.replace(/{([^{}]+)}/g,function(e,r){return r in t?t[r]:""})},t.prototype._processFeature=function(e,t,r,n){var i=e.line,a=e.iconMosaicItem,s=e.shaping,l=e.anchor,c=this._iconLayout,f=c&&!!a,h=!0,p=1;f&&(c.size=e.iconSize,c.rotate=e.iconRotate,p=8*c.size,h=c.optional||!a);var d=this._textLayout,v=d&&s&&s.length>0,y=1,m=y,g=!0;v&&(d.size=e.textSize,d.rotate=e.textRotate,m=8*(y=d.size/24),g=d.optional||!s||0===s.length);var x,_,b=new o.Point(0,-17);if((f&&(x=this._placementEngine.getIconPlacement(l,t,a,p,i,c,n),l.minzoom>x.footprint.minzoom&&(x.footprint.minzoom=l.minzoom),x.footprint.minzoom===u.C_INFINITY&&(x=null)),x||h)&&(v&&(_=this._placementEngine.getTextPlacement(l,r,b,s,m,i,d,n))&&(l.minzoom>_.footprint.minzoom&&(_.footprint.minzoom=l.minzoom),_.footprint.minzoom===u.C_INFINITY&&(_=null)),_||g)){if(x&&_||(g||h?g||_?h||x||(_=null):x=null:(x=null,_=null)),x&&_&&!g&&!h){var I=Math.max(x.footprint.minzoom,_.footprint.minzoom);x.footprint.minzoom=I,_.footprint.minzoom=I}_&&(d.ignorePlacement||this._placementEngine.add(_),this._storePlacedGlyphs(_.shapes,_.footprint.minzoom,this.zoom,e.ddTextValues)),x&&(c.ignorePlacement||this._placementEngine.add(x),this._addPlacedIcons(x.shapes,x.footprint.minzoom,this.zoom,a.page,e.ddIconValues))}},t.prototype._addPlacedIcons=function(e,t,r,n,i){for(var o=Math.max(r+u.log2(t),0),a=this._iconVertexBuffer,s=this._iconIndexBuffer,l=0,c=e;l<c.length;l++){var f=c[l],h=Math.max(r+u.log2(f.minzoom),o),p=Math.min(r+u.log2(f.maxzoom),25);if(!(p<=h)){var d=f.tl,v=f.tr,y=f.bl,m=f.br,g=f.mosaicRect,x=f.labelAngle,_=f.anchor,b=a.index,I=g.x,w=g.y,C=I+g.width,P=w+g.height;a.add(_.x,_.y,d.x,d.y,I,w,x,h,p,o,i),a.add(_.x,_.y,v.x,v.y,C,w,x,h,p,o,i),a.add(_.x,_.y,y.x,y.y,I,P,x,h,p,o,i),a.add(_.x,_.y,m.x,m.y,C,P,x,h,p,o,i),s.add(b+0,b+1,b+2),s.add(b+1,b+2,b+3),this._markerMap.has(n)?this._markerMap.get(n)[1]+=6:this._markerMap.set(n,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=2}}},t.prototype._addPlacedGlyphs=function(){var e=this,t=this._textVertexBuffer,r=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(n,i){for(var o=0,a=n;o<a.length;o++){var s=a[o],u=t.index;t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.tl[0],s.tl[1],s.xmin,s.ymin,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.tr[0],s.tr[1],s.xmax,s.ymin,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.bl[0],s.bl[1],s.xmin,s.ymax,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.br[0],s.br[1],s.xmax,s.ymax,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),r.add(u+0,u+1,u+2),r.add(u+1,u+2,u+3),e._glyphMap.has(i)?e._glyphMap.get(i)[1]+=6:e._glyphMap.set(i,[e._textIndexStart+e._textIndexCount,6]),e._textIndexCount+=2}}),this._glyphBufferDataStorage.clear()},t.prototype._storePlacedGlyphs=function(e,t,r,n){for(var i=Math.max(r+u.log2(t),0),o=0,a=e;o<a.length;o++){var s=a[o],l=Math.max(r+u.log2(s.minzoom),i),c=Math.min(r+u.log2(s.maxzoom),25);if(!(c<=l)){var f=s.tl,h=s.tr,p=s.bl,d=s.br,v=s.labelAngle,y=s.anchor,m=s.mosaicRect;this._glyphBufferDataStorage.has(s.page)||this._glyphBufferDataStorage.set(s.page,[]),this._glyphBufferDataStorage.get(s.page).push({glyphAnchor:[y.x,y.y],tl:[f.x,f.y],tr:[h.x,h.y],bl:[p.x,p.y],br:[d.x,d.y],xmin:m.x,ymin:m.y,xmax:m.x+m.width,ymax:m.y+m.height,labelAngle:v,minLod:l,maxLod:c,placementLod:i,ddValues:n})}}},t._findAnchors=function(e,t,r){t+=r;for(var n=0,i=e.length-1,a=0;a<i;a++)n+=o.Point.distance(e[a],e[a+1]);var s=r||t;if(n<=(s*=.5))return[];var c=s/n,f=0,h=-(t=n/Math.max(Math.round(n/t),1))/2,p=[],d=e.length-1;for(a=0;a<d;a++){for(var v=e[a],y=e[a+1],m=y.x-v.x,g=y.y-v.y,x=Math.sqrt(m*m+g*g),_=void 0;h+t<f+x;){var b=((h+=t)-f)/x,I=u.interpolate(v.x,y.x,b),w=u.interpolate(v.y,y.y,b);void 0===_&&(_=Math.atan2(g,m)),p.push(new l.Anchor(I,w,_,a,c))}f+=x}return p},t._deviation=function(e,t,r){var n=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),i=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(i,n)},t._honorsTextMaxAngle=function(e,t,r,n,i){for(var a=0,s=r/2,u=new o.Point(t.x,t.y),l=t.segment+1;a>-s;){if(--l<0)return!1;a-=o.Point.distance(e[l],u),u=e[l]}a+=o.Point.distance(e[l],e[l+1]);for(var c=[],f=0,h=e.length;a<s;){var p=e[l],d=l,v=void 0;do{if(++d===h)return!1;v=e[d]}while(v.isEqual(p));var y=d,m=void 0;do{if(++y===h)return!1;m=e[y]}while(m.isEqual(v));var g=this._deviation(p,v,m);for(c.push({deviation:g,distToAnchor:a}),f+=g;a-c[0].distToAnchor>i;)f-=c.shift().deviation;if(Math.abs(f)>n)return!1;a+=o.Point.distance(v,m),l=d}return!0},t._smoothVertices=function(e,t){if(!(t<=0)){var r=e.length;if(!(r<3)){var n=[],i=0;n.push(0);for(var a=1;a<r;a++)i+=o.Point.distance(e[a],e[a-1]),n.push(i);t=Math.min(t,.2*i);var s=[];s.push(e[0].x),s.push(e[0].y);var u=e[r-1].x,l=e[r-1].y,c=o.Point.sub(e[0],e[1]);c.normalize(),e[0].x+=t*c.x,e[0].y+=t*c.y,c.assignSub(e[r-1],e[r-2]),c.normalize(),e[r-1].x+=t*c.x,e[r-1].y+=t*c.y;for(a=1;a<r;a++)n[a]+=t;n[r-1]+=t;var f=.5*t;for(a=1;a<r-1;a++){for(var h=0,p=0,d=0,v=a-1;v>=0&&!(n[v+1]<n[a]-f);v--){var y=f+n[v+1]-n[a],m=n[v+1]-n[v],g=n[a]-n[v]<f?1:y/m;if(Math.abs(g)<1e-6)break;var x=g*y-.5*(C=g*g)*m,_=g*m/t,b=e[v+1],I=e[v].x-b.x,w=e[v].y-b.y;h+=_/x*(b.x*g*y+.5*C*(y*I-m*b.x)-C*g*m*I/3),p+=_/x*(b.y*g*y+.5*C*(y*w-m*b.y)-C*g*m*w/3),d+=_}for(v=a+1;v<r&&!(n[v-1]>n[a]+f);v++){y=f-n[v-1]+n[a],m=n[v]-n[v-1],g=n[v]-n[a]<f?1:y/m;if(Math.abs(g)<1e-6)break;var C;x=g*y-.5*(C=g*g)*m,_=g*m/t,b=e[v-1],I=e[v].x-b.x,w=e[v].y-b.y;h+=_/x*(b.x*g*y+.5*C*(y*I-m*b.x)-C*g*m*I/3),p+=_/x*(b.y*g*y+.5*C*(y*w-m*b.y)-C*g*m*w/3),d+=_}s.push(h/d),s.push(p/d)}s.push(u),s.push(l);for(a=0,v=0;a<r;a++)e[a].x=s[v++],e[a].y=s[v++]}}},t._findCentroid=function(e){var t=e.length-1,r=0,n=0,i=0,o=e[0].x,a=e[0].y;o>4096&&(o=4096),o<0&&(o=0),a>4096&&(a=4096),a<0&&(a=0);for(var s=1;s<t;s++){var u=e[s].x,c=e[s].y,f=e[s+1].x,h=e[s+1].y;u>4096&&(u=4096),u<0&&(u=0),c>4096&&(c=4096),c<0&&(c=0),f>4096&&(f=4096),f<0&&(f=0),h>4096&&(h=4096),h<0&&(h=0);var p=(u-o)*(h-a)-(f-o)*(c-a);r+=p*(o+u+f),n+=p*(a+c+h),i+=p}return r/=3*i,n/=3*i,isNaN(r)||isNaN(n)?[]:[new l.Anchor(r,n)]},t._bidiEngine=new i,t}(s)}.apply(null,n))||(e.exports=i)},2255:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1909),r(71),r(8),r(1812),r(1910),r(1911),r(1908),r(1402),r(2256),r(1912),r(1913),r(1914),r(2258),r(2261)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,f,h,p,d,v){return function(){function e(){this.rotation=0,this.status=o.TileStatus.INITIALIZED,this._symbolBuckets=[],this.placementEngine=new h.PlacementEngine,this.fillVertexBuffer=new v.FillVertexBuffer(!1),this.fillDDVertexBuffer=new v.FillVertexBuffer(!0),this.fillIndexBuffer=new c.TriangleIndexBuffer,this.outlineVertexBuffer=new v.OutlineVertexBuffer(!1),this.outlineDDVertexBuffer=new v.OutlineVertexBuffer(!0),this.outlineIndexBuffer=new c.TriangleIndexBuffer,this.lineVertexBuffer=new v.LineVertexBuffer(!1),this.lineDDVertexBuffer=new v.LineVertexBuffer(!0),this.lineIndexBuffer=new c.TriangleIndexBuffer,this.iconVertexBuffer=new v.SymbolVertexBuffer(!1),this.iconDDVertexBuffer=new v.SymbolVertexBuffer(!0),this.iconIndexBuffer=new c.TriangleIndexBuffer,this.textVertexBuffer=new v.SymbolVertexBuffer(!1),this.textDDVertexBuffer=new v.SymbolVertexBuffer(!0),this.textIndexBuffer=new c.TriangleIndexBuffer,this.circleVertexBuffer=new v.CircleVertexBuffer,this.circleIndexBuffer=new c.TriangleIndexBuffer}return e.prototype.initialize=function(e,t,r,n){void 0===n&&(n=0),this.tileKey=e,this.refKey=t,this._workerTileHandler=r,this.rotation=n,this.placementEngine.setAngle(l.C_DEG_TO_RAD*n)},e.prototype.release=function(){this.tileKey=this.refKey="",this.status=o.TileStatus.INITIALIZED,this.rotation=0,this.resetData(),this._workerTileHandler=null},e.prototype.resetData=function(){this.fillVertexBuffer.reset(),this.fillDDVertexBuffer.reset(),this.fillIndexBuffer.reset(),this.outlineVertexBuffer.reset(),this.outlineDDVertexBuffer.reset(),this.outlineIndexBuffer.reset(),this.lineVertexBuffer.reset(),this.lineDDVertexBuffer.reset(),this.lineIndexBuffer.reset(),this.iconVertexBuffer.reset(),this.iconDDVertexBuffer.reset(),this.iconIndexBuffer.reset(),this.textVertexBuffer.reset(),this.textDDVertexBuffer.reset(),this.textIndexBuffer.reset(),this.circleVertexBuffer.reset(),this.circleIndexBuffer.reset(),this.placementEngine.reset(),this._symbolBuckets.length=0},e.prototype.reparse=function(e){return this.resetData(),this.setDataAndParse(this._protobuffArray,e)},e.prototype.setDataAndParse=function(e,t){var r=this,n=t&&t.signal;if(this._protobuffArray=e,n){var i=function(){n.removeEventListener("abort",i),r.status=o.TileStatus.INVALID};n.addEventListener("abort",i)}return this._parse(e,t).then(function(e){r.status=o.TileStatus.READY;for(var t=[1,r.fillVertexBuffer.sizeInBytes,2,r.fillDDVertexBuffer.sizeInBytes,3,r.fillIndexBuffer.sizeInBytes,4,r.outlineVertexBuffer.sizeInBytes,5,r.outlineDDVertexBuffer.sizeInBytes,6,r.outlineIndexBuffer.sizeInBytes,7,r.lineVertexBuffer.sizeInBytes,8,r.lineDDVertexBuffer.sizeInBytes,9,r.lineIndexBuffer.sizeInBytes,10,r.iconVertexBuffer.sizeInBytes,11,r.iconDDVertexBuffer.sizeInBytes,12,r.iconIndexBuffer.sizeInBytes,13,r.textVertexBuffer.sizeInBytes,14,r.textDDVertexBuffer.sizeInBytes,15,r.textIndexBuffer.sizeInBytes,16,r.circleVertexBuffer.sizeInBytes,17,r.circleIndexBuffer.sizeInBytes],n=new Uint32Array(t),i=[],l=e.length,c=0;c<l;c++){var h=e[c];if(h instanceof u)i.push(h.layerIndex),i.push(1),i.push(h.fillIndexStart),i.push(h.fillIndexCount),i.push(h.outlineIndexStart),i.push(h.outlineIndexCount);else if(h instanceof f)i.push(h.layerIndex),i.push(2),i.push(h.lineIndexStart),i.push(h.lineIndexCount);else if(h instanceof p){i.push(h.layerIndex),i.push(3),i.push(h.sdfMarker?1:0);var d=h.markerPageMap;i.push(d.size),d.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])});var v=h.glyphsPageMap;i.push(v.size),v.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])})}else h instanceof s?(i.push(h.layerIndex),i.push(4),i.push(h.circleIndexStart),i.push(h.circleIndexCount)):h instanceof a&&(i.push(h.layerIndex),i.push(0))}var y=new Uint32Array(i),m=r.fillVertexBuffer.toBuffer(),g=r.fillDDVertexBuffer.toBuffer(),x=r.fillIndexBuffer.toBuffer(),_=r.outlineVertexBuffer.toBuffer(),b=r.outlineDDVertexBuffer.toBuffer(),I=r.outlineIndexBuffer.toBuffer(),w=r.lineVertexBuffer.toBuffer(),C=r.lineDDVertexBuffer.toBuffer(),P=r.lineIndexBuffer.toBuffer(),T=r.iconVertexBuffer.toBuffer(),S=r.iconDDVertexBuffer.toBuffer(),D=r.iconIndexBuffer.toBuffer(),A=r.textVertexBuffer.toBuffer(),M=r.textDDVertexBuffer.toBuffer(),E=r.textIndexBuffer.toBuffer(),B=r.circleVertexBuffer.toBuffer(),N=r.circleIndexBuffer.toBuffer();return{result:{bufferDataInfo:n.buffer,bucketDataInfo:y.buffer,bufferData:[m,g,x,_,b,I,w,C,P,T,S,D,A,M,E,B,N]},transferList:[m,g,x,_,b,I,w,C,P,T,S,D,A,M,E,B,N,n.buffer,y.buffer]}})},e.prototype.addBucket=function(e){this._symbolBuckets.push(e)},e.prototype.updateSymbols=function(e){var t=this,n=this._symbolBuckets;if(!n||0===n.length)return i.resolve();this.rotation=e;var a=this.placementEngine;a.reset(),a.setAngle(e/256*360*l.C_DEG_TO_RAD);var s=this.iconVertexBuffer;s.reset();var u=this.iconDDVertexBuffer;u.reset();var c=this.iconIndexBuffer;c.reset();var f=this.textVertexBuffer;f.reset();var h=this.textDDVertexBuffer;h.reset();var p=this.textIndexBuffer;p.reset();var d=[],v=n.length,y=0;return r(function(){if(t.status===o.TileStatus.INVALID||t.status===o.TileStatus.INITIALIZED)return!0;if(y<v){var e=n[y++],r=e.layer,i=e.copy(r.hasDataDrivenIcon?u:s,c,r.hasDataDrivenText?h:f,p,a);i&&(d.push(i),i.updateSymbols())}return y>=v}).then(function(){if(t.status===o.TileStatus.INVALID||t.status===o.TileStatus.INITIALIZED||0===s.sizeInBytes&&0===u.sizeInBytes&&0===c.sizeInBytes&&0===f.sizeInBytes&&0===h.sizeInBytes&&0===p.sizeInBytes)return{result:null,transferList:null};var e=[10,s.sizeInBytes,11,u.sizeInBytes,12,c.sizeInBytes,13,f.sizeInBytes,14,h.sizeInBytes,15,p.sizeInBytes],r=new Uint32Array(e),n=[];v=d.length;for(var i=0;i<v;i++){var a=d[i];n.push(a.layerIndex),n.push(3),n.push(a.sdfMarker?1:0);var l=a.markerPageMap;n.push(l.size),l.forEach(function(e,t){n.push(t),n.push(e[0]),n.push(e[1])});var y=a.glyphsPageMap;n.push(y.size),y.forEach(function(e,t){n.push(t),n.push(e[0]),n.push(e[1])})}var m=new Uint32Array(n),g=s.toBuffer(),x=u.toBuffer(),_=c.toBuffer(),b=f.toBuffer(),I=h.toBuffer(),w=p.toBuffer();return{result:{bufferDataInfo:r.buffer,bucketDataInfo:m.buffer,bufferData:[g,x,_,b,I,w]},transferList:[g,x,_,b,I,w,r.buffer,m.buffer]}}).catch(function(){return null})},e.prototype.setObsolete=function(){this.status=o.TileStatus.INVALID},e.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},e.prototype.getWorkerTileHandler=function(){return this._workerTileHandler},e.prototype._parse=function(e,t){if(!e||0===e.byteLength)return i.resolve([]);this.status=o.TileStatus.MODIFIED;var r=t.client;return new d(e,this,r).parse()},e.pool=new n(e),e}()}.apply(null,n))||(e.exports=i)},2256:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1704)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this,12)||this}return r(t,e),t.prototype.add=function(e,t,r){var n=this.array;n.push(e),n.push(t),n.push(r)},t}(i);t.TriangleIndexBuffer=o;var a=function(e){function t(){return e.call(this,4)||this}return r(t,e),t.prototype.add=function(e){this.array.push(e)},t}(i);t.PointElementMemoryBuffer=a}.apply(null,n))||(e.exports=i)},2257:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1529),r(1402)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r,n){this.left=e,this.top=t,this.right=r,this.bottom=n}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.move=function(e,t){this.left+=e,this.top+=t,this.right+=e,this.bottom+=t},e.prototype.rotate=function(e,t){var r=this.left,n=this.right,i=this.top,o=this.bottom,a=r*e-i*t,s=r*t+i*e,u=n*e-i*t,l=n*t+i*e,c=r*e-o*t,f=r*t+o*e,h=n*e-o*t,p=n*t+o*e;this.left=Math.min(a,u,c,h),this.top=Math.min(s,l,f,p),this.right=Math.max(a,u,c,h),this.bottom=Math.max(s,l,f,p)},e.overlaps=function(e,t){return e.right>t.left&&e.left<t.right&&e.bottom>t.top&&e.top<t.bottom},e}();t.Box=i;var o=function(){function e(e,t,r,n){this.anchor=e,this.corners=t,this.minzoom=r,this.maxzoom=n}return e.prototype.left=function(){return this.corners[0].x},e.prototype.right=function(){return this.corners[2].x},e.prototype.top=function(){return this.corners[1].y},e.prototype.bottom=function(){return this.corners[3].y},e}();t.Obstacle=o;var a=function(){function e(e,t,r){this.obstacles=[],this.mapAngle=e,this.padding=t,this.isScreenAligned=r,this.minzoom=s}return e.prototype.addBox=function(e,t,n,i,a,s,u){var l=t.left*n-this.padding,c=t.top*n-this.padding,f=t.right*n+this.padding,h=t.bottom*n+this.padding,p=[new r.Point(l,c),new r.Point(f,c),new r.Point(f,h),new r.Point(l,h)];if(0!==this.mapAngle){var d=Math.cos(this.mapAngle),v=Math.sin(this.mapAngle);(e=e.clone()).rotate(d,v)}if(this.isScreenAligned||(i+=this.mapAngle),0!==i){d=Math.cos(i),v=Math.sin(i);p[0].rotate(d,v),p[1].rotate(d,v),p[2].rotate(d,v),p[3].rotate(d,v);for(var y=0,m=1;m<4;m++)p[m].x<p[y].x?y=m:p[m].x===p[y].x&&p[m].y<p[y].y&&(y=m);if(y){var g=[];for(m=0;m<4;m++)g.push(p[(m+y)%4]);p=g}}if(a)for(var x=0,_=p;x<_.length;x++){_[x].move(a[0],a[1])}this.obstacles.push(new o(e,p,s,u))},e}();t.Footprint=a;var s=.5,u=function(){function e(){this._grid=[]}return e.prototype.setAngle=function(e){},e.prototype.reset=function(){this._grid=[]},e.prototype.add=function(t){for(var r=this._grid,n=0,i=t.obstacles;n<i.length;n++)for(var o=i[n],a=o.anchor,s=e._gridClamp(Math.min(o.left()+a.x,a.x)),u=e._gridClamp(Math.max(o.right()+a.x,a.x)),l=e._gridClamp(Math.min(o.top()+a.y,a.y)),c=e._gridClamp(Math.max(o.bottom()+a.y,a.y)),f=l;f<=c;f++)for(var h=s;h<=u;h++){var p=r[16*f+h];p||(p=r[16*f+h]=[]),p.push(o)}},e.prototype.getMinZoom=function(t,r,i,o){if(0===t.obstacles.length)return n.C_INFINITY;for(var a=r,s=this._grid,u=0,l=t.obstacles;u<l.length;u++)for(var c=l[u],f=c.anchor,h=e._gridClamp(Math.min(c.left()+f.x,f.x)),p=e._gridClamp(Math.max(c.right()+f.x,f.x)),d=e._gridClamp(Math.min(c.top()+f.y,f.y)),v=e._gridClamp(Math.max(c.bottom()+f.y,f.y)),y=d;y<=v;y++)for(var m=h;m<=p;m++){var g=s[16*y+m];if(g)for(var x=0,_=g;x<_.length;x++){var b=_[x];if(!(c.minzoom>=b.maxzoom||b.minzoom>=c.maxzoom)&&(a=e._calcPlacementZoom(c,b,a))>=2)return n.C_INFINITY}}return a<2?a:n.C_INFINITY},e._gridClamp=function(e){return n.clamp(e>>9,-7,8)},e._calcPlacementZoom=function(t,r,i){var o=r.anchor.x-t.anchor.x;if(0===o&&(t.right()<r.left()||r.right()<t.left()))return i;var a=r.anchor.y-t.anchor.y;if(0===a&&(t.bottom()<r.top()||r.bottom()<t.top()))return i;var s=n.C_INFINITY;if(0!==o){var u=(o>0?t.right()-r.left():t.left()-r.right())/o;u<s&&(s=u);var l=o>0?e._calcExtZoomX(t,r,u):e._calcExtZoomX(r,t,u);l<s&&(s=l)}if(0!==a){var c=(a>0?t.bottom()-r.top():t.top()-r.bottom())/a;c<s&&(s=c);var f=a>0?e._calcExtZoomY(t,r,c):e._calcExtZoomY(r,t,c);f<s&&(s=f)}return s<t.minzoom||s<r.minzoom?i:((s=Math.min(s,t.maxzoom,r.maxzoom))<i&&(s=i),s)},e._calcExtZoomX=function(e,t,r){var n,i,o,a;if(e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[0].y/r){var s=e.corners[2].x-e.corners[3].x,u=e.corners[2].y-e.corners[3].y,l=t.corners[1].x-t.corners[0].x;s*(t.corners[1].y-t.corners[0].y)-u*l>=0?e.anchor.y+e.corners[3].y/r<t.anchor.y+t.corners[0].y/r?(n=e.corners[3],i=t.corners[0],o=t.corners[1],a=1):(n=t.corners[0],i=e.corners[3],o=e.corners[2],a=-1):e.anchor.y+e.corners[2].y/r>t.anchor.y+t.corners[1].y/r?(n=e.corners[2],i=t.corners[0],o=t.corners[1],a=1):(n=t.corners[1],i=e.corners[3],o=e.corners[2],a=-1)}else{s=e.corners[2].x-e.corners[1].x,u=e.corners[2].y-e.corners[1].y,l=t.corners[3].x-t.corners[0].x;s*(t.corners[3].y-t.corners[0].y)-u*l<0?e.anchor.y+e.corners[1].y/r>t.anchor.y+t.corners[0].y/r?(n=e.corners[1],i=t.corners[0],o=t.corners[3],a=1):(n=t.corners[0],i=e.corners[1],o=e.corners[2],a=-1):e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[3].y/r?(n=e.corners[2],i=t.corners[0],o=t.corners[3],a=1):(n=t.corners[3],i=e.corners[1],o=e.corners[2],a=-1)}var c=o.x-i.x,f=o.y-i.y;return a*((n.y-i.y)*c-(n.x-i.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*c)},e._calcExtZoomY=function(e,t,r){var n,i,o,a;if(e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[1].x/r){var s=e.corners[3].x-e.corners[2].x,u=e.corners[3].y-e.corners[2].y,l=t.corners[0].x-t.corners[1].x;s*(t.corners[0].y-t.corners[1].y)-u*l<0?e.anchor.x+e.corners[2].x/r<t.anchor.x+t.corners[1].x/r?(n=e.corners[2],i=t.corners[1],o=t.corners[0],a=1):(n=t.corners[1],i=e.corners[2],o=e.corners[3],a=-1):e.anchor.x+e.corners[3].x/r>t.anchor.x+t.corners[0].x/r?(n=e.corners[3],i=t.corners[1],o=t.corners[0],a=1):(n=t.corners[0],i=e.corners[2],o=e.corners[3],a=-1)}else{s=e.corners[3].x-e.corners[0].x,u=e.corners[3].y-e.corners[0].y,l=t.corners[2].x-t.corners[1].x;s*(t.corners[2].y-t.corners[1].y)-u*l>0?e.anchor.x+e.corners[0].x/r>t.anchor.x+t.corners[1].x/r?(n=e.corners[0],i=t.corners[1],o=t.corners[2],a=1):(n=t.corners[1],i=e.corners[0],o=e.corners[3],a=-1):e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[2].x/r?(n=e.corners[3],i=t.corners[1],o=t.corners[2],a=1):(n=t.corners[2],i=e.corners[0],o=e.corners[3],a=-1)}var c=o.x-i.x,f=o.y-i.y;return a*((n.y-i.y)*c-(n.x-i.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*c)},e}();t.ConflictEngine=u}.apply(null,n))||(e.exports=i)},2258:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1909),r(512),r(8),r(1553),r(1812),r(1910),r(1911),r(2259),r(1908),r(1912),r(2260),r(1914)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,f,h,p){return function(){function e(e,t,r){this._pbfTile=new n(new Uint8Array(e),new DataView(e)),this._tile=t,this._connection=r,this._layers=t.getLayers();var i=t.tileKey.split("/").map(parseFloat),a=i[0],s=i[1],u=i[2];if(this._level=a,t.refKey){var l=a-t.refKey.split("/").map(parseFloat)[0];if(l>0){var c=(1<<l)-1,f=s&c,h=u&c;this._tileClipper=new o.TileClipper(l,f,h)}}this._tileClipper||(this._tileClipper=new o.SimpleBuilder)}return e.prototype.parse=function(){for(var e,t=this,n=this._parseTileData(this._pbfTile),o=this._layers,s=o.length,u=this._level,c=[],f={},h=new Set,p=s-1;p>=0;p--)if(!((e=o[p]).minzoom&&u<e.minzoom||e.maxzoom&&u>=e.maxzoom||e.layout&&"none"===e.layout.visibility))if(0!==e.type){var d=e.sourceLayer,v=n[d];if(v)if(h.add(d),m=this._createBucket(e)){m.layerIndex=p,m.layerExtent=v.extent;var y=f[d];y||(y=f[d]=[]),y.push(m)}}else{var m;(m=this._createBucket(e)).layerIndex=p,c.push(m)}var g=10*this._level,x=10*(this._level+1),_=[],b=[],I=[],w=[],C=this._tileClipper,P=new Set,T={},S=[];h.forEach(function(e){return S.push(e)});var D=0,A=0,M=S.length;return r(function(){if(t._tile.status===a.TileStatus.INVALID)return!0;switch(D){case 0:if(A<M){var e=S[A++],r=n[e];if(!(v=f[e])||0===v.length)break;for(var i=r.getData();i.next(2);){var o=new l(i.getMessage(),r),s=o.values;if(s){var u=s._minzoom;if(u&&u>=x)continue;var c=s._maxzoom;if(c&&c<=g)continue}for(var h=0,p=v;h<p.length;h++){(E=p[h]).pushFeature(o)}}}else{var d=t._tile;for(var e in f)for(var v,y=0,m=v=f[e];y<m.length;y++){var E;(E=m[y]).hasFeatures()&&(3===E.layer.type?(_.push(E),d.addBucket(E)):E.layer.refLayerId?I.push(E):(b.push(E),w[E.layer.id]=E))}D=1,A=0,M=_.length}break;case 1:A<M?_[A++].getResources(C,P,T):D=2}return 2===D}).then(function(){if(t._tile.status===a.TileStatus.INVALID)return[];var e,n,o=[],s=t._tile.getWorkerTileHandler();for(var u in P.size>0&&(e=s.fetchSprites(P,t._connection),o.push(e)),T){var l=T[u];l.size>0&&(n=s.fetchGlyphs(t._tile.tileKey,u,l,t._connection),o.push(n))}return i.all(o).then(function(e){if(t._tile.status===a.TileStatus.INVALID)return[];var n=0,i=0,o=b.length;return r(function(){if(t._tile.status===a.TileStatus.INVALID)return!0;switch(n){case 0:if(i<o)(s=b[i++]).processFeatures(C,t._tile),c.push(s);else n=1,i=0,o=I.length;break;case 1:for(var e=0,r=I;e<r.length;e++){var s=r[e],u=w[s.layer.refLayerId];u&&(u.assignBufferInfo(s),c.push(s))}n=2,i=0,o=_.length;break;case 2:if(i<o)(s=_[i++]).processFeatures(C,t._tile),c.push(s);else n=3}return 3===n}).then(function(){return c.sort(function(e,t){return e.layerIndex-t.layerIndex}),c})}).catch(function(e){return i.reject(new Error(e))})}).catch(function(e){return i.reject(new Error(e))})},e.prototype._parseTileData=function(e){for(var t={};e.next();)switch(e.tag()){case 3:var r=new h(e.getMessage());t[r.name]=r;break;default:e.skip()}return t},e.prototype._createBucket=function(e){switch(e.type){case 0:return this._createBackgroundBucket(e);case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}},e.prototype._createBackgroundBucket=function(e){return new s(e,this._level)},e.prototype._createFillBucket=function(e){var t=this._tile;return new c(e,this._level,e.hasDataDrivenFill?t.fillDDVertexBuffer:t.fillVertexBuffer,t.fillIndexBuffer,e.hasDataDrivenOutline?t.outlineDDVertexBuffer:t.outlineVertexBuffer,t.outlineIndexBuffer)},e.prototype._createLineBucket=function(e){var t=this._tile;return new f(e,this._level,e.hasDataDrivenLine?t.lineDDVertexBuffer:t.lineVertexBuffer,t.lineIndexBuffer)},e.prototype._createCircleBucket=function(e){var t=this._tile;return new u(e,this._level,t.circleVertexBuffer,t.circleIndexBuffer)},e.prototype._createSymbolBucket=function(e){var t=this._tile;return new p(e,this._level,e.hasDataDrivenIcon?t.iconDDVertexBuffer:t.iconVertexBuffer,t.iconIndexBuffer,e.hasDataDrivenText?t.textDDVertexBuffer:t.textVertexBuffer,t.textIndexBuffer,t.placementEngine,t.getWorkerTileHandler())},e}()}.apply(null,n))||(e.exports=i)},2259:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1529)],void 0===(i=function(e,t,r){return function(){function e(e,t){this.values={};for(var r=t.keys,n=t.values;e.next();)switch(e.tag()){case 1:this.id=e.getUInt64();break;case 2:for(var i=e.getMessage(),o=this.values;!i.empty();){var a=i.getUInt32(),s=i.getUInt32();o[r[a]]=n[s]}break;case 3:this.type=e.getUInt32();break;case 4:this._pbfGeometry=e.getMessage();break;default:e.skip()}}return e.prototype.getGeometry=function(e){if(void 0!==this._geometry)return this._geometry;var t,n,i,o=this._pbfGeometry;e?e.reset(this.type):t=[];for(var a=1,s=0,u=0,l=0;!o.empty();){if(0===s){var c=o.getUInt32();a=7&c,s=c>>3}switch(s--,a){case 1:u+=o.getSInt32(),l+=o.getSInt32(),e?e.moveTo(u,l):(n&&t.push(n),(n=[]).push(new r.Point(u,l)));break;case 2:u+=o.getSInt32(),l+=o.getSInt32(),e?e.lineTo(u,l):n.push(new r.Point(u,l));break;case 7:e?e.close():n&&!n[0].equals(u,l)&&n.push(n[0].clone());break;default:throw new Error("Invalid path operation")}}return e?i=e.result():(n&&t.push(n),i=t),this._geometry=i,i},e}()}.apply(null,n))||(e.exports=i)},2260:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(t){for(this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(e._parseValue(t.getMessage()));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return e.prototype.getData=function(){return this._pbfLayer},e._parseValue=function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null},e}()}.apply(null,n))||(e.exports=i)},2261:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(25),r(1),r(1402),r(1704)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var a=new Float32Array(1),s=new Uint32Array(a.buffer),u=function(e){function t(t){var r=e.call(this,t?20:12)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,n,i,u,l,c){var f=this.array,h=o.i1616to32(e,t);if(f.push(h),h=o.i8888to32(Math.round(31*r),Math.round(31*n),Math.round(31*i),Math.round(31*u)),f.push(h),h=o.i1616to32(l,0),f.push(h),this._isDataDriven){if(!c)throw new Error("Expecting data driven values.");var p=c.color,d=p[3]*c.opacity*255;f.push(o.i8888to32(p[0]*d,p[1]*d,p[2]*d,d)),a[0]=c.size,f.push(s[0])}},t}(o);t.LineVertexBuffer=u;var l=function(e){function t(t){var r=e.call(this,t?8:4)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r){var n=this.array;if(n.push(o.i1616to32(e,t)),this._isDataDriven){if(!r)throw new Error("Expecting data driven values.");var i=r.color,a=i[3]*r.opacity*255;n.push(o.i8888to32(i[0]*a,i[1]*a,i[2]*a,a))}},t}(o);t.FillVertexBuffer=l;var c=function(e){function t(t){var r=e.call(this,t?12:8)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,n,i,a,s){var u=this.array,l=this.index,c=o.i1616to32(e,t);if(u.push(c),c=o.i8888to32(Math.round(15*r),Math.round(15*n),i,a),u.push(c),this._isDataDriven){if(!s)throw new Error("Expecting data driven values.");var f=s.color,h=f[3]*s.opacity*255;u.push(o.i8888to32(f[0]*h,f[1]*h,f[2]*h,h))}return l},t}(o);t.OutlineVertexBuffer=c;var f=function(e){function t(t){var r=e.call(this,t?24:16)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,n,u,l,c,f,h,p,d){var v=this.array,y=o.i1616to32(e,t);if(v.push(y),y=o.i1616to32(Math.round(8*r),Math.round(8*n)),v.push(y),y=o.i8888to32(u/4,l/4,0,0),v.push(y),y=o.i8888to32(Math.ceil(10*p),i.radToByte(c),10*f,Math.min(10*h,255)),v.push(y),this._isDataDriven){if(!d)throw new Error("Expecting data driven values.");var m=d.color,g=m[3]*d.opacity*255;v.push(o.i8888to32(m[0]*g,m[1]*g,m[2]*g,g)),a[0]=d.size,v.push(s[0])}},t}(o);t.SymbolVertexBuffer=f;var h=function(e){function t(){return e.call(this,16)||this}return r(t,e),t.prototype.add=function(e,t,r,n,i,a,s,u,l,c,f){var h=this.array,p=o.i1616to32(2*e+r,2*t+n);h.push(p);var d=a[3]*s*255;p=o.i8888to32(a[0]*d,a[1]*d,a[2]*d,d),h.push(p);var v=c[3]*f*255;p=o.i8888to32(c[0]*v,c[1]*v,c[2]*v,v),h.push(p),p=o.i8888to32(Math.min(32*u,255),Math.min(4*l,255),Math.min(i,255),0),h.push(p)},t}(o);t.CircleVertexBuffer=h}.apply(null,n))||(e.exports=i)},2262:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(8)],void 0===(i=function(e,t,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.createProcessor=function(e,t){var o;return"heatmap"===e?o=i.create(function(e){return r.e(64).then(function(){var t=[r(2358)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"symbol"===e&&(o=i.create(function(e){return Promise.all([r.e(9),r.e(13),r.e(65)]).then(function(){var t=[r(2359)];e.apply(null,t)}.bind(this)).catch(r.oe)})),o.then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,i=t.remoteClient,o=t.tileStore;return new e(n({},r,{tileStore:o,remoteClient:i}))})}}.apply(null,n))||(e.exports=i)},525:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(158),r(476),r(90),r(1826),r(32),r(36),r(9),r(16),r(4),r(8),r(22),r(1716),r(59),r(28),r(261),r(253),r(1676),r(1705),r(97)],void 0===(i=function(e,t,r,n,i,o,a,s,u,l,c,f,h,p,d,v,y,m,g,x,_){Object.defineProperty(t,"__esModule",{value:!0});var b=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];t.csvLatitudeFieldNames=["lat","latitude","y","ycenter","latitude83","latdecdeg","point-y"],t.csvLongitudeFieldNames=["lon","lng","long","longitude","x","xcenter","longitude83","longdecdeg","point-x"],t.csvDetectedDelimiters=[","," ",";","|","\t"];var I=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,w=[0,0],C=function(){return function(e,t){this.x=e,this.y=t}}(),P=function(){var e=i._parseInfo(),t=new RegExp("^"+e.regexp+"$"),r=new RegExp("["+e.group+"\\s\\xa0]","g"),n=e.factor;return function(i){var o=t.exec(i);if(e.factor=n,!o)return NaN;var a=o[1];if(!o[1]){if(!o[2])return NaN;a=o[2],e.factor*=-1}return+(a=a.replace(r,"").replace(e.decimal,"."))*e.factor}}(),T=function(){function e(){this._queryEngine=null}return e.prototype.load=function(e){var t=this;return f.all([this._fetch(e.url),this._checkProjection(e)]).then(function(r){var n=r[0],i=t._parse(n,e.parsing);return t._queryEngine=t._createQueryEngine(n,i),i.layerDefinition.extent=t._queryEngine.fullExtent,i})},e.prototype.applyEdits=function(e){return f.reject(new u("csv-source:editing-not-supported","applyEdits() is not supported on CSVLayer"))},e.prototype.queryFeatures=function(e){return void 0===e&&(e={}),this._queryEngine.executeQuery(_.fromJSON(e))},e.prototype.queryFeatureCount=function(e){return void 0===e&&(e={}),this._queryEngine.executeQueryForCount(_.fromJSON(e))},e.prototype.queryObjectIds=function(e){return void 0===e&&(e={}),this._queryEngine.executeQueryForIds(_.fromJSON(e))},e.prototype.queryExtent=function(e){return void 0===e&&(e={}),this._queryEngine.executeQueryForExtent(_.fromJSON(e))},e.prototype._fetch=function(e){if(!e)return f.reject(new u("csv-source:invalid-source","url not defined"));var t=h.urlToObject(e);return s(t.path,{query:t.query,responseType:"text"}).then(function(e){return e.data})},e.prototype._parse=function(e,t){void 0===t&&(t={});for(var r={columnDelimiter:t.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}};e&&"\n"===e[0];)e=e.slice(1);"\n"!==e[e.length-1]&&(e+="\n");var n=this._readFirstLine(e);if(!n)throw new u("csv","CSV is empty",{csv:e});if(!t.columnDelimiter){var i=this._inferDelimiter(n);if(!i)throw new u("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");r.columnDelimiter=i}var o=n.split(r.columnDelimiter),a=r.layerDefinition={name:"csv",geometryType:"esriGeometryPoint",objectIdField:null,fields:[],extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){var s=this._inferLocationInfo(o);if(!t.longitudeField&&!s.longitudeFieldName||!t.latitudeField&&!s.latitudeFieldName)throw new u("csv","Unable to identify latitudeField and/or longitudeField from CSV");r.locationInfo={longitudeFieldName:t.longitudeField||s.longitudeFieldName,latitudeFieldName:t.latitudeField||s.latitudeFieldName}}var l=this._inferFields(e,r.columnDelimiter,o,r.locationInfo);if(t.fields&&t.fields.length){for(var f=new Map,h=0,p=t.fields;h<p.length;h++){var d=p[h];f.set(d.name.toLowerCase(),d)}for(var v=0,y=l;v<y.length;v++){d=y[v];var m=f.get(d.name.toLowerCase());if(m){var g=d.name;c.mixin(d,m),d.name=g}}}return a.fields=l,a.fields.some(function(e){return"esriFieldTypeOID"===e.type&&(a.objectIdField=e.name,!0)})||(a.objectIdField="__OBJECTID",a.fields.unshift({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1})),r},e.prototype._inferLocationInfo=function(e){var r=null,n=null;return e.forEach(function(e){var i=e.toLowerCase();-1===t.csvLatitudeFieldNames.indexOf(i)||n||(n=e),-1===t.csvLongitudeFieldNames.indexOf(i)||r||(r=e)}),{longitudeFieldName:r,latitudeFieldName:n}},e.prototype._inferFields=function(e,t,r,n){for(var i=[],o=this._sampleLines(e).map(function(e){return e.split(t).map(function(e){return e.trim()})}),a=this,s=0;s<r.length;s++)!function(e){var t=r[e];if(t===n.longitudeFieldName||t===n.latitudeFieldName)i.push({name:t,type:"esriFieldTypeDouble",alias:t});else{var s=o.map(function(t){return t[e]}),u=a._inferFieldType(s),l={name:t.replace(/[\s\'’‘\.\-\/\(\)]+/g,"_"),type:null,alias:t};switch(u){case"integer":l.type="esriFieldTypeInteger";break;case"double":l.type="esriFieldTypeDouble";break;case"date":l.type="esriFieldTypeDate",l.length=36;break;default:l.type="esriFieldTypeString",l.length=255}i.push(l)}}(s);return i},e.prototype._inferFieldType=function(e){var t=this;if(!e.length)return"string";var r=/[^+-.,0-9]/;return e.map(function(e){var n=!1;if(""===e||r.test(e))n=!0;else{var i=P(e);if(!isNaN(i))return/[.,]/.test(e)?"double":i>214783647||i<-214783648?"double":"integer";if(-1===e.indexOf("E"))n=!0;else{if(i=Number(e),!isNaN(i))return"double";if(-1===e.indexOf(","))n=!0;else{if(e=e.replace(",","."),i=Number(e),!isNaN(i))return"double";n=!0}}}if(n){if(/^[-]?\d*[.,]?\d*$/.test(e))return"string";var o=new Date(e);return t._isValidDate(o,e)?"date":"string"}return"string"}).reduce(function(e,t){return e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0})},e.prototype._isValidDate=function(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var r=!0;if(l("chrome")&&/\d+\W*$/.test(t)){var n=t.match(/[a-zA-Z]{2,}/);if(n){for(var i=!1,o=0;!i&&o<=n.length;)i=!I.test(n[o]),o++;r=!i}}return r},e.prototype._readFirstLine=function(e){return e.substring(0,e.indexOf("\n")).trim()},e.prototype._sampleLines=function(e,t){void 0===t&&(t=10);for(var r=!1,n=[],i=e.indexOf("\n")+1;!r&&n.length<t;){var o=e.indexOf("\n",i);if(-1!==o){var a;(a=-1===o&&i<e.length-1?e.substring(i).trim():e.substring(i,o).trim())&&n.push(a),i=o+1}else r=!0}return n},e.prototype._inferDelimiter=function(e){var r=0,n="";return t.csvDetectedDelimiters.forEach(function(t){var i=e.split(t).length;i>r&&(r=i,n=t)}),""===n?null:n},e.prototype._createQueryEngine=function(e,t){for(var r,i=t.locationInfo,s=i.latitudeFieldName,u=i.longitudeFieldName,l=t.layerDefinition,c=l.objectIdField,f=l.fields,h=l.extent,_=[],I=[],T=new n.Set,S=new n.Set,D=[],A=0,M=f;A<M.length;A++){var E=M[A],B=E.name,N=E.type;"esriFieldTypeDate"===N?T.add(B):b.indexOf(N)>-1&&S.add(B),B!==c&&D.push(B)}var V=new o;V.delimiter=t.columnDelimiter,V.fieldNames=D,V.newline="\n";var O=V.parse(e),L=0;O.shift();for(var F=0,z=O;F<z.length;F++){var R=z[F],j=this._parseCoordinateValue(R[s]),k=this._parseCoordinateValue(R[u]);if(null!=k&&null!=j&&!isNaN(j)&&!isNaN(k)){for(var U in R[s]=j,R[u]=k,R)if(U!==s&&U!==u)if(T.has(U)){var Y=new Date(R[U]);R[U]=this._isValidDate(Y,R[U])?Y.getTime():null}else if(S.has(U)){var G=P(R[U]);isNaN(G)?R[U]=null:R[U]=G}R[c]=L,L++,_.push(new C(k,j)),I.push(R)}}if(!d.equals({wkid:4326},h.spatialReference))if(d.isWebMercator(h.spatialReference))for(var q=0,Q=_;q<Q.length;q++){var Z=Q[q];r=v.lngLatToXY(Z.x,Z.y,w),Z.x=r[0],Z.y=r[1]}else _=p.projectMany(_,a.SpatialReference.WGS84,h.spatialReference,null,!0);for(var J=new g.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1}),X=new x.default({fields:t.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,objectIdField:c,spatialReference:h.spatialReference||{wkid:4326},cacheSpatialQueries:!0,spatialIndex:J}),H=[],W=0;W<_.length;W++){var K=_[W],$=K.x,ee=K.y,te=I[W];te[c]=W+1,H.push(new y.default(new m.default([],[$,ee]),te,null,te[c]))}return J.addMany(H),X},e.prototype._parseCoordinateValue=function(e){if(null==e||""===e)return null;var t=P(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t},e.prototype._checkProjection=function(e){if(!e||!e.parsing||!e.parsing.spatialReference)return f.resolve();var t=e.parsing&&e.parsing.spatialReference;return!t||v.canProject(a.SpatialReference.WGS84,t)?f.resolve():p.isSupported()?p.load():f.reject(new u("csv-layer","Projection not supported"))},e}();t.default=T}.apply(null,n))||(e.exports=i)}}]);