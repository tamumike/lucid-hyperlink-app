(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/webgl/BufferObject":1360,"esri/views/3d/support/buffer/typedArrayUtil":1378,"esri/core/HandleOwner":1393,"esri/views/vectorTiles/GeometryUtils":1402,"esri/views/2d/engine/webgl/definitions":1403,"esri/views/2d/engine/DisplayObject":1411,"esri/views/layers/RefreshableLayerView":1412,"esri/views/layers/LayerView":1413,"esri/views/2d/engine/Container":1425,"esri/views/2d/engine/Evented":1434,"esri/views/2d/layers/LayerView2D":1456,"esri/views/2d/engine/webgl/Rect":1526,"esri/views/2d/engine/webgl/Geometry":1529,"esri/views/2d/engine/webgl/GeometryUtils":1532,"esri/views/2d/engine/webgl/WGLDisplayList":1534,"esri/views/2d/layers/features/support/Tile":1549,"esri/views/2d/engine/webgl/TileClipper":1553,"esri/views/2d/support/Evented":1555,"esri/views/2d/engine/BitmapContainer":1606,"esri/views/2d/engine/webgl/WGLRendererInfo":1618,"esri/views/2d/engine/webgl/TileData":1619,"esri/views/2d/engine/webgl/MemoryRequirements":1620,"esri/views/2d/engine/webgl/TileBufferData":1621,"esri/views/2d/engine/webgl/TileDisplayData":1622,"esri/views/2d/engine/webgl/util/Reader":1623,"esri/views/2d/engine/webgl/WGLTile":1625,"esri/views/2d/engine/webgl/DirtyMap":1626,"esri/views/2d/engine/webgl/DisplayRecordStore":1627,"esri/views/2d/engine/webgl/FreeList":1628,"esri/views/2d/engine/webgl/Fader":1629,"esri/views/2d/engine/webgl/WGLBuffers":1630,"esri/views/2d/layers/features/support/TileStore":1633,"esri/views/2d/engine/Bitmap":1642,"esri/views/2d/engine/webgl/util/iterator":1652,"esri/views/2d/layers/support/GraphicsView2D":1662,"esri/views/2d/engine/webgl/GraphicContainer":1663,"esri/views/2d/engine/webgl/TextShaping":1666,"esri/views/2d/engine/webgl/LineTess":1667,"esri/views/2d/layers/graphics/GraphicProcessingQueue":1669,"esri/views/2d/layers/graphics/GraphicStore":1670,"esri/views/2d/layers/graphics/GraphicStoreItem":1671,"esri/views/layers/GraphicsView":1672,"esri/views/2d/layers/KMLLayerView2D":2382})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1360:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(16),i(1378)],void 0===(n=function(e,t,i,r){return function(){function e(t,r,n,o,s){this._context=null,this._glName=null,this._bufferType=void 0,this._usage=35044,this._size=-1,this._indexType=void 0,this._context=t,this._bufferType=r,this._usage=n,this._id=e._nextId++,this._glName=this._context.gl.createBuffer(),i("esri-webgl-debug")&&t.instanceCounter.incrementCount(1),o&&this.setData(o,s)}return e.createIndex=function(t,i,r,n){return new e(t,34963,i,r,n)},e.createVertex=function(t,i,r){return new e(t,34962,i,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),i("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(1),this._context=null)},e.prototype.setData=function(e,t){if(e){if("number"==typeof e){if(e<0&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&t)switch(this._indexType=t,this._size=e,t){case 5123:e*=2;break;case 5125:e*=4}}else{var i=e.byteLength;r.isUint16Array(e)&&(i/=2,this._indexType=5123),r.isUint32Array(e)&&(i/=4,this._indexType=5125),this._size=i}var n=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this),this._context.gl.bufferData(this._bufferType,e,this._usage),this._context.bindVAO(n)}},e.prototype.setSubData=function(e,t,i,n){if(void 0===t&&(t=0),void 0===i&&(i=0),e){(t<0||t>=this._size)&&console.error("offset is out of range!");var o=t,s=i,a=n,l=e.byteLength;r.isUint16Array(e)&&(l/=2,o*=2,s*=2,a*=2),r.isUint32Array(e)&&(l/=4,o*=4,s*=4,a*=4),void 0===n&&(n=l-1),i>=n&&console.error("end must be bigger than start!"),t+i-n>this._size&&console.error("An attempt to write beyond the end of the buffer!");var h=this._context.getBoundVAO();this._context.bindVAO(null),this._context.bindBuffer(this);var u=this._context.gl,c=ArrayBuffer.isView(e)?e.buffer:e;u.bufferSubData(this._bufferType,o,c.slice(s,a)),this._context.bindVAO(h)}},e._nextId=0,e}()}.apply(null,r))||(e.exports=n)},1378:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=function(e,t){if(e.forEach)e.forEach(t);else for(var i=0;i<e.length;i++)t(e[i],i,e)},t.slice=function(e,t,i){if(e.slice)return e.slice(t,i);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===i?i=e.length:(i<0&&(i+=e.length),i=Math.min(e.length,Math.max(0,i)));for(var r=Math.max(0,i-t),n=new(0,e.constructor)(r),o=0;o<r;o++)n[o]=e[t+o];return n},t.isArrayBuffer=function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name},t.isInt8Array=function(e){return e instanceof Int8Array||e&&e.constructor&&"Int8Array"===e.constructor.name},t.isUint8Array=function(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name},t.isInt16Array=function(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name},t.isUint16Array=function(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name},t.isInt32Array=function(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name},t.isUint32Array=function(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name},t.isFloat32Array=function(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name},t.isFloat64Array=function(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name},t.toArray=function(e){for(var t=new Array(e.length),i=0;i<e.length;i++)t[i]=e[i];return t}}.apply(null,r))||(e.exports=n)},1393:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(5),i(14),i(0)],void 0===(n=function(e,t,i,r,n,o,s){return function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.call(this)||this;return r.handles=new o,r}return i(t,e),t.prototype.destroy=function(){this.handles.destroy()},r([s.property({readOnly:!0})],t.prototype,"handles",void 0),r([s.subclass("esri.core.HandleOwner")],t)}(s.declared(n))}.apply(null,r))||(e.exports=n)},1402:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){function i(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var r=1/Math.LN2;t.positiveMod=i,t.radToByte=function(e){return i(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return i(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*r},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}}.apply(null,r))||(e.exports=n)},1403:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=32,t.COLLISION_BOX_PADDING=8,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0}.apply(null,r))||(e.exports=n)},1411:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(1434)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderRequestedCalled=!1,t._attached=!1,t._isReady=!1,t._opacity=1,t.renderRequested=!1,t._visible=!0,t}return i(t,e),Object.defineProperty(t.prototype,"attached",{get:function(){return this._attached},set:function(e){this._attached!==e&&(this._attached=e,e?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"opacity",{get:function(){return this._opacity},set:function(e){this._opacity!==e&&(this._opacity=e,this.requestRender())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!==e&&(this._visible=e,this.requestRender())},enumerable:!0,configurable:!0}),t.prototype.attach=function(){return this.ready(),!0},t.prototype.detach=function(){},t.prototype.processRender=function(e){this.visible&&this.attached&&(this._renderRequestedCalled=!1,this.doRender(e),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))},t.prototype.requestRender=function(){var e=this.renderRequested;this._renderRequestedCalled=!0,this.renderRequested=!0,this.parent&&this.parent.requestChildRender(this),e!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")},t.prototype.dispose=function(){},t.prototype.ready=function(){this._isReady=!0,this.hasEventListener("isReady")&&this.emit("isReady")},t}(r.Evented);t.DisplayObject=n}.apply(null,r))||(e.exports=n)},1412:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(5),i(0)],void 0===(n=function(e,t,i,r,n,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refreshTimestamp=null,t}return i(t,e),t.prototype.refresh=function(e){void 0===e&&(e=Date.now()),this._set("refreshTimestamp",e),this.doRefresh&&this.doRefresh()},r([o.property()],t.prototype,"layer",void 0),r([o.aliasOf("layer.refreshInterval")],t.prototype,"refreshInterval",void 0),r([o.property({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),r([o.subclass("esri.layers.mixins.RefreshableLayerView")],t)}(o.declared(n))}.apply(null,r))||(e.exports=n)},1413:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(27),i(1393),i(121),i(7),i(159),i(8),i(0)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h,u){return function(e){function t(t){var i=e.call(this)||this;return i.layer=null,i.parent=null,i.view=null,i}return i(t,e),t.prototype.initialize=function(){var e=this;this.addResolvingPromise(this.layer),this.when().catch(function(t){if("layerview:create-error"!==t.name){var i=e.layer&&e.layer.id||"no id",r=e.layer&&e.layer.title||"no title";return a.getLogger(e.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",t),h.reject(t)}})},t.prototype.destroy=function(){this.layer=this.view=this.parent=null},Object.defineProperty(t.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&this.isUpdating()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullOpacity",{get:function(){var e=function(e){return null!=e?e:1};return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),t.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},t.prototype.isUpdating=function(){return!1},r([u.property()],t.prototype,"layer",void 0),r([u.property()],t.prototype,"parent",void 0),r([u.property({readOnly:!0,dependsOn:["view","visible","layer.loaded","parent.suspended"]})],t.prototype,"suspended",null),r([u.property({type:Boolean,dependsOn:["suspended"],readOnly:!0})],t.prototype,"updating",null),r([u.property()],t.prototype,"view",void 0),r([u.property({dependsOn:["layer.visible"]})],t.prototype,"visible",null),r([u.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],t.prototype,"fullOpacity",null),r([u.subclass("esri.views.layers.LayerView")],t)}(u.declared(o,n,s.Identifiable,l))}.apply(null,r))||(e.exports=n)},1425:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(1411)],void 0===(n=function(e,t,i,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ATTACHING=0]="ATTACHING",e[e.DETACHING=1]="DETACHING",e[e.RENDERING=2]="RENDERING",e[e.DONE=3]="DONE"}(n||(n={}));var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._childrenSet=new Set,t._childrenToAttach=[],t._childrenToDetach=[],t._renderPhase=n.DONE,t.children=[],t}return i(t,e),Object.defineProperty(t.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0}),t.prototype.detach=function(){for(var e=0,t=this.children.concat(this._childrenToDetach);e<t.length;e++){var i=t[e];i.attached&&(this.detachChild(i),i.attached=!1,i.parent=null)}},t.prototype.doRender=function(e){var t=e.globalOpacity;e.globalOpacity*=this.opacity,this._renderPhase=n.ATTACHING,this.attachChildren(),this._renderPhase=n.DETACHING;for(var i=this._childrenToDetach;i.length>0;){var r=i.shift();this.detachChild(r),r.attached=!1,r.parent=null,r.stage=null}this._renderPhase=n.RENDERING,this.renderChildren(e),this._renderPhase=n.DONE,e.globalOpacity=t},t.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.prototype.addChildAt=function(e,t){if(void 0===t&&(t=this.numChildren),!e)return e;if(this.contains(e))return e;var i=e.parent;i&&i!==this&&i.removeChild(e),t>=this.numChildren?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e);var r=this._childrenToDetach.indexOf(e);return r>-1&&this._childrenToDetach.splice(r,1),this._childrenToAttach.push(e),this._renderPhase>=n.RENDERING&&this.requestRender(),e},t.prototype.contains=function(e){return this._childrenSet.has(e)},t.prototype.getChildIndex=function(e){return this.children.indexOf(e)},t.prototype.getChildAt=function(e){return e<0||e>this.children.length?null:this.children[e]},t.prototype.removeAllChildren=function(){for(var e=this.numChildren;e--;)this.removeChildAt(0)},t.prototype.removeChild=function(e){return this.contains(e)?this.removeChildAt(this.getChildIndex(e)):e},t.prototype.removeChildAt=function(e){var t;if(e<0||e>=this.children.length)return null;if(t=this.children.splice(e,1)[0],function(e,t){e.delete(t)}(this._childrenSet,t),t.attached)this._childrenToDetach.push(t),this._renderPhase>=n.RENDERING&&this.requestRender();else{var i=this._childrenToAttach.indexOf(t);i>-1&&this._childrenToAttach.splice(i,1)}return t},t.prototype.requestChildRender=function(e){e&&e.parent===this&&this._renderPhase>=n.RENDERING&&this.requestRender()},t.prototype.setChildIndex=function(e,t){var i=this.getChildIndex(e);i>-1&&(this.children.splice(i,1),this.children.splice(t,0,e),this._renderPhase>=n.RENDERING&&this.requestRender())},t.prototype.sortChildren=function(e){return this._renderPhase>n.RENDERING&&this.requestRender(),this.children.sort(e)},t.prototype.attachChildren=function(){var e=this._childrenToAttach;if(0!==e.length)for(var t=0,i=!1;!i;){var r=e[t];r.parent=this,r.stage=this.stage,this.attachChild(r)?(r.attached=!0,e.splice(t,1)):++t,i=e.length===t}},t.prototype.renderChildren=function(e){for(var t=this.children,i=t.length,r=0;r<i;r++)t[r].processRender(e)},t.prototype.attachChild=function(e){return e.attach()},t.prototype.detachChild=function(e){e.detach()},t}(r.DisplayObject);t.Container=o}.apply(null,r))||(e.exports=n)},1434:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(73),i(52)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.prototype.on=function(e,t){return r.after(this,"on"+e,t,!0)},e.prototype.once=function(e,t){return n.once(this,e,t)},e.prototype.emit=function(e){n.emit(this,e,this)},e.prototype.hasEventListener=function(e){var t="on"+e;return!(!this[t]||!this[t].after)},e}();t.Evented=o,t.EventedMixin=function(e){return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.on=function(e,t){return r.after(this,"on"+e,t,!0)},t.prototype.once=function(e,t){return n.once(this,e,t)},t.prototype.emit=function(e,t){n.emit(this,e,t)},t.prototype.hasEventListener=function(e){var t="on"+e;return!(!this[t]||!this[t].after)},t}(e)}}.apply(null,r))||(e.exports=n)},1456:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(15),i(0),i(1413)],void 0===(n=function(e,t,i,r,n,o,s){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t.lastUpdateId=-1,t.moving=!1,t.updateRequested=!1,t}return i(t,e),t.prototype.initialize=function(){var e=this;this.when(function(){e.requestUpdate()}),n.init(this,"suspended",function(t){e.container.visible=!t,!t&&e.updateRequested&&e.view.requestLayerViewUpdate(e)},!0),n.init(this,"fullOpacity",function(t){e.container.opacity=t},!0);var t=function(){this.notifyChange("rendering")}.bind(this);this.container.on("post-render",t),this.container.on("will-render",t)},t.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.updateRequested=!1,this.layer=null},Object.defineProperty(t.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),t.prototype.isVisibleAtScale=function(e){var t=!0,i=this.layer,r=i.minScale,n=i.maxScale;if(null!=r&&null!=n){var o=!r,s=!n;!o&&e<=r&&(o=!0),!s&&e>=n&&(s=!0),t=o&&s}return t},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},t.prototype.processUpdate=function(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1},t.prototype.isUpdating=function(){return!1},t.prototype.isRendering=function(){return!1},t.prototype.canResume=function(){var e=this.inherited(arguments);return e&&(e=this.isVisibleAtScale(this.view.scale)),e},r([o.property()],t.prototype,"attached",void 0),r([o.property()],t.prototype,"container",void 0),r([o.property()],t.prototype,"moving",void 0),r([o.property({dependsOn:["attached","suspended","moving"]})],t.prototype,"rendering",null),r([o.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),r([o.property({readOnly:!0})],t.prototype,"updateParameters",void 0),r([o.property()],t.prototype,"updateRequested",void 0),r([o.property({dependsOn:["updateRequested","attached"]})],t.prototype,"updating",null),r([o.property()],t.prototype,"view",void 0),r([o.subclass("esri.views.2d.layers.LayerView2D")],t)}(o.declared(s))}.apply(null,r))||(e.exports=n)},1526:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e,t,i,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,r))||(e.exports=n)},1529:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);this.x/=i,this.y/=i},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var i=this.x,r=this.y;this.x=i*e-r*t,this.y=i*t+r*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},e.add=function(t,i){return new e(t.x+i.x,t.y+i.y)},e.sub=function(t,i){return new e(t.x-i.x,t.y-i.y)},e}();t.Point=i}.apply(null,r))||(e.exports=n)},1532:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var i=1/Math.LN2;function r(e,t){return 0<=(e%=t)?e:e+t}t.positiveMod=r,t.radToByte=function(e){return r(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return r(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*i},t.sqr=function(e){return e*e},t.clamp=function(e,t,i){return Math.min(Math.max(e,t),i)},t.interpolate=function(e,t,i){return e*(1-i)+t*i},t.between=function(e,t,i){return t<=e&&e<=i||i<=e&&e<=t}}.apply(null,r))||(e.exports=n)},1534:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(158),i(7),i(1379),i(1661),i(1375)],void 0===(n=function(e,t,i,r,n,o,s){var a=r.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");function l(e,t,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];t<e.length?e.splice.apply(e,[t,i].concat(r)):e.push.apply(e,r)}var h=new Map;h.set(n.WGLDrawPhase.MAP,[n.WGLGeometryType.FILL,n.WGLGeometryType.LINE,n.WGLGeometryType.MARKER,n.WGLGeometryType.TEXT]),h.set(n.WGLDrawPhase.LABEL,[n.WGLGeometryType.LABEL]),h.set(n.WGLDrawPhase.LABEL_ALPHA,[n.WGLGeometryType.LABEL]);var u=function(){function e(e){void 0===e&&(e=!1),this.symbolLevels=[],this.unified=e}return e.prototype.replay=function(e,t){if(this.unified)for(var i=0,r=this.symbolLevels;i<r.length;i++)for(var n=0,o=r[i].zLevels;n<o.length;n++){var s=o[n].geometryDPInfo;for(var a in s)if(s[a])for(var l=0,u=s[a];l<u.length;l++){var c=u[l];e.painter.getGeometryBrush(c.geometryType).drawGeometry(e,t,c,null)}}else for(var d=function(i){var r=e.painter.getGeometryBrush(i);p.byType(i,function(i){r.drawGeometry(e,t,i,null)})},p=this,f=0,v=h.get(e.drawPhase);f<v.length;f++)d(v[f])},Object.defineProperty(e.prototype,"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.symbolLevels.length=0},e.prototype.addToList=function(e,t){if(Array.isArray(e))for(var i=0,r=e;i<r.length;i++){var n=r[i];this._addToList(n,t)}else this._addToList(e,t)},e.prototype.removeFromList=function(e){Array.isArray(e)||(e=[e]);for(var t=null,i=0,r=e;i<r.length;i++){var n=r[i];t=this._removeFromList(n)}return t},e.prototype.byType=function(e,t){for(var i=0,r=this.symbolLevels;i<r.length;i++)for(var n=0,o=r[i].zLevels;n<o.length;n++){var s=o[n].geometryDPInfo,a=this.getDPInfoType(e);if(s[a])for(var l=0,h=s[a];l<h.length;l++)t(h[l])}},e.prototype.clone=function(){for(var t=new e(this.unified),i=0,r=this.symbolLevels;i<r.length;i++){var n=r[i];t.symbolLevels.push(n.clone())}return t},e.prototype.splitAfter=function(e){for(var t=this._getDisplayList(e.symbolLevel,e.zOrder,e.geometryType),i=t.length,r=e.indexFrom+e.indexCount,n=0;n<i;++n){var o=t[n];if(o.geometryType===e.geometryType&&r>o.indexFrom&&r<=o.indexFrom+o.indexCount){if(r<o.indexFrom+o.indexCount){var s=new c;s.geometryType=o.geometryType,s.materialInfo=o.materialInfo,s.indexFrom=r,s.indexCount=o.indexFrom+o.indexCount-r,t.splice(n+1,0,s),o.indexCount=r-o.indexFrom}return n}}},e.prototype._addToList=function(e,t){var i=e.symbolLevel,r=e.zOrder,n=this._getDisplayList(i,r,e.geometryType),o=null!=t?t:n.length-1,a=0<=o&&o<n.length?n[o]:null;if(null===a||!s.isSameMaterialInfo(a.materialInfo,e.materialInfo)||a.indexFrom+a.indexCount!==e.indexFrom||this.unified&&a.geometryType!==e.geometryType){var h=new c;h.indexFrom=e.indexFrom,h.indexCount=e.indexCount,h.materialInfo=e.materialInfo,h.geometryType=e.geometryType,l(n,o+1,0,h)}else a.indexCount+=e.indexCount},e.prototype._removeFromList=function(e){for(var t=e.symbolLevel,i=e.zOrder,r=this._getDisplayList(t,i,e.geometryType),n=r.length,s=void 0,a=0;a<n;++a){var h=r[a];if(e.indexFrom+e.indexCount>h.indexFrom&&e.indexFrom<h.indexFrom+h.indexCount&&(!this.unified||h.geometryType===e.geometryType)){s=a;break}}if(void 0===s)return null;if(h=r[s],e.indexFrom===h.indexFrom)return h.indexCount-=e.indexCount,h.indexFrom+=e.indexCount,0===h.indexCount&&l(r,s,1),s-1;if(e.indexFrom+e.indexCount===h.indexFrom+h.indexCount)return h.indexCount-=e.indexCount,0===h.indexCount?(l(r,s,1),s-1):s;var u=h.indexFrom,d=e.indexFrom-h.indexFrom,p=e.indexCount,f=h.indexFrom+h.indexCount-(e.indexFrom+e.indexCount);h.indexCount=d;var v=new c;return v.geometryType=h.geometryType,v.materialInfo=new o.default,v.materialInfo.copy(h.materialInfo),v.indexFrom=u+d+p,v.indexCount=f,l(r,s+1,0,v),s},e.prototype._getDisplayList=function(e,t,i){for(var r,o,s=this.symbolLevels.length,a=0;a<s;a++)if(this.symbolLevels[a].symbolLevel===e){r=this.symbolLevels[a];break}r||((r=new f).symbolLevel=e,this.symbolLevels.push(r));for(var l,h=r.zLevels.length,u=0;u<h;u++)if(r.zLevels[u].zLevel===t){o=r.zLevels[u];break}if(o||((o=new p).geometryDPInfo=new d,o.zLevel=t,r.zLevels.push(o)),this.unified)o.geometryDPInfo.unified||(o.geometryDPInfo.unified=[]),l=o.geometryDPInfo.unified;else switch(i){case n.WGLGeometryType.FILL:o.geometryDPInfo.fill||(o.geometryDPInfo.fill=[]),l=o.geometryDPInfo.fill;break;case n.WGLGeometryType.LINE:o.geometryDPInfo.line||(o.geometryDPInfo.line=[]),l=o.geometryDPInfo.line;break;case n.WGLGeometryType.MARKER:o.geometryDPInfo.marker||(o.geometryDPInfo.marker=[]),l=o.geometryDPInfo.marker;break;case n.WGLGeometryType.TEXT:o.geometryDPInfo.text||(o.geometryDPInfo.text=[]),l=o.geometryDPInfo.text;break;case n.WGLGeometryType.LABEL:o.geometryDPInfo.label||(o.geometryDPInfo.label=[]),l=o.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+i+"'.")}return l},e.prototype.getDPInfoType=function(e){if(this.unified)return"unified";switch(e){case n.WGLGeometryType.FILL:return"fill";case n.WGLGeometryType.LINE:return"line";case n.WGLGeometryType.MARKER:return"marker";case n.WGLGeometryType.TEXT:return"text";case n.WGLGeometryType.LABEL:return"label";default:a.error("DisplayList: Tried to convert unknown geometryType: "+e)}},e}(),c=function(){function e(){this.materialInfo=null,this.indexFrom=0,this.indexCount=0}return e.prototype.clone=function(){var t=new e;return t.geometryType=this.geometryType,t.materialInfo=new o.default,t.materialInfo.copy(this.materialInfo),t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t},e}(),d=function(){function e(){this.fill=null,this.line=null,this.marker=null,this.text=null,this.label=null,this.unified=null}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill&&this.fill.map(function(e){return e.clone()}),t.line=this.line&&this.line.map(function(e){return e.clone()}),t.marker=this.marker&&this.marker.map(function(e){return e.clone()}),t.text=this.text&&this.text.map(function(e){return e.clone()}),t.label=this.label&&this.label.map(function(e){return e.clone()}),t.unified=this.unified&&this.unified.map(function(e){return e.clone()}),t},e}(),p=function(){function e(){this.geometryDPInfo=new d}return e.prototype.clone=function(){var t=new e;return t.zLevel=this.zLevel,t.geometryDPInfo=this.geometryDPInfo.clone(),t},e}(),f=function(){function e(){this.zLevels=[]}return e.prototype.clone=function(){var t=new e;t.symbolLevel=this.symbolLevel;for(var i=0,r=this.zLevels;i<r.length;i++){var n=r[i];t.zLevels.push(n.clone())}return t},e}();return u}.apply(null,r))||(e.exports=n)},1549:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(476),i(105),i(81),i(491),i(120)],void 0===(n=function(e,t,i,r,n,o,s){function a(e,t){var i=e.bounds,r=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&i[0]<=r[0]&&i[1]<=r[1]&&i[2]>=r[2]&&i[3]>=r[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=a,t.isChildOf=function(e,t){return a(t,e)};var l=function(){function e(e,t){this.bounds=n.create(),this.key=new s(0,0,0,0),this.objectIds=new i.default,this.key.set(t);var r=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=r.resolution,this.scale=r.scale,this.level=r.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),i=r.acquire(),n=0;n<t.length;n++)i[n]=new e(this.tileInfoView,t[n]);return i},e.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=l,t.default=l}.apply(null,r))||(e.exports=n)},1553:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1403),i(1529),i(1532)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,i){this.ratio=e,this.x=t,this.y=i},s=function(){function e(e,t,r,n,o){void 0===n&&(n=8),void 0===o&&(o=8),this.lines=[],this.starts=[],this.pixelRatio=n,this.pixelMargin=o,this.tileSize=i.TILE_SIZE*n,this.dz=e,this.yPos=t,this.xPos=r}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var i=e>>this.dz;i<t&&(t=i),this.margin=t,this.xmin=i*this.xPos-t,this.ymin=i*this.yPos-t,this.xmax=this.xmin+i+2*t,this.ymax=this.ymin+i+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new r.Point(e,t),this._firstPt=new r.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var i,n,s,a,l,h,u,c,d=this._isIn(e,t),p=new r.Point(e,t),f=r.Point.distance(this._prevPt,p);if(d)this._prevIsIn?this._lineTo(e,t,!0):(i=this._prevPt,n=p,s=this._intersect(n,i),this.start=this._dist+f*(1-this._r),this._lineTo(s.x,s.y,!0),this._lineTo(n.x,n.y,!0));else if(this._prevIsIn)n=this._prevPt,i=p,s=this._intersect(n,i),this._lineTo(s.x,s.y,!0),this._lineTo(i.x,i.y,!1);else{var v=this._prevPt,y=p;if(v.x<=this.xmin&&y.x<=this.xmin||v.x>=this.xmax&&y.x>=this.xmax||v.y<=this.ymin&&y.y<=this.ymin||v.y>=this.ymax&&y.y>=this.ymax)this._lineTo(y.x,y.y,!1);else{var m=[];if((v.x<this.xmin&&y.x>this.xmin||v.x>this.xmin&&y.x<this.xmin)&&(a=(this.xmin-v.x)/(y.x-v.x),(c=v.y+a*(y.y-v.y))<=this.ymin?h=!1:c>=this.ymax?h=!0:m.push(new o(a,this.xmin,c))),(v.x<this.xmax&&y.x>this.xmax||v.x>this.xmax&&y.x<this.xmax)&&(a=(this.xmax-v.x)/(y.x-v.x),(c=v.y+a*(y.y-v.y))<=this.ymin?h=!1:c>=this.ymax?h=!0:m.push(new o(a,this.xmax,c))),(v.y<this.ymin&&y.y>this.ymin||v.y>this.ymin&&y.y<this.ymin)&&(a=(this.ymin-v.y)/(y.y-v.y),(u=v.x+a*(y.x-v.x))<=this.xmin?l=!1:u>=this.xmax?l=!0:m.push(new o(a,u,this.ymin))),(v.y<this.ymax&&y.y>this.ymax||v.y>this.ymax&&y.y<this.ymax)&&(a=(this.ymax-v.y)/(y.y-v.y),(u=v.x+a*(y.x-v.x))<=this.xmin?l=!1:u>=this.xmax?l=!0:m.push(new o(a,u,this.ymax))),0===m.length)l?h?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):h?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<m.length&&m[0].ratio>m[1].ratio)this.start=this._dist+f*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+f*m[0].ratio;for(var g=0;g<m.length;g++)this._lineTo(m[g].x,m[g].y,!0)}this._lineTo(y.x,y.y,!1)}}this._dist+=f,this._prevIsIn=d,this._prevPt=p},e.prototype.close=function(){if(2<this.line.length){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var i=this.line,r=i.length;4<=r&&(i[0].x===i[1].x&&i[0].x===i[r-2].x||i[0].y===i[1].y&&i[0].y===i[r-2].y);)i.pop(),i[0].x=i[r-2].x,i[0].y=i[r-2].y,--r}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&l.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var i=[],r=0;r<t;r++)i.push({line:e[r],start:this.starts[r]||0});return i},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var i,n,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((n=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),i=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),n=e.y+o*(t.y-e.y);else{n=t.y<=this.ymin?this.ymin:this.ymax;var s=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),a=(n-e.y)/(t.y-e.y);s<a?(o=s,n=e.y+s*(t.y-e.y)):(o=a,i=e.x+a*(t.x-e.x))}return this._r=o,new r.Point(i,n)},e.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,i){3!==this.type?i&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new r.Point(e,t))):(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new r.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,i){var n,o;if(3!==this.type)if(i){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),0<this.line.length&&(n=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new r.Point(e,t))}else this.line&&0<this.line.length&&this._pushLine();else if(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){var s=(n=this.line[this.line.length-1]).x===e,a=n.y===t;if(s&&a)return;this._is_h&&s?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&a?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new r.Point(e,t)),this._is_h=s,this._is_v=a)}else this.line.push(new r.Point(e,t))},e}();t.TileClipper=s;var a=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var i=this._ratio;this.line.push(new r.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.lineTo=function(e,t){var i=this._ratio;this.line.push(new r.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&l.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=a;var l=function(){function e(){}return e.simplify=function(t,i,r){if(r){for(var n=-i,o=t+i,s=-i,a=t+i,l=[],h=[],u=r.length,c=0;c<u;++c){var d=r[c];if(d&&!(d.length<2))for(var p=d[0],f=void 0,v=d.length,y=1;y<v;++y)f=d[y],p.x===f.x&&(p.x<=n&&(p.y>f.y?(l.push(c),l.push(y),l.push(0),l.push(-1)):(h.push(c),h.push(y),h.push(0),h.push(-1))),p.x>=o&&(p.y<f.y?(l.push(c),l.push(y),l.push(1),l.push(-1)):(h.push(c),h.push(y),h.push(1),h.push(-1)))),p.y===f.y&&(p.y<=s&&(p.x<f.x?(l.push(c),l.push(y),l.push(2),l.push(-1)):(h.push(c),h.push(y),h.push(2),h.push(-1))),p.y>=a&&(p.x>f.x?(l.push(c),l.push(y),l.push(3),l.push(-1)):(h.push(c),h.push(y),h.push(3),h.push(-1)))),p=f}if(0!==l.length&&0!==h.length){e.fillParent(r,h,l),e.fillParent(r,l,h);var m=[];e.calcDeltas(m,h,l),e.calcDeltas(m,l,h),e.addDeltas(m,r)}}},e.fillParent=function(e,t,i){for(var r=i.length,o=t.length,s=0;s<o;s+=4){for(var a=t[s],l=t[s+1],h=t[s+2],u=e[a][l-1],c=e[a][l],d=8092,p=-1,f=0;f<r;f+=4)if(i[f+2]===h){var v=i[f],y=i[f+1],m=e[v][y-1],g=e[v][y];switch(h){case 0:case 1:n.between(u.y,m.y,g.y)&&n.between(c.y,m.y,g.y)&&(_=Math.abs(g.y-m.y))<d&&(d=_,p=f);break;case 2:case 3:var _;n.between(u.x,m.x,g.x)&&n.between(c.x,m.x,g.x)&&(_=Math.abs(g.x-m.x))<d&&(d=_,p=f)}}t[s+3]=p}},e.calcDeltas=function(t,i,r){for(var n=i.length,o=0;o<n;o+=4){var s=e.calcDelta(o,i,r,[]);t.push(i[o]),t.push(i[o+1]),t.push(i[o+2]),t.push(s)}},e.calcDelta=function(t,i,r,n){var o=i[t+3];if(-1===o)return 0;var s=n.length;return 1<s&&n[s-2]===o?0:(n.push(o),e.calcDelta(o,r,i,n)+1)},e.addDeltas=function(e,t){for(var i=e.length,r=0,n=0;n<i;n+=4)r<(a=e[n+3])&&(r=a);for(n=0;n<i;n+=4){var o=t[e[n]],s=e[n+1],a=r-e[n+3];switch(e[n+2]){case 0:o[s-1].x-=a,o[s].x-=a,1===s&&(o[o.length-1].x-=a),s===o.length-1&&(o[0].x-=a);break;case 1:o[s-1].x+=a,o[s].x+=a,1===s&&(o[o.length-1].x+=a),s===o.length-1&&(o[0].x+=a);break;case 2:o[s-1].y-=a,o[s].y-=a,1===s&&(o[o.length-1].y-=a),s===o.length-1&&(o[0].y-=a);break;case 3:o[s-1].y+=a,o[s].y+=a,1===s&&(o[o.length-1].y+=a),s===o.length-1&&(o[0].y+=a)}}},e}(),h=function(){function e(){this.linesIn=[],this.linesOut=[]}return e.prototype.cut=function(e,t){var i;if(this.xCut=t,e.rings)this.closed=!0,i=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,i=e.paths,this.minPts=2}for(var r=0,n=i;r<n.length;r++)if((f=n[r])&&!(f.length<this.minPts)){for(var o=!0,s=0,a=f;s<a.length;s++){var l=a[s];o?(this.moveTo(l),o=!1):this.lineTo(l)}this.closed&&this.close()}this._pushLineIn(),this._pushLineOut(),i=[];for(var h=0,u=this.linesIn;h<u.length;h++)(f=u[h])&&f.length>=this.minPts&&i.push(f);for(var c=-2*this.xCut,d=0,p=this.linesOut;d<p.length;d++){var f;if((f=p[d])&&f.length>=this.minPts){for(var v=0,y=f;v<y.length;v++)(l=y[v])[0]+=c;i.push(f)}}return this.closed?e.rings=i:e.paths=i,e},e.prototype.moveTo=function(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e},e.prototype.lineTo=function(e){var t=this._side(e[0]);if(t*this._prevSide==-1){var i=this._intersect(this._prevPt,e);this._lineTo(this.xCut,i,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e},e.prototype.close=function(){var e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this.lineIn),this._checkClosingPt(this.lineOut)},e.prototype._moveTo=function(e,t,i){this.closed?(this.lineIn.push([i<=0?e:this.xCut,t]),this.lineOut.push([0<=i?e:this.xCut,t])):(i<=0&&this.lineIn.push([e,t]),0<=i&&this.lineOut.push([e,t]))},e.prototype._lineTo=function(e,t,i){this.closed?(this._addPolyVertex(this.lineIn,i<=0?e:this.xCut,t),this._addPolyVertex(this.lineOut,0<=i?e:this.xCut,t)):i<0?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([e,t])):0<i?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([e,t])):this._prevSide<0?(this.lineIn.push([e,t]),this.lineOut.push([e,t])):0<this._prevSide&&(this.lineOut.push([e,t]),this.lineIn.push([e,t]))},e.prototype._addPolyVertex=function(e,t,i){var r=e.length;1<r&&e[r-1][0]===t&&e[r-2][0]===t?e[r-1][1]=i:e.push([t,i])},e.prototype._checkClosingPt=function(e){var t=e.length;3<t&&e[0][0]===this.xCut&&e[t-2][0]===this.xCut&&e[1][0]===this.xCut&&(e[0][1]=e[t-2][1],e.pop())},e.prototype._side=function(e){return e<this.xCut?-1:e>this.xCut?1:0},e.prototype._intersect=function(e,t){var i=(this.xCut-e[0])/(t[0]-e[0]);return e[1]+i*(t[1]-e[1])},e.prototype._pushLineIn=function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn),this.lineIn=[]},e.prototype._pushLineOut=function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut),this.lineOut=[]},e}();t.CutVertical=h}.apply(null,r))||(e.exports=n)},1555:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._listeners={}}return e.prototype.on=function(e,t){var i=this;null==this._listeners[e]&&(this._listeners[e]=new Map);var r={};return this._listeners[e].set(r,t),{remove:function(){return i._listeners[e].delete(r)}}},e.prototype.once=function(e,t){var i=this.on(e,function(e){i.remove(),t(e)});return i},e.prototype.emit=function(e,t){this.hasEventListener(e)&&this._listeners[e].forEach(function(e){return e(t)})},e.prototype.hasEventListener=function(e){return null!=this._listeners[e]&&this._listeners[e].size>0},e}();t.default=i}.apply(null,r))||(e.exports=n)},1606:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(1),i(1425),i(1379)],void 0===(n=function(e,t,i,r,n,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.doRender=function(t){this.visible&&t.drawPhase===o.WGLDrawPhase.MAP&&e.prototype.doRender.call(this,t)},t.prototype.renderChildren=function(e){var t=this.stage.painter,i=this.children,r=e.drawPhase;this.sortChildren(function(e,t){return t.resolution-e.resolution}),e.drawPhase=o.WGLDrawPhase.CLIP,t.startStencilBurn();for(var n=0,s=i.length;n<s;n++){(a=i[n]).attached&&a.visible&&(t.stencilRef=n,a.processRender(e))}e.drawPhase=r,t.startStencilDraw();for(n=0,s=i.length;n<s;n++){var a;(a=i[n]).attached&&a.visible&&(t.stencilRef=n,a.processRender(e))}t.endStencilDraw()},t}(n.Container);t.BitmapContainer=s}.apply(null,r))||(e.exports=n)},1618:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(26),i(70),i(241),i(1375)],void 0===(n=function(e,t,i,r,n,o){function s(e,t){var i=t.length;if(e<t[0].value||1===i)return t[0].size;for(var r=1;r<i;r++)if(e<t[r].value){var n=(e-t[r-1].value)/(t[r].value-t[r-1].value);return t[r-1].size+n*(t[r].size-t[r-1].size)}return t[i-1].size}return function(){function e(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.vvSizeFieldStopsValues=new Float32Array(6),this.vvSizeFieldStopsSizes=new Float32Array(6),this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this.symbolLevels.push(0)}return Object.defineProperty(e.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0}),e.prototype.updateVisualVariables=function(e,t){var a=this._vvMaterialParameters;if(a.vvOpacityEnabled=!1,a.vvSizeEnabled=!1,a.vvColorEnabled=!1,a.vvRotationEnabled=!1,e){var l=e.size;if(l){if(a.vvSizeEnabled=!0,l.minMaxValue){var h=l.minMaxValue,u=void 0,c=void 0;if(o.isDefined(h.minSize)&&o.isDefined(h.maxSize))if(o.isNumber(h.minSize)&&o.isNumber(h.maxSize))u=i.pt2px(h.minSize),c=i.pt2px(h.maxSize);else{var d=t.scale;u=i.pt2px(s(d,h.minSize.stops)),c=i.pt2px(s(d,h.maxSize.stops))}this.vvSizeMinMaxValue.set([h.minDataValue,h.maxDataValue,u,c])}if(l.scaleStops&&(this.vvSizeScaleStopsValue=i.pt2px(s(t.scale,l.scaleStops.stops))),l.unitValue){var p=r.getMetersPerUnitForSR(t.spatialReference)/n.meterIn[l.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=p/t.resolution}l.fieldStops&&(this.vvSizeFieldStopsValues.set(l.fieldStops.values),this.vvSizeFieldStopsSizes.set(l.fieldStops.sizes))}var f=e.color;f&&(a.vvColorEnabled=!0,this.vvColorValues.set(f.values),this.vvColors.set(f.colors));var v=e.opacity;v&&(a.vvOpacityEnabled=!0,this.vvOpacityValues.set(v.values),this.vvOpacities.set(v.opacities));var y=e.rotation;y&&(a.vvRotationEnabled=!0,a.vvRotationType=y.type)}},e}()}.apply(null,r))||(e.exports=n)},1619:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1620),i(1621),i(1622),i(1375),i(1375),i(1548),i(1533),i(1664),i(1530),i(1623),i(1525),i(1624)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h,u,c,d,p){var f=new i.default,v=new i.default;function y(e,t){var i={};for(var r in e){var n={data:s.allocateTypedArrayBuffer(t,e[r]),stride:e[r]};i[r]=n}return i}return function(){function e(){this.tileDisplayData=null,this.tileBufferData=null}return e.prototype.reshuffle=function(){f.reset();var t=n.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var i in t)for(var a=0,l=b=t[i];a<l.length;a++){var h=l[a];f.needMore(h.geometryType,h.meshData?h.meshData.vertexCount:h.vertexCount,h.meshData?h.meshData.indexData.length:h.indexCount)}var u=t.length,c=new r;for(i=0;i<u;++i){c.geometries[i].indexBuffer=new Uint32Array(Math.round(1.15*f.indicesFor(i)));var d=[];for(var p in this.tileBufferData.geometries[i].vertexBuffer)d.push(this.tileBufferData.geometries[i].vertexBuffer[p].stride);var y=e._computeVertexAlignment(d),m=Math.round(1.15*f.verticesFor(i)),g=e._align(m,y);for(var _ in this.tileBufferData.geometries[i].vertexBuffer){var x=this.tileBufferData.geometries[i].vertexBuffer[_].stride;c.geometries[i].vertexBuffer[_]={stride:x,data:s.allocateTypedArrayBuffer(g,x)}}}for(v.reset(),this.tileDisplayData.displayList.clear(),i=0;i<u;++i){for(var b,C=0,w=b=t[i];C<w.length;C++){if((h=w[C]).meshData)h.writeMeshDataToBuffers(v.verticesFor(i),c.geometries[i].vertexBuffer,v.indicesFor(i),c.geometries[i].indexBuffer),h.meshData=null;else{var T=this.tileBufferData.geometries[i].vertexBuffer,I=this.tileBufferData.geometries[i].indexBuffer,D=c.geometries[i].vertexBuffer,L=c.geometries[i].indexBuffer,P=v.verticesFor(i),R=v.indicesFor(i);o.copyMeshData(P,R,D,L,h,T,I),h.vertexFrom=P,h.indexFrom=R}v.needMore(i,h.vertexCount,h.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(b)}if(this.tileDisplayData.displayList.unified)for(var O=0,M=this.tileDisplayData.displayObjects;O<M.length;O++){var A=M[O];this.tileDisplayData.displayList.addToList(A.displayRecords)}this.tileBufferData=c},e.prototype.getStrides=function(){for(var e=[],t=0;t<this.tileBufferData.geometries.length;++t){var i=this.tileBufferData.geometries[t];for(var r in e[t]={},i.vertexBuffer)e[t][r]=i.vertexBuffer[r].stride}return e},e.prototype._guessSize=function(){for(var e=this.tileDisplayData.displayObjects,t=Math.min(e.length,4),i=0,r=0;r<t;r++)i=Math.max(i,e[r].displayRecords.length);return 2*(12*e.length+e.length*i*40)},e.prototype.serialize=function(){var e=this.tileBufferData.serialize(),t=this.tileBufferData.getBuffers(),i=this.tileDisplayData.serialize(new p.default(Int32Array,this._guessSize())).buffer();return t.push(i),{result:{displayData:i,bufferData:e},transferList:t}},e.decode=function(t){var i=u.default.deserialize(new c.default(t.materialStore)),r=d.deserializeList(new c.default(t.displayObjects),a,{store:i}),n={};for(var o in t.vertexBuffersMap)n[o]=h.VertexBuffers.decode(t.vertexBuffersMap[o]);return e.fromMeshData({materials:i,displayObjects:r,vertexBuffersMap:n},!1)},e.fromMeshData=function(t,i){void 0===i&&(i=!0);var o=new e,s=new n.default,a=new r;for(var l in s.displayObjects=t.displayObjects,i&&t.materials.hydrateObjects(s.displayObjects),t.vertexBuffersMap){var h=t.vertexBuffersMap[l];a.geometries[l].indexBuffer=h.indexBuffer,a.geometries[l].vertexBuffer=h.namedBuffers}return o.tileDisplayData=s,o.tileBufferData=a,o},e.bind=function(t,i){var r=new e;return r.tileDisplayData=t,r.tileBufferData=i,r},e.create=function(t,i){var o=new e;o.tileDisplayData=new n.default;for(var s=[0,0,0,0,0],a=[0,0,0,0,0],h=[[],[],[],[],[]],u=0,c=o.tileDisplayData.displayObjects=t;u<c.length;u++)for(var d=0,p=c[u].displayRecords;d<p.length;d++){var f=p[d];h[f.geometryType].push(f),s[f.geometryType]+=f.meshData.vertexCount,a[f.geometryType]+=f.meshData.indexData.length}for(var v,m=new r,g=[(v=i).fill||{},v.line||{},v.icon||{},v.text||{},v.label||{}],_=0;_<5;_++){var x=new Uint32Array(a[_]),b=y(g[_],s[_]);l.writeAllMeshDataToBuffers(h[_],b,x),m.geometries[_]={indexBuffer:x,vertexBuffer:b}}return o.tileBufferData=m,o},e._align=function(e,t){var i=e%t;return 0===i?e:e+(t-i)},e._computeVertexAlignment=function(e){for(var t=!1,i=!1,r=0,n=e;r<n.length;r++){var o=n[r];o%4==2?t=!0:o%4!=0&&(i=!0)}return i?4:t?2:1},e}()}.apply(null,r))||(e.exports=n)},1620:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._byGeometryType=null}return Object.defineProperty(e.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._byGeometryType=null},e.prototype.verticesFor=function(e){return this._byGeometryType?this._byGeometryType[e].vertices:0},e.prototype.indicesFor=function(e){return this._byGeometryType?this._byGeometryType[e].indices:0},e.prototype.needMore=function(e,t,i){if(t||i){this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]);var r=this._byGeometryType[e];r.vertices+=t,r.indices+=i}},e}();t.default=i}.apply(null,r))||(e.exports=n)},1621:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1375)],void 0===(n=function(e,t,i){return function(){function e(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}return e.deserialize=function(t){for(var r=new e,n=0;n<5;++n)for(var o in r.geometries[n].indexBuffer=new Uint32Array(t.geometries[n].indexBuffer),r.geometries[n].vertexBuffer={},t.geometries[n].vertexBuffer)r.geometries[n].vertexBuffer[o]={data:i.allocateTypedArrayBufferwithData(t.geometries[n].vertexBuffer[o].data,t.geometries[n].vertexBuffer[o].stride),stride:t.geometries[n].vertexBuffer[o].stride};return r},e.prototype.serialize=function(){for(var e={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},t=0;t<5;++t)for(var i in this.geometries[t].vertexBuffer)e.geometries[t].vertexBuffer[i]={data:this.geometries[t].vertexBuffer[i].data.buffer,stride:this.geometries[t].vertexBuffer[i].stride};return e},e.prototype.getBuffers=function(){for(var e=[],t=0;t<5;++t)for(var i in e.push(this.geometries[t].indexBuffer.buffer),this.geometries[t].vertexBuffer)e.push(this.geometries[t].vertexBuffer[i].data.buffer);return e},e}()}.apply(null,r))||(e.exports=n)},1622:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1534),i(1548),i(1530),i(1525)],void 0===(n=function(e,t,i,r,n,o){function s(e){for(var t=[[],[],[],[],[]],i=0,r=e;i<r.length;i++)for(var n=0,o=r[i].displayRecords;n<o.length;n++){var s=o[n];t[s.geometryType].push(s)}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.groupRecordsByGeometryType=s;var a=function(){function e(){}return Object.defineProperty(e.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var e=0,t=this.displayObjects;e<t.length;e++){var i=t[e];this._displayObjectRegistry.set(i.id,i)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0}),e.prototype.computeDisplayList=function(e){if(this._displayList=new i(e),e)for(var t=0,r=this.displayObjects;t<r.length;t++)for(var n=0,o=r[t].displayRecords;n<o.length;n++){var a=o[n];this._displayList.addToList(a)}else for(var l=s(this.displayObjects),h=l.length,u=0;u<h;++u){var c=l[u];this._displayList.addToList(c)}},e.prototype.serialize=function(e){return this.materialStore.serialize(e),o.serializeList(e,this.displayObjects),e},e.prototype._deserializeObjects=function(e){for(var t=e.readInt32(),i=new Array(t),n=new Map,o={store:this.materialStore},s=0;s<i.length;++s){var a=r.deserialize(e,o);i[s]=a,n.set(a.id,a)}this.displayObjects=i,this._displayList=null,this._displayObjectRegistry=n},e.deserialize=function(t){var i=new e;return i.materialStore=n.default.deserialize(t),i._deserializeObjects(t),i},e}();t.default=a}.apply(null,r))||(e.exports=n)},1623:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._pos=0,this._buffer=e,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return e.prototype.readInt32=function(){return this._i32View[this._pos++]},e.prototype.readF32=function(){return this._f32View[this._pos++]},e}();t.default=i}.apply(null,r))||(e.exports=n)},1625:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(34),i(1411),i(1403),i(1626),i(1627),i(1379),i(1629),i(1441),i(1375),i(1630),i(1534),i(120)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h,u,c,d,p,f){function v(e,t){return e.sortKey-t.sortKey}var y=new Set;return function(e){function t(t,i,n){void 0===n&&(n=!1);var o=e.call(this)||this;return o._data=null,o.hlDisplayList=null,o._displayList=null,o._wglBuffers=null,o._dirtyMap=new s.default,o.coords=[0,0],o.bounds=[0,0,0,0],o.tileTransform={transform:r.mat4f32.create(),screenTransform:r.mat2df32.create(),displayCoord:r.vec2f32.create(),screenCoord:r.vec2f32.create()},o.dvsMat3=r.mat3f32.create(),o.tileMat3=r.mat3f32.create(),o.labelMat2d=r.mat2df32.create(),o._labelIndex=null,o._dirty=!0,o.fader=new h.default,o.key=f.pool.acquire(t),o.coords[0]=i[0],o.coords[1]=i[3],o.bounds=i,o._ensureCorrectZOrder=n,o}return i(t,e),Object.defineProperty(t.prototype,"iconGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.MARKER)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.TEXT)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.FILL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.LINE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelGeometry",{get:function(){return this.getGeometry(l.WGLGeometryType.LABEL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayObjects",{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._dirty},set:function(e){(this._dirty=e)||this.isReady||this.ready(),this.requestRender()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0}),t.prototype.getGeometry=function(e){return this._wglBuffers&&this._wglBuffers.has(e)?this._wglBuffers.get(e):null},t.prototype.getDisplayList=function(e){switch(e){case l.WGLDrawPhase.HIGHLIGHT:return this.hlDisplayList;default:return this._data&&this._displayList}},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),t.prototype.setData=function(e,t,i){var r=e.addOrUpdate,n=e.remove;if(this.fader.reset(),(e.clear||!this.hasData)&&!e.addOrUpdate)return this.clear(),void this.ready();!e.clear&&this.hasData||!e.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:r,remove:n},t,i):(r.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new s.default,this._dispRecStore=a.default.fromTileData(r,this._dirtyMap),this._data=r,this._readyTileIfNoLabels(t,i),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=r.tileDisplayData.displayList.clone()))},t.prototype.commitChanges=function(e){this.isDirty&&this._wglBuffers||(this._wglBuffers||(this._wglBuffers=new d.default(this.stage.context)),this._displayList=this._data.tileDisplayData.displayList.clone(),this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._dirtyMap.markAllClean())},t.prototype.resetVisibility=function(e){var t=this,i=new Array(0),r=new Array(1);e.forEach(function(e){r[0]=e,t.setVisibility(i,r)})},t.prototype.setVisibility=function(e,t){for(var i=this._data.tileBufferData.geometries.map(c.geometryToMappedGeometry),r=0,n=e;r<n.length;r++){var o=n[r];if(f=this._data.tileDisplayData.displayObjectRegistry.get(o))for(var s=0,a=f.displayRecords;s<a.length;s++)if(_=(C=i[(g=a[s]).geometryType]).geometry.vertexBuffer[c.C_VBO_VISIBILITY]){C.vertexFrom=null==C.vertexFrom?g.vertexFrom:Math.min(C.vertexFrom,g.vertexFrom),C.vertexTo=null==C.vertexTo?g.vertexFrom+g.vertexCount:Math.max(C.vertexTo,g.vertexFrom+g.vertexCount);for(var l=g.vertexFrom,h=g.vertexCount,u=0;u<h;++u)_.data[l+u]=255}}for(var d=0,p=t;d<p.length;d++){var f,v=p[d];if(f=this._data.tileDisplayData.displayObjectRegistry.get(v))for(var y=0,m=f.displayRecords;y<m.length;y++){var g,_;if(_=(C=i[(g=m[y]).geometryType]).geometry.vertexBuffer[c.C_VBO_VISIBILITY])for(C.vertexFrom=null==C.vertexFrom?g.vertexFrom:Math.min(C.vertexFrom,g.vertexFrom),C.vertexTo=null==C.vertexTo?g.vertexFrom+g.vertexCount:Math.max(C.vertexTo,g.vertexFrom+g.vertexCount),l=g.vertexFrom,h=g.vertexCount,u=0;u<h;++u)_.data[l+u]=0}}for(var x=!1,b=0;b<i.length;++b){var C;if(null!=(C=i[b]).vertexFrom&&null!=C.vertexTo){var w=C.vertexTo?C.vertexTo-C.vertexFrom:0;this._dirtyMap.markDirtyVertices(b,c.C_VBO_VISIBILITY,C.vertexFrom,w),x=!0}}x&&this.requestRender()},t.prototype.setVisibilityRange=function(e,t,i,r){for(var n=this._data.tileDisplayData.displayObjectRegistry.get(e),o=this._data.tileBufferData.geometries[l.WGLGeometryType.LABEL].vertexBuffer[c.C_VBO_VISIBILITY_RANGE],s=1/0,a=0,h=t;h<t+i;++h){for(var d=n.displayRecords[h],p=Math.max(d.minZoom,r),f=d.maxZoom,v=u.i8888to32(p,f,p,f),y=d.vertexFrom*o.stride/4,m=d.vertexCount*o.stride/4,g=y;g<y+m;++g)o.data[g]=v;s=Math.min(s,d.vertexFrom),a=Math.max(a,d.vertexFrom+d.vertexCount)}var _=a-s;this._dirtyMap.markDirtyVertices(l.WGLGeometryType.LABEL,c.C_VBO_VISIBILITY_RANGE,s,_)},t.prototype.setTransform=function(e,t){var i=this.tileMat3,n=e.toScreenNoRotation([0,0],this.coords),o=n[0],s=n[1],a=t;r.mat3.set(this.tileMat3,a,0,0,0,a,0,o,s,1),r.mat3.multiply(this.dvsMat3,e.displayViewMat3,i)},t.prototype.setLabelTransform=function(e,t){var i=this.labelMat2d,n=e.getScreenTransform(i,t),o=r.vec2f32.create();r.vec2.transformMat2d(o,this.coords,n),r.mat2d.identity(i),r.mat2d.translate(i,i,o),r.mat2d.multiply(i,e.viewMat2d,i)},t.prototype.clear=function(){this._data=null,this._displayList=null,this._dispRecStore=null,this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null),this.hlDisplayList&&(this.hlDisplayList=null)},t.prototype.attach=function(){return!0},t.prototype.dispose=function(){this.clear()},t.prototype.doRender=function(e){if(this.isReady&&this.hasData){if(this.commitChanges(e),this.stage.context.setStencilFunction(514,this.stencilRef,255),e.drawPhase===l.WGLDrawPhase.MAP||e.drawPhase===l.WGLDrawPhase.LABEL||e.drawPhase===l.WGLDrawPhase.LABEL_ALPHA)this._displayList.replay(e,this);else for(var t=0,i=this.stage.painter.getBrushes(e.drawPhase);t<i.length;t++)i[t].draw(e,this);this.fader.step()||this.requestRender()}},t.prototype.buildHLList=function(e){var t=this;this.hlDisplayList=new p,e.forEach(function(e){t._addToHLDisplayList(t.hlDisplayList,e)})},t.prototype._addToHLDisplayList=function(e,t){if(this._data){var i=this._data.tileDisplayData.displayObjectRegistry.get(t);if(i){for(var r=[],n=0,o=i.displayRecords;n<o.length;n++){var s=o[n].copy();s.meshData=null,s.symbolLevel=0,s.zOrder=0,r.push(s)}r.sort(v),e.addToList(r)}}},t.prototype._readyTileIfNoLabels=function(e,t){this.isDirty=!!e&&(t||(this.isDirty=!1),this._rebuildLabelIndex(),!0)},t.prototype._doPatchData=function(e,t,i){this._patchData(e)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=a.default.fromTileData(this._data,this._dirtyMap)),this._readyTileIfNoLabels(t,i),this.requestRender()},t.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var e=0,t=this.displayObjects;e<t.length;e++)for(var i=0,r=t[e].metrics;i<r.length;i++){var n=r[i];this._insertIntoLabelIndex(n)}},t.prototype._insertIntoLabelIndex=function(e){-1!==e.xBucket&&this.labelIndex[e.yBucket][e.xBucket].push(e)},t.prototype._initLabelIndex=function(){for(var e=[],t=0;t<o.TILE_SIZE/o.COLLISION_BUCKET_SIZE;t++){e.push([]);for(var i=0;i<o.TILE_SIZE/o.COLLISION_BUCKET_SIZE;i++)e[t].push([])}return e},t.prototype._patchData=function(e){for(var t=!0,i=e.addOrUpdate&&e.addOrUpdate.tileDisplayData&&e.addOrUpdate.tileDisplayData.displayObjects||[],r=(e.remove||[]).slice(),n=0,o=i;n<o.length;n++)null!=(m=o[n]).insertAfter&&r.push(m.id);for(var s=0,a=r;s<a.length;s++){var l=a[s];if(v=this._data.tileDisplayData.displayObjectRegistry.get(l)){this._data.tileDisplayData.displayList.removeFromList(v.displayRecords);for(var h=0,u=v.displayRecords;h<u.length;h++){var c=u[h];this._dispRecStore.delete(c)}this._data.tileDisplayData.displayObjectRegistry.delete(l);var d=this._data.tileDisplayData.displayObjects.indexOf(v);this._data.tileDisplayData.displayObjects.splice(d,1)}}for(var p=0,f=i;p<f.length;p++){var v,m=f[p],g=void 0;if(v=this._data.tileDisplayData.displayObjectRegistry.get(m.id)){var _=v.displayRecords;v.set(m),v.displayRecords=_;for(var x=v.displayRecords.length,b=0;b<x;++b){var C=v.displayRecords[b],w=m.displayRecords[b];(b>=m.displayRecords.length||C.geometryType!==w.geometryType||C.symbolLevel!==w.symbolLevel||C.zOrder!==w.zOrder||C.materialInfo.materialKey!==w.materialInfo.materialKey)&&(this._dispRecStore.delete(v.displayRecords[b]),b<m.displayRecords.length&&(v.displayRecords[b]=void 0))}v.displayRecords.length=m.displayRecords.length,v.metrics=m.metrics}else{(v=m.copy()).displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(m.id,v);var T=void 0,I=this._data.tileDisplayData.displayObjects;if(null!=v.insertAfter)if(g={},0<=v.insertAfter){var D=this._data.tileDisplayData.displayObjectRegistry.get(v.insertAfter);D&&(T=I.indexOf(D)+1)<I.length?I.splice(T,0,v):(I.push(v),T=I.length)}else I.unshift(v),T=0;else I.push(v),T=I.length;if(g){var L=void 0;if(this._data.tileDisplayData.displayList.unified)L=0<m.displayRecords.length?1:0;else{y.clear();for(var P=0,R=m.displayRecords;P<R.length;P++){var O=R[P],M=this._data.tileDisplayData.displayList.getDPInfoType(O.geometryType);y.add(M)}L=y.size}var A=0;for(b=T-1;0<=b&&A<L;--b)for(var S=I[b].displayRecords.length-1;0<=S&&A<L;--S){var G=I[b].displayRecords[S];g[M=this._data.tileDisplayData.displayList.getDPInfoType(G.geometryType)]||(g[M]=G,++A)}}}var B=m.displayRecords.length;for(b=0;b<B;++b){w=m.displayRecords[b],(C=v.displayRecords[b])?(C.meshData=w.meshData,C.materialInfo=w.materialInfo):((C=w.copy()).vertexFrom=void 0,C.indexFrom=void 0,v.displayRecords[b]=C);var E=w.geometryType,F=(M=this._data.tileDisplayData.displayList.getDPInfoType(E),e.addOrUpdate.tileBufferData.geometries[E]),j=F.vertexBuffer,V=F.indexBuffer,z=void 0;g&&(z=g[M]?this._data.tileDisplayData.displayList.splitAfter(g[M]):-1),t=this._dispRecStore.setMeshData(C,w,j,V,z)&&t,g&&null!=C.indexFrom&&null!=C.indexFrom&&(g[M]=C)}}return t},t}(n.DisplayObject)}.apply(null,r))||(e.exports=n)},1626:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1375)],void 0===(n=function(e,t,i){function r(e,t,i){if(!e.allDirty)if(null!=e.from&&null!=e.count){var r=Math.min(e.from,t),n=Math.max(e.from+e.count,t+i)-r;e.from=r,e.count=n}else e.from=t,e.count=i}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._dirties=i.createGeometryData(function(e){return{indices:{from:null,count:null,allDirty:!1}}},function(e,t){return{vertices:{from:null,count:null,allDirty:!1}}})}return e.prototype.markAllClean=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var r in i.data.indices.from=null,i.data.indices.count=null,i.data.indices.allDirty=!1,i.buffers)i.buffers[r].data.vertices.from=null,i.buffers[r].data.vertices.count=null,i.buffers[r].data.vertices.allDirty=!1}},e.prototype.markAllDirty=function(){for(var e=0,t=this._dirties;e<t.length;e++){var i=t[e];for(var r in i.data.indices.allDirty=!0,i.buffers)i.buffers[r].data.vertices.allDirty=!0}},e.prototype.forEach=function(e){for(var t=0;t<this._dirties.length;++t){var i=this._dirties[t],r={};for(var n in i.buffers){var o=i.buffers[n].data.vertices;(o.allDirty||null!=o.from&&null!=o.count&&0<o.count)&&(r[n]=o)}var s,a=i.data.indices;((s=a.allDirty||null!=a.from&&null!=a.count&&0<a.count?{indices:a,vertices:r}:{indices:null,vertices:r}).indices||0<Object.keys(s).length)&&e(s,t)}},e.prototype.markDirtyIndices=function(e,t,i){r(this._dirties[e].data.indices,t,i)},e.prototype.markDirtyVertices=function(e,t,i,n){r(this._dirties[e].buffers[t].data.vertices,i,n)},e}();t.default=n}.apply(null,r))||(e.exports=n)},1627:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(16),i(1628),i(1375)],void 0===(n=function(e,t,i,r,n){Object.defineProperty(t,"__esModule",{value:!0});var o=["FILL","LINE","MARKER","TEXT","LABEL"],s=function(){function e(e,t,i,o){for(var s in this._strides=e,this._displayList=t,this._freeListsAndStorage={},this._dirtyMap=null,this._dirtyMap=i,e)for(var a in this._freeListsAndStorage[s]={vtxFreeList:o?new r.FreeList(o):null,idxFreeList:o?new r.FreeList(o):null,vertexBuffers:{},indexBuffer:o?new Uint32Array(o):null},e[s])this._freeListsAndStorage[s].vertexBuffers[a]={data:o?n.allocateTypedArrayBuffer(o,e[s][a]):null,stride:e[s][a]}}return e.fromTileData=function(t,i){var s=function(e){var t=e.getStrides(),i={};for(var r in t)i[o[r]]=t[r];return i}(t),a=[0,0,0,0,0],l=[0,0,0,0,0],h=[];t.tileDisplayData.displayObjectRegistry.forEach(function(e){h.push(e)});for(var u=0,c=h;u<c.length;u++)for(var d=0,p=c[u].displayRecords;d<p.length;d++){var f=p[d];a[f.geometryType]=Math.max(a[f.geometryType],f.vertexFrom+f.vertexCount),l[f.geometryType]=Math.max(l[f.geometryType],f.indexFrom+f.indexCount)}for(var v=new e(s,t.tileDisplayData.displayList,i,null),y=0;y<t.tileBufferData.geometries.length;++y){var m=a[y],g=l[y],_=t.tileBufferData.geometries[y],x=o[y],b=v._storageFor(x),C=t.tileBufferData.geometries[y].indexBuffer;b.indexBuffer=C,b.idxFreeList=new r.FreeList(C.length),b.idxFreeList.allocate(g);var w=void 0;for(var T in _.vertexBuffer){var I=t.tileBufferData.geometries[y].vertexBuffer[T];b.vertexBuffers[T].data=I.data,b.vertexBuffers[T].stride=I.stride;var D=n.strideToPackingFactor(I.stride),L=I.data.length*D/I.stride;w||(w=L)}b.vtxFreeList=new r.FreeList(w),b.vtxFreeList.allocate(m)}return v},e.prototype.delete=function(e){var t=o[e.geometryType];this._freeVertices(t,e.vertexFrom,e.vertexCount),this._freeIndices(t,e.indexFrom,e.indexCount),this._displayList.removeFromList(e),e.vertexFrom=void 0,e.indexFrom=void 0},e.prototype.setMeshData=function(e,t,i,r,s){var a=o[e.geometryType];e.meshData=null;var l=void 0,h=void 0;void 0===e.vertexFrom?(h=t.vertexCount,l=this._allocateVertices(a,h)):t.vertexCount>e.vertexCount?(this._freeVertices(a,e.vertexFrom,e.vertexCount),h=t.vertexCount,l=this._allocateVertices(a,h)):h=t.vertexCount===e.vertexCount?(l=e.vertexFrom,e.vertexCount):(this._freeVertices(a,e.vertexFrom+t.vertexCount,e.vertexCount-t.vertexCount),l=e.vertexFrom,t.vertexCount);var u=!0,c=void 0,d=void 0,p=void 0;if(void 0===e.indexFrom?(c=s,p=t.indexCount,d=this._allocateIndices(a,p)):t.indexCount>e.indexCount?(c=this._displayList.removeFromList(e),this._freeIndices(a,e.indexFrom,e.indexCount),p=t.indexCount,d=this._allocateIndices(a,p)):p=t.indexCount===e.indexCount?(u=!1,d=e.indexFrom,e.indexCount):(c=this._displayList.removeFromList(e),this._freeIndices(a,e.indexFrom+t.indexCount,e.indexCount-t.indexCount),d=e.indexFrom,t.indexCount),-1===l||-1===d)return-1!==l&&this._freeVertices(a,l,h),-1!==d&&this._freeIndices(a,d,p),e.setMeshDataFromBuffers(t,i,r),e.vertexFrom=void 0,e.vertexCount=0,e.indexFrom=void 0,e.indexCount=0,!1;var f=this._storageFor(a);if(n.copyMeshData(l,d,f.vertexBuffers,f.indexBuffer,t,i,r),e.vertexFrom=l,e.indexFrom=d,e.vertexCount=t.vertexCount,e.indexCount=t.indexCount,this._dirtyMap)for(var v in this._dirtyMap.markDirtyIndices(e.geometryType,e.indexFrom,e.indexCount),i)this._dirtyMap.markDirtyVertices(e.geometryType,v,e.vertexFrom,e.vertexCount);return u&&this._displayList.addToList(e,c),!0},e.prototype._allocateVertices=function(e,t){var i=this._storageFor(e),r=i.vtxFreeList.allocate(t);return-1===r?-1:.5<i.vtxFreeList.fragmentation?-1:r},e.prototype._freeVertices=function(e,t,r){var o=this._storageFor(e);if(o.vtxFreeList.free(t,r),i("esri-feature-tiles-debug"))for(var s in o.vertexBuffers)for(var a=o.vertexBuffers[s].data,l=this._stridesFor(e,s),h=n.strideToPackingFactor(l),u=t*l/h,c=r*l/h,d=u;d<u+c;++d)a[d]=0},e.prototype._freeIndices=function(e,t,r){var n=this._storageFor(e);if(n.idxFreeList.free(t,r),i("esri-feature-tiles-debug"))for(var o=n.indexBuffer,s=t;s<t+r;++s)o[s]=0},e.prototype._allocateIndices=function(e,t){var i=this._storageFor(e),r=i.idxFreeList.allocate(t);return-1===r?-1:.5<i.idxFreeList.fragmentation?-1:r},e.prototype._storageFor=function(e){return this._freeListsAndStorage[e]},e.prototype._stridesFor=function(e,t){return this._strides[e][t]},e}();t.default=s}.apply(null,r))||(e.exports=n)},1628:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._largestRange=null,this._parent=e,this._updateLargestRange()}return Object.defineProperty(e.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0}),e.prototype.rangeCreated=function(e){(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.rangeResized=function(e,t,i){e===this._largestRange?e.count<i&&this._updateLargestRange():(!this._largestRange||e.count>this._largestRange.count)&&(this._largestRange=e)},e.prototype.findBestRange=function(e){for(var t=this._parent._freeHead,i=null;null!==t;)t.count>=e&&(!i||t.count-e<i.count-e)&&(i=t),t=t.next;return i},e.prototype.findAdjacentRanges=function(e,t){for(var i=!0,r=!1,n=null,o=this._parent._freeHead;i&&!r;){var s=null!==n?n.from+n.count:0,a=null!==o?o.from:this._parent._size;s<=e&&e+t<=a?r=!(i=!1):null!==o?o=(n=o).next:i=!1}return[n,o]},e.prototype._updateLargestRange=function(){for(var e=null,t=this._parent._freeHead;null!==t;)(!e||t.count>e.count)&&(e=t),t=t.next;this._largestRange=e},e}(),r=function(){function e(e,t){this._allocated=0,this._size=e,this._freeHead=0<e?{from:0,count:e,prev:null,next:null}:null,this._bookKeeper=t||new i(this),this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}return e.prototype.allocate=function(t){var i=this._bookKeeper.findBestRange(t);if(null===i)return-1;var r=i.from,n=i.count;if(i.from+=t,i.count-=t,this._bookKeeper.rangeResized(i,r,n),this._allocated+=t,0===i.count){var o=null!==i.prev?this._freeHead:i.next;e._removeRange(i),this._freeHead=o}return r},e.prototype.free=function(t,i){var r=this._bookKeeper.findAdjacentRanges(t,i),n=r[0],o=r[1],s={from:t,count:i,prev:n,next:o};if(null!==n&&(n.next=s),null!==o&&(o.prev=s),this._bookKeeper.rangeCreated(s),this._allocated-=i,null!==o&&s.from+s.count===o.from){var a=s.from,l=s.count;e._fuse(s,o),e._removeRange(o),this._bookKeeper.rangeResized(s,a,l),this._bookKeeper.rangeResized(o,void 0,0)}null!==n&&n.from+n.count===s.from&&(a=n.from,l=n.count,e._fuse(n,s),e._removeRange(s),this._bookKeeper.rangeResized(n,a,l),this._bookKeeper.rangeResized(s,void 0,0)),this._freeHead=null!==s.prev?this._freeHead:s},Object.defineProperty(e.prototype,"fragmentation",{get:function(){var e=this._size-this._allocated;return 0===e?0:1-this._bookKeeper.largestRange.count/e},enumerable:!0,configurable:!0}),e._removeRange=function(e){null!==e.prev?null!==e.next?(e.prev.next=e.next,e.next.prev=e.prev):e.prev.next=null:null!==e.next&&(e.next.prev=null)},e._fuse=function(e,t){e.count+=t.count,e.next=t.next,t.from+=t.count,t.count=0,null!==t.next&&(t.next.prev=e)},e}();t.FreeList=r}.apply(null,r))||(e.exports=n)},1629:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){void 0===e&&(e=400),this.duration=e,this._lastTime=0,this._elapsed=0,this._value=0,this._finished=!1}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._lastTime=0,this._elapsed=0,this._value=0},e.prototype.step=function(){var e=performance.now();if(0===this._lastTime)return this._lastTime=e,!(this._value=0);if(this._elapsed>=this.duration)return!0;var t=e-this._lastTime;return this._elapsed+=t,this._lastTime=e,this._value=Math.min(this._elapsed/this.duration,1),!1},e}();t.default=i}.apply(null,r))||(e.exports=n)},1630:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1375),i(1360)],void 0===(n=function(e,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.geometryMap=i.createGeometryData(function(t){return{indexBuffer:r.createIndex(e,35044),vao:null}},function(t,n){return{vertexBuffer:r.createVertex(e,i.C_VBO_INFO[n])}})}return e.prototype.dispose=function(){for(var e in this.geometryMap){var t=this.geometryMap[e];for(var i in t.data.vao&&t.data.vao.dispose(!1),t.data.indexBuffer&&t.data.indexBuffer.dispose(),t.buffers)t.buffers[i]&&t.buffers[i].data.vertexBuffer.dispose()}},e.prototype.get=function(e){var t=this.geometryMap[e],i={};for(var r in t.buffers)i[r]=t.buffers[r].data.vertexBuffer;return{indexBuffer:t.data.indexBuffer,get vao(){return t.data.vao},set vao(e){t.data.vao=e},vertexBufferMap:i}},e.prototype.has=function(e){return null!=this.geometryMap[e]},e.prototype.upload=function(e,t){var i=this;t.forEach(function(t,r){i._upload(t,r,e)})},e.prototype._upload=function(e,t,i){if(e.indices&&(e.indices.allDirty?this._uploadIndices(i,t):null!=e.indices.from&&null!=e.indices.count&&this._uploadIndices(i,t,e.indices.from,e.indices.count)),e.vertices){var r=e.vertices;for(var n in r){var o=r[n];o.allDirty?this._uploadVertices(i,t,n):null!=o.from&&null!=o.count&&this._uploadVertices(i,t,n,o.from,o.count)}}},e.prototype._uploadVertices=function(e,t,i,r,n){var o=this.geometryMap[t];if(o){var s=e.geometries[t].vertexBuffer[i];if(s){var a=s.stride,l=s.data.buffer;o.buffers[i]&&0<l.byteLength&&(null!=r&&null!=n?o.buffers[i].data.vertexBuffer.setSubData(l,r*a,r*a,(r+n)*a):o.buffers[i].data.vertexBuffer.setData(l))}}},e.prototype._uploadIndices=function(e,t,i,r){var n=this.geometryMap[t];if(n){var o=e.geometries[t].indexBuffer.buffer;n.data.indexBuffer&&0<o.byteLength&&(null!=i&&null!=r?n.data.indexBuffer.setSubData(o,4*i,4*i,4*(i+r)):n.data.indexBuffer.setData(o))}},e}();t.default=n}.apply(null,r))||(e.exports=n)},1633:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(1),i(476),i(16),i(1554),i(1549),i(1555),i(120)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h){Object.defineProperty(t,"__esModule",{value:!0});var u={added:[],removed:[]},c=new n.default,d=new h(0,0,0,0),p=function(e){function t(t){var i=e.call(this)||this;return i._tiles=new Map,i._index=s(9,o("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=t,i}return i(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var i="string"==typeof e?this.get(e):e;if(!i)return[];for(var r=t*i.resolution,n=i.bounds[0]-r,o=i.bounds[1]-r,s=i.bounds[2]+r,a=i.bounds[3]+r,l=[],h=0,u=this._index.search({minX:n,minY:o,maxX:s,maxY:a});h<u.length;h++){var c=u[h],d=c.bounds.slice();d[0]=Math.max(d[0],n),d[1]=Math.max(d[1],o),d[2]=Math.min(d[2],s),d[3]=Math.min(d[3],a),d[2]-d[0]>0&&d[3]-d[1]>0&&l.push({bounds:d,tile:c})}return l},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var i=t.spans,r=t.lodInfo,n=r.level;if(i.length>0)for(var o=0,s=i;o<s.length;o++)for(var l=s[o],h=l.row,p=l.colFrom,f=l.colTo,v=p;v<=f;v++){var y=d.set(n,h,r.normalizeCol(v),r.getWorldForColumn(v)).id;if(c.add(y),!this.has(y)){var m=new a.default(this.tileScheme,y);this._tiles.set(y,m),this._index.insert(m),this.tiles.push(m),u.added.push(m)}}for(var g=this.tiles.length-1;g>=0;g--){m=this.tiles[g];c.has(m.id)||(this._tiles.delete(m.id),this.tiles.splice(g,1),this._index.remove(m),u.removed.push(m))}(u.added.length||u.removed.length)&&this.emit("update",u),c.clear(),u.added.length=0,u.removed.length=0}},t}(l.default);t.default=p}.apply(null,r))||(e.exports=n)},1642:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(25),i(476),i(1411),i(1356)],void 0===(n=function(e,t,i,r,n,o){function s(e){return e.updateTexture()}function a(e){u.has(e)&&(h.splice(h.indexOf(e),1),u.delete(e))}Object.defineProperty(t,"__esModule",{value:!0});var l=[0,0],h=[],u=new r.default,c=function(e){function t(t){void 0===t&&(t=null);var i=e.call(this)||this;return i._height=void 0,i.pixelRatio=1,i.resolution=0,i.rotation=0,i._source=null,i._width=void 0,i.x=0,i.y=0,i.source=t,i.requestRender=i.requestRender.bind(i),i}return i(t,e),Object.defineProperty(t.prototype,"height",{get:function(){return void 0!==this._height?this._height:this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},set:function(e){this._height=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(e){this._source=e,this.invalidateTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return void 0!==this._width?this._width:this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},set:function(e){this._width=e},enumerable:!0,configurable:!0}),t.prototype.attach=function(){return this._texture=function(e){return new o(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,flipped:!0})}(this.stage.context),s(this),!0},t.prototype.detach=function(){this._texture.dispose(),this._texture=null,a(this),e.prototype.detach.call(this)},t.prototype.invalidateTexture=function(){this.attached?s(this):a(this)},t.prototype.updateTexture=function(){if(this._texture){var e=this.source;if(!e)return void this._texture.setData(null);this._texture.resize(this.width,this.height),function(e){return e&&"render"in e}(e)?this._texture.setData(function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}(e)):function(e){return e&&!("render"in e)}(e)&&this._texture.setData(e),this.ready(),this.requestRender()}},t.prototype.doRender=function(e){if(this.source&&this.width>0&&this.isReady){var t=this.stage,i=t.context,r=t.painter,n=e.state,o=e.pixelRatio,s=n.resolution,a=n.rotation,h=this.resolution/this.pixelRatio/s;if(!(h<.05)){var u=n.toScreen(l,this.x,this.y),c=u[0],d=u[1];!(a+this.rotation)&&h<1.05&&h>.95?this._texture.setSamplingMode(9728):this._texture.setSamplingMode(9729),r.drawImage(i,this._texture,c,d,this.width*h,this.height*h,-Math.PI*a/180,-Math.PI*this.rotation/180,this.opacity*e.globalOpacity,o,e.drawPhase)}}},t}(n.DisplayObject);t.Bitmap=c}.apply(null,r))||(e.exports=n)},1652:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEachIter=function(e,t){for(;;){var i=e.next(),r=i.value;if(i.done)return;t(r)}}}.apply(null,r))||(e.exports=n)},1662:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(45),i(21),i(1393),i(121),i(1700),i(8),i(0),i(20),i(40),i(81),i(51),i(59),i(1552),i(1663),i(1619),i(1625),i(1701),i(1530),i(1702),i(1703),i(1633),i(1669),i(1670),i(1531),i(1672)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h,u,c,d,p,f,v,y,m,g,_,x,b,C,w,T,I,D,L,P){Object.defineProperty(t,"__esModule",{value:!0});var R=new c,O=new Set,M=[],A=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=e.apply(this,t)||this;return r._hiddenGraphics=[],r._tiles=new Map,r._graphicStoreUpdate=!1,r._highlightIDs=new Set,r._graphicsSet=new Set,r._matcher=null,r._tileUpdateSet=new Set,r.lastUpdateId=-1,r.updateRequested=!1,r.graphicUpdateHandler=r.graphicUpdateHandler.bind(r),r._addOrUpdateGraphic=r._addOrUpdateGraphic.bind(r),r._processAnalyzedGraphics=r._processAnalyzedGraphics.bind(r),r._graphicsChangeHandler=r._graphicsChangeHandler.bind(r),r}return i(t,e),t.prototype.initialize=function(){var e=this;this._tileStore=new T.default(this.view.featuresTilingScheme),this.container=new m.default({tileInfoView:this.view.featuresTilingScheme,highlightOptions:this.view.highlightOptions,highlightIDs:this._highlightIDs}),this._graphicStore=new D.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.renderer,this.graphics),this._graphicProcessingQueue=new I.default({process:this._addOrUpdateGraphic});var t=new b.default,i=new w.default(this.container.getMaterialItems,devicePixelRatio);this.renderer&&(this._matcher=x.createMatcher(this.renderer,t,i,null)),this._meshFactory=new C.default(null,this.uid,null,null,this.view.state.pixelRatio,this.view.spatialReference,t,i,null,this._tileStore.tileScheme.tileInfo),this.watch("renderer",function(r){e._graphicStore.renderer=r,r&&(e._matcher=x.createMatcher(e.renderer,t,i,null))}),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.view.watch("highlightOptions.color,highlightOptions.fillOpacity,highlightOptions.haloOpacity",function(){e.container.requestRender()}),this.container.on("attach",function(){var t=e.graphics.toArray();t.sort(function(t,i){return e.graphics.indexOf(i)-e.graphics.indexOf(t)});for(var i=0,r=t;i<r.length;i++){var n=r[i];e._add(n)}e.handles.add(e.graphics.on("change",e._graphicsChangeHandler),"graphics")})},t.prototype.destroy=function(){this._graphicStore.clear(),this._tileStore.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){return this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0},enumerable:!0,configurable:!0}),t.prototype.install=function(e){e.addChild(this.container)},t.prototype.uninstall=function(e){e.removeChild(this.container)},t.prototype.addHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._highlightIDs.add(r)}this._buildHLList()},t.prototype.highlight=function(e){var t=this;return t.addHighlight(e),{remove:function(){t.removeHighlight(e)}}},t.prototype.hitTest=function(e,t){if(!this.view||!this.view.position)return h.resolve(null);this.view.toMap(e,t,R);var i=this._graphicStore.hittest(R.x,R.y,2,this.view.state.resolution,this.view.state.rotation);return 0===i.length?h.resolve(null):h.resolve(i[0])},t.prototype.removeHighlight=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._highlightIDs.delete(r)}this._buildHLList()},t.prototype.setHighlight=function(e){this._highlightIDs.clear(),this.addHighlight(e)},t.prototype.update=function(e){var t=e.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(t.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(t),this._graphicStoreUpdate=!0,this.updateRequested=!1},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},t.prototype.processUpdate=function(e){this.updateRequested&&(this.updateRequested=!1,this.update(e))},t.prototype.graphicUpdateHandler=function(e){var t=e.graphic,i=e.property,r=e.newValue;switch(i){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(t,"update");break;case"visible":this._setVisible(t.uid,r)}},t.prototype._graphicsChangeHandler=function(e){if(!this._graphicStoreUpdate){var t=this.view.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(t.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(t)}for(var r=e.added,n=e.removed,o=e.moved,s=0,a=n;s<a.length;s++){var l=a[s];this._remove(l)}for(var h=0,u=r;h<u.length;h++){var c=u[h];this._add(c)}for(var d=0,p=o;d<p.length;d++){var f=p[d];this._reorder(f)}},t.prototype._buildHLList=function(){for(var e=0,t=this.container.children;e<t.length;e++)t[e].buildHLList(this._highlightIDs);this.container.requestRender()},t.prototype._getSymbolResources=function(e){var t=e.symbol;if(!t&&this.renderer&&(t=this.renderer.getSymbol(e,{scale:this.view.scale})),!t||t&&"text"!==t.type)return h.resolve(null);O.clear();for(var i=t,r=i.text,n=0;n<r.length;n++)O.add(r.charCodeAt(n));M.length=0,O.forEach(function(e){return M.push(e)});var o=[];return o.push({symbol:i.toJSON(),id:0,glyphIds:M}),this.container.getMaterialItems(o).then(function(e){return e.length>0?e[0].mosaicItem:null})},t.prototype._projectAndNormalizeGeometry=function(e){var t=this;if(!e.geometry)return h.resolve(null);var i=e.geometry;if(f.isPolygon(i)){var r=i.rings;i.rings=r}else if(f.isPolyline(i)){var n=i.paths;i.paths=n}else f.isExtent(i)&&(i=d.fromExtent(i));return y.checkProjectionSupport(i.spatialReference,this.view.spatialReference).then(function(){return L.normalizeCentralMeridian(i)}).then(function(e){return y.project(e.toJSON(),e.spatialReference,t.view.spatialReference)}).then(function(e){return L.ensureClosedRings(e),e})},t.prototype._onTileUpdate=function(e){var t=this,i=v.getInfo(this.view.spatialReference);if(e.added&&e.added.length>0)for(var r=this,n=0,o=e.added;n<o.length;n++){!function(e){var n=r._graphicStore.queryTileData(e);if(i)for(var o=Math.round((i.valid[1]-i.valid[0])/e.resolution),s=0,a=n;s<a.length;s++){var l=a[s];l.geometry&&f.isPoint(l.geometry)&&r._wrapPoints(l,o)}r._tileUpdateSet.add(e.key),r.notifyChange("updating"),r._processGraphics(e.key,n).then(function(i){t._addTile(e.key,i),t._tileUpdateSet.delete(e.key),t.notifyChange("updating")}).catch(function(){t._tileUpdateSet.delete(e.key),t.notifyChange("updating")})}(o[n])}if(e.removed&&e.removed.length>0)for(var s=0,a=e.removed;s<a.length;s++){var l=a[s];this._removeTile(l.key)}},t.prototype._add=function(e){this.container.attached&&(this._graphicsSet.add(e),this._graphicProcessingQueue.has(e)&&this._graphicProcessingQueue.cancel(e),this._graphicProcessingQueue.push(e,"add"))},t.prototype._addOrUpdateGraphic=function(e,t){var i=this;return this._projectAndNormalizeGeometry(e).then(function(r){return i._getSymbolResources(e).then(function(n){return"add"===t?i._addProjectedGraphic(e,n,r):i._updateGraphic(e,n,r)})})},t.prototype._addProjectedGraphic=function(e,t,i){var r=this;if(!this._graphicsSet.has(e))return h.resolve();var n=this._graphicStore.add(e,t,i);if(!n||0===p.width(n)&&0===p.height(n))return h.resolve();e.visible||this._hiddenGraphics.push(e.uid);for(var o=[],s=this,a=0,l=this._tileStore.boundsIntersections(n);a<l.length;a++){!function(t){var i=s._getGraphicData(t,e),n=s._processGraphics(t.key,i).then(function(e){r._patchTile(t.key,{addOrUpdate:e,remove:null})});o.push(n)}(l[a])}return h.all(o)},t.prototype._remove=function(e){this._graphicsSet.has(e)&&this._graphicsSet.delete(e),this._graphicProcessingQueue.has(e)&&this._graphicProcessingQueue.cancel(e);var t=this._graphicStore.getBounds(e);if(t){this._graphicStore.remove(e);for(var i=0,r=this._tileStore.boundsIntersections(t);i<r.length;i++){var n=r[i];this._patchTile(n.key,{addOrUpdate:null,remove:[e.uid]})}}},t.prototype._reorder=function(e){var t=this;this._graphicStore.reorder(e);var i=this._graphicStore.getBounds(e);if(0===p.width(i)&&0===p.height(i))return h.resolve();for(var r=[],n=this,o=0,s=this._tileStore.boundsIntersections(i);o<s.length;o++){!function(i){var o=n._getGraphicData(i,e),s=n._processGraphics(i.key,o).then(function(e){t._patchTile(i.key,{addOrUpdate:e,remove:[]})});r.push(s)}(s[o])}return h.all(r)},t.prototype._updateGraphic=function(e,t,i){var r=this;if(!this._graphicStore.has(e))return h.resolve();for(var n=this._graphicStore.update(e,t,i),o=n.oldBounds,s=n.newBounds,a=0===p.width(o)&&0===p.height(o),u=0===p.width(s)&&0===p.height(s),c=a?[]:this._tileStore.boundsIntersections(o),d=u?[]:this._tileStore.boundsIntersections(s),f=l.acquire(),v=0,y=c;v<y.length;v++){var m=y[v];f.set(m.key,{addOrUpdate:null,remove:[e.uid]})}for(var g=0,_=d;g<_.length;g++){m=_[g];var x=this._getGraphicData(m,e);if(f.has(m.key)){var b=f.get(m.key);b.remove.length=0,b.addOrUpdate=x}else f.set(m.key,{addOrUpdate:x,remove:null})}var C=[];return f.forEach(function(e,t){var i=r._processGraphics(t,e.addOrUpdate).then(function(i){r._patchTile(t,{addOrUpdate:i,remove:e.remove})});C.push(i)}),l.release(f),h.all(C)},t.prototype._addTile=function(e,t){var i=p.create();this.view.featuresTilingScheme.getTileBounds(i,e);var r=new _(e,i,!0),n={clear:!0,addOrUpdate:t,remove:[]};r.setData(n,!1,!1),r.buildHLList(this._highlightIDs),this._hiddenGraphics.length>0&&r.setVisibility([],this._hiddenGraphics),this._tiles.set(e,r),this.container.addChild(r)},t.prototype._removeTile=function(e){if(this._tiles.has(e)){var t=this._tiles.get(e);this.container.removeChild(t)}},t.prototype._patchTile=function(e,t){if(this._tiles.has(e)){var i=this._tiles.get(e);i.setData(t,!1,!1),i.buildHLList(this._highlightIDs),this._hiddenGraphics.length>0&&i.setVisibility([],this._hiddenGraphics),this.container.requestRender()}},t.prototype._setVisible=function(e,t){var i=[],r=[],n=this._hiddenGraphics.indexOf(e);if(t){if(-1===n)return;this._hiddenGraphics.splice(n,1),i.push(e)}else{if(-1!==n)return;this._hiddenGraphics.push(e),r.push(e)}for(var o=0,s=this.container.children;o<s.length;o++){var a=s[o];a.data&&a.setVisibility(i,r)}},t.prototype._getGraphicData=function(e,t){var i=this._graphicStore.getGraphicData(e,t),r=[i],n=v.getInfo(this.view.spatialReference);if(n){var o=Math.round((n.valid[1]-n.valid[0])/e.resolution);i.geometry&&f.isPoint(i.geometry)&&this._wrapPoints(i,o)}return r},t.prototype._wrapPoints=function(e,t){var i=e.geometry;512===t?i.x<20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>492&&(e.geometry={points:[[i.x,i.y],[-t,0]]}):i.x<-20?e.geometry={points:[[i.x,i.y],[t,0]]}:i.x>532&&(e.geometry={points:[[i.x,i.y],[-t,0]]})},t.prototype._processGraphics=function(e,t){var i=this;return t&&t.length&&this._meshFactory?this._meshFactory.analyze(t,this._matcher).then(function(t){return i._processAnalyzedGraphics(e,t)}):h.resolve(null)},t.prototype._processAnalyzedGraphics=function(e,t){for(var i=this._meshFactory,r=i.createMeshData(t.length),n=0,o=t;n<o.length;n++){var s=o[n];i.write(r,s,null,null,e.level)}return g.fromMeshData(r)},r([u.property()],t.prototype,"_graphicProcessingQueue",void 0),r([u.property(),u.cast(o.ofType(n))],t.prototype,"graphics",void 0),r([u.property({dependsOn:["_graphicProcessingQueue.updating"]})],t.prototype,"updating",null),r([u.property()],t.prototype,"view",void 0),r([u.property()],t.prototype,"updateRequested",void 0),r([u.subclass("esri.views.2d.layers.support.GraphicsView2D")],t)}(u.declared(P,s,a.Identifiable));t.default=A}.apply(null,r))||(e.exports=n)},1663:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(10),i(25),i(8),i(1425),i(1379),i(1618)],void 0===(n=function(e,t,i,r,n,o,s,a){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var i=e.call(this)||this;return i._displayHeight=0,i._displayWidth=0,i._rendererInfo=new a,i._highlightOptionsUpToDate=!1,i.tileInfoView=t.tileInfoView,i.highlightOptions=t.highlightOptions,i.highlightIDs=t.highlightIDs,i.getMaterialItems=i.getMaterialItems.bind(i),i}return r(t,e),t.prototype.dispose=function(){this.removeAllChildren();for(var e=0,t=this.children;e<t.length;e++)t[e].dispose()},t.prototype.disposeWebGLResources=function(){for(var e=0,t=this.children;e<t.length;e++)t[e].clear()},t.prototype.displayWidth=function(){return this._displayWidth},Object.defineProperty(t.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(e){this._highlightOptions=e,this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0}),t.prototype.setVisibility=function(e,t){},t.prototype.getMaterialItems=function(e){var t=e;if(t&&0!==t.length){for(var i=[],r=this.stage.painter.textureManager,o=0,s=t;o<s.length;o++){var a=s[o];i.push(r.rasterizeItem(a.symbol,a.glyphIds))}return n.all(i).then(function(e){return e.map(function(e,i){return{id:t[i].id,mosaicItem:e}})})}},t.prototype.renderChildren=function(e){var t=this.stage.painter;if(this._updateTilesTransform(e.state,this.tileInfoView.getClosestInfoForScale(e.state.scale).level),this._updateHighlightOptions(),e.drawPhase===s.WGLDrawPhase.MAP){var r=this.tileInfoView.getClosestInfoForScale(e.state.scale).level,n=this.tileInfoView.tileInfo.scaleToZoom(e.state.scale),o=this._rendererInfo,a=i({},e,{rendererInfo:o,requiredLevel:r,displayLevel:n,context:this.stage.context,painter:t});this.sortChildren(function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col});var l=a.drawPhase;t.draw(a,this.children,l,null),0<this.highlightIDs.size&&t.highlight(a,this.children)}},t.prototype._updateTilesTransform=function(e,t){for(var i=0,r=this.children;i<r.length;i++){var n=r[i],o=this.tileInfoView.tileInfo.lods[n.key.level].resolution/(e.resolution*e.pixelRatio);n.setTransform(e,o)}},t.prototype._updateHighlightOptions=function(){if(!this._highlightOptionsUpToDate&&this.parent&&this._highlightOptions){var e=this.stage.painter,t=this._highlightOptions;if(e){var i=t.color.toRgba();i[0]/=255,i[1]/=255,i[2]/=255;var r=i.slice();i[3]*=t.fillOpacity,r[3]*=t.haloOpacity,e.setHighlightOptions({fillColor:i,outlineColor:r,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0}),this._highlightOptionsUpToDate=!0}}},t}(o.Container);t.default=l}.apply(null,r))||(e.exports=n)},1666:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(1526)],void 0===(n=function(e,t,i){return function(){function e(e,t,i,r,n,o,s,a){this._glyphItems=e,this._maxWidth=t,this._lineHeight=i,this._letterSpacing=r,this._offset=n,this._hAnchor=o,this._vAnchor=s,this._justify=a}return e.prototype.getShaping=function(e,t){for(var i=this._letterSpacing,r=this._lineHeight,n=this._justify,o=this._maxWidth,s=[],a=0,l=0,h=0,u=0,c=-1,d=0,p=-1,f=e.length,v=0;v<f;v++){var y=e.charCodeAt(v);if(10!==y){for(var m=void 0,g=0,_=this._glyphItems;g<_.length&&!(m=_[g][y]);g++);if(m){if(s.push({codePoint:y,x:a,y:l,glyphMosaicItem:m}),a+=m.metrics.advance+i,0<o&&o<a&&0<=p){var x=p+1;C=s[x].x,d=Math.max(C,d);for(var b=x;b<s.length;b++)t?s[b].y-=r:s[b].y+=r,s[b].x-=C;n&&this._applyJustification(s,u,p),t?l-=r:l+=r,a-=C,++h,u=x,p=-1}++c,32===y&&(p=s.length-1)}}else{if(v===f-1)continue;if(u<=c){var C=(w=s[c]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(C,d),n&&this._applyJustification(s,u,c),u=s.length}t?l-=r:l+=r,a=0,++h}}if(u<=c){var w,T=(w=s[c]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(d,T),n&&this._applyJustification(s,u,c)}if(0<s.length){var I=(n-this._hAnchor)*d,D=(-this._vAnchor*(h+1)+.5)*r;t&&h&&(D+=h*r),I+=this._offset[0],D+=this._offset[1];for(var L=0,P=s;L<P.length;L++){var R=P[L];R.x+=I,R.y+=D}}return s},e.getBox=function(e){if(!e.length)return null;for(var t=1/0,i=1/0,r=0,n=0,o=0,s=e;o<s.length;o++){var a=s[o],l=a.glyphMosaicItem.metrics,h=l.height,u=l.left,c=l.top,d=l.width,p=a.x,f=a.y-(h-Math.abs(c)),v=p+d+u,y=f+h;t=Math.min(t,p),r=Math.max(r,v),i=Math.min(i,f),n=Math.max(n,y)}return{x:t,y:i,width:r-t,height:n-i}},e.addDecoration=function(e,t){var r=e.length;if(0!==r){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,s=1;s<r;s++){var a=e[s];if(a.y!==o){var l=e[s-1].x+e[s-1].glyphMosaicItem.metrics.left+e[s-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new i(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0}}),o=a.y,n=a.x+a.glyphMosaicItem.metrics.left}}var h=e[r-1].x+e[r-1].glyphMosaicItem.metrics.left+e[r-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new i(4,0,4,8),metrics:{width:h-n,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,i){for(var r=e[i],n=r.glyphMosaicItem.metrics.advance,o=(r.x+n)*this._justify,s=t;s<=i;s++)e[s].x-=o},e}()}.apply(null,r))||(e.exports=n)},1667:function(e,t,i){var r,n;r=[i.dj.c(e.i),t],void 0===(n=function(e,t){var i,r,n,o;Object.defineProperty(t,"__esModule",{value:!0}),(r=i=t.VectorRole||(t.VectorRole={}))[r.ENTRY=1]="ENTRY",r[r.EXIT=2]="EXIT",r[r.CAP=3]="CAP",(o=n=t.CapPosition||(t.CapPosition={}))[o.START=1]="START",o[o.END=2]="END",t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var s=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,a=-1,l=8/(2*Math.PI);function h(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push(void 0);return i}t.allocTriangles=function(e){var t,i={items:new Array,count:0};for(t=0;t<e;++t)i.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return i},t.allocExtrudeVectors=function(){var e=function(e){var t,i={items:new Array,count:0};for(t=0;t<30;++t)i.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return i}(),t={};return t[i.ENTRY]=h(20),t[i.EXIT]=h(20),t[i.CAP]=h(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var r;for(r=0;r<t.vectors.count;++r)e.vectors.items[r].vector[0]=t.vectors.items[r].vector[0],e.vectors.items[r].vector[1]=t.vectors.items[r].vector[1],e.vectors.items[r].texCoords[0]=t.vectors.items[r].texCoords[0],e.vectors.items[r].texCoords[1]=t.vectors.items[r].texCoords[1],e.vectors.items[r].direction[0]=t.vectors.items[r].direction[0],e.vectors.items[r].direction[1]=t.vectors.items[r].direction[1],e.vectors.items[r].base=t.vectors.items[r].base;e.vectors.count=t.vectors.count;var n=t.lists[i.ENTRY],o=e.lists[i.ENTRY],s=t.lists[i.EXIT],a=e.lists[i.EXIT],l=t.lists[i.CAP],h=e.lists[i.CAP];for(r=0;r<n.count;++r)o.items[r]=n.items[r];for(o.count=n.count,r=0;r<s.count;++r)a.items[r]=s.items[r];for(a.count=s.count,r=0;r<l.count;++r)h.items[r]=l.items[r];h.count=l.count,e.capCenter=t.capCenter};var u={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};function c(e,t){u.vector[0]=e.vector[0],u.vector[1]=e.vector[1],u.texCoords[0]=e.texCoords[0],u.texCoords[1]=e.texCoords[1],u.direction[0]=e.direction[0],u.direction[1]=e.direction[1],u.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=u.vector[0],t.vector[1]=u.vector[1],t.texCoords[0]=u.texCoords[0],t.texCoords[1]=u.texCoords[1],t.direction[0]=u.direction[0],t.direction[1]=u.direction[1],t.base=u.base}t.swapExtrudeVectors=c;var d,p=[];for(d=0;d<32;++d)p.push([void 0,void 0]);var f=function(e){var t,i={items:new Array,count:0};for(t=0;t<8;++t)i.items.push([void 0,void 0]);return i}();function v(e,t){return e[0]*t[0]+e[1]*t[1]}function y(e){return Math.sqrt(v(e,e))}function m(e,t){var i=y(t);return e[0]=t[0]/i,e[1]=t[1]/i,e}function g(e,t){return e[0]=-t[1],e[1]=t[0],e}function _(e,t){return e[0]*t[1]-e[1]*t[0]}function x(e,t){return e[0]=-t[0],e[1]=-t[1],e}function b(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function C(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function w(e,t,i){return r=e,o=i,((n=t)[0]-r[0])*(o[1]-r[1])-(o[0]-r[0])*(n[1]-r[1])<0;var r,n,o}function T(e,t){var i=v(e,t);return.999<i?0:i<-.999?Math.PI:Math.acos(i)}function I(e,t,i,r,n){if(0!==r){var o,s=y(t),a=(n?-1:1)*T(b(p[0],t,1/s),b(p[1],i,1/s))/r,l=Math.cos(a),h=Math.sin(a),u=t[0],c=t[1];for(o=0;o<r-1;++o){var d=u;u=l*d-h*c,c=h*d+l*c,e.items[o][0]=u,e.items[o][1]=c}e.count=r-1}else e.count=0}function D(e){var t,i=e.count,r=Math.floor(i/2);for(t=0;t<r;++t){var n=e.items[t];e.items[t]=e.items[i-t-1],e.items[i-t-1]=n}}t.length=y,t.normalize=m,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*l),1)},t.getRads=T,t.reverse=D;var L=[void 0,void 0],P=[void 0,void 0],R=[0,0],O=[0,0],M=[0,0],A=[0,0],S=Math.cos(Math.PI/4),G=Math.sin(Math.PI/4),B=Math.sqrt(2),E=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,r){var n,o,s,a,l=t.vectors,h=t.lists[i.EXIT],u=r.vectors,d=r.lists[i.ENTRY];if(h.count===d.count+1)n=h.items,o=l.items,s=d.items,a=u.items;else if(d.count===h.count+1)n=d.items,o=u.items,s=h.items,a=l.items;else{if(h.count!==d.count)return console.error("Cannot bridge "+h.count+" to "+d.count+"."),void(e.count=0);n=d.items,o=u.items,s=h.items,a=l.items}var p,f=h.count+d.count-2;for(e.count=f,L[0]=n,L[1]=s,P[0]=o,P[1]=a,p=0;p<f;++p){var v=e.items[p],y=(p+0)%2,m=Math.floor((p+0)/2),g=P[y][L[y][m]];v.v1.vector[0]=g.vector[0],v.v1.vector[1]=g.vector[1],v.v1.texCoords[0]=g.texCoords[0],v.v1.texCoords[1]=g.texCoords[1],v.v1.direction[0]=g.direction[0],v.v1.direction[1]=g.direction[1],v.v1.base=g.base;var _=(p+1)%2,x=Math.floor((p+1)/2),b=P[_][L[_][x]];v.v2.vector[0]=b.vector[0],v.v2.vector[1]=b.vector[1],v.v2.texCoords[0]=b.texCoords[0],v.v2.texCoords[1]=b.texCoords[1],v.v2.direction[0]=b.direction[0],v.v2.direction[1]=b.direction[1],v.v2.base=b.base;var C=(p+2)%2,T=Math.floor((p+2)/2),I=P[C][L[C][T]];v.v3.vector[0]=I.vector[0],v.v3.vector[1]=I.vector[1],v.v3.texCoords[0]=I.texCoords[0],v.v3.texCoords[1]=I.texCoords[1],v.v3.direction[0]=I.direction[0],v.v3.direction[1]=I.direction[1],v.v3.base=I.base;var D=v.v1.base&&v.v1.base.point||R,S=v.v2.base&&v.v2.base.point||R,G=v.v3.base&&v.v3.base.point||R;O[0]=D[0]+v.v1.vector[0],O[1]=D[1]+v.v1.vector[1],M[0]=S[0]+v.v2.vector[0],M[1]=S[1]+v.v2.vector[1],A[0]=G[0]+v.v3.vector[0],A[1]=G[1]+v.v3.vector[1],w(O,M,A)||c(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[i.CAP].count){if(1===t.lists[i.CAP].count)return console.error("A single vector is not enough to define a pie."),void(e.count=0);var r;for(e.count=t.lists[i.CAP].count-1,r=0;r<e.count;++r){var n=e.items[r],o=t.lists[i.CAP].items[r],s=t.vectors.items[o];n.v1.vector[0]=s.vector[0],n.v1.vector[1]=s.vector[1],n.v1.texCoords[0]=s.texCoords[0],n.v1.texCoords[1]=s.texCoords[1],n.v1.direction[0]=s.direction[0],n.v1.direction[1]=s.direction[1],n.v1.base=s.base;var a=t.lists[i.CAP].items[r+1],l=t.vectors.items[a];n.v2.vector[0]=l.vector[0],n.v2.vector[1]=l.vector[1],n.v2.texCoords[0]=l.texCoords[0],n.v2.texCoords[1]=l.texCoords[1],n.v2.direction[0]=l.direction[0],n.v2.direction[1]=l.direction[1],n.v2.base=l.base;var h=t.capCenter,u=t.vectors.items[h];n.v3.vector[0]=u.vector[0],n.v3.vector[1]=u.vector[1],n.v3.texCoords[0]=u.texCoords[0],n.v3.texCoords[1]=u.texCoords[1],n.v3.direction[0]=u.direction[0],n.v3.direction[1]=u.direction[1],n.v3.base=u.base;var d=n.v1.base&&n.v1.base.point||R,p=n.v2.base&&n.v2.base.point||R,f=n.v3.base&&n.v3.base.point||R;O[0]=d[0]+n.v1.vector[0],O[1]=d[1]+n.v1.vector[1],M[0]=p[0]+n.v2.vector[0],M[1]=p[1]+n.v2.vector[1],A[0]=f[0]+n.v3.vector[0],A[1]=f[1]+n.v3.vector[1],w(O,M,A)||c(n.v2,n.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,i){this.fastMiterJoin(e,t,i)},e.prototype.roundCap=function(e,t,r,o,s,a){void 0===a&&(a=0),this.fastMiterJoin(e,t,r);var l=o===n.START?0:1,h=o===n.START?1:0;e.capCenter=e.vectors.count;var u=e.vectors.items[e.capCenter];u.vector[0]=0,u.vector[1]=0,u.texCoords[0]=0,u.texCoords[1]=0,u.direction[0]=0,u.direction[1]=0,++e.vectors.count,I(f,e.vectors.items[l].vector,e.vectors.items[h].vector,s,!1);var c=e.vectors.count,d=e.lists[i.CAP];d.items[0]=l;var p,v=e.vectors.items[l].texCoords[1],y=e.vectors.items[h].texCoords[1];for(p=0;p<f.count;++p){var m=a*(1-Math.abs(f.count/2-p)/(f.count/2)),g=v+p/(f.count-1)*(y-v),_=f.items[p],x=e.vectors.items[c+p];x.vector[0]=_[0],x.vector[1]=_[1],x.texCoords[0]=m,x.texCoords[1]=g,x.direction[0]=0,x.direction[1]=0,d.items[p+1]=c+p}d.items[f.count+1]=h,d.count=f.count+2,e.vectors.count=c+f.count},e.prototype.squareCap=function(e,t,i,r){this.fastMiterJoin(e,t,i);var o=r===n.START?0:1,s=r===n.START?1:0,a=p[0],l=p[1],h=p[2],u=p[3],c=p[4],d=e.vectors.items[o].vector;a[0]=S*d[0]-G*d[1],a[1]=G*d[0]+S*d[1],b(u,a,B),l[0]=S*a[0]-G*a[1],l[1]=G*a[0]+S*a[1],h[0]=S*l[0]-G*l[1],h[1]=G*l[0]+S*l[1],b(c,h,B);var f=e.vectors.items[o];f.vector[0]=u[0],f.vector[1]=u[1];var v=e.vectors.items[s];v.vector[0]=c[0],v.vector[1]=c[1]},e.prototype.squareCapForDashedLines=function(e,t,r,o){if(o===n.START){var s=g(p[0],r),a=x(p[4],s),l=p[1],h=p[2],u=p[3];l[0]=S*s[0]-G*s[1],l[1]=G*s[0]+S*s[1],h[0]=S*l[0]-G*l[1],h[1]=G*l[0]+S*l[1],u[0]=S*h[0]-G*h[1],u[1]=G*h[0]+S*h[1],(c=p[5])[0]=0,c[1]=0,e.capCenter=0,(d=e.vectors.items)[0].vector[0]=c[0],d[0].vector[1]=c[1],d[0].direction[0]=0,d[0].direction[1]=0,d[0].texCoords[0]=0,d[0].texCoords[1]=0,d[1].vector[0]=s[0],d[1].vector[1]=s[1],d[1].direction[0]=0,d[1].direction[1]=0,d[1].texCoords[0]=0,d[1].texCoords[1]=-1,d[2].vector[0]=l[0]*B,d[2].vector[1]=l[1]*B,d[2].direction[0]=0,d[2].direction[1]=0,d[2].texCoords[0]=-1,d[2].texCoords[1]=-1,d[3].vector[0]=u[0]*B,d[3].vector[1]=u[1]*B,d[3].direction[0]=0,d[3].direction[1]=0,d[3].texCoords[0]=-1,d[3].texCoords[1]=1,d[4].vector[0]=a[0],d[4].vector[1]=a[1],d[4].direction[0]=0,d[4].direction[1]=0,d[4].texCoords[0]=0,d[4].texCoords[1]=1,e.vectors.count=5,e.lists[i.CAP].count=4,e.lists[i.CAP].items[0]=1,e.lists[i.CAP].items[1]=2,e.lists[i.CAP].items[2]=3,e.lists[i.CAP].items[3]=4,e.lists[i.ENTRY].count=0,e.lists[i.EXIT].count=3,e.lists[i.EXIT].items[0]=1,e.lists[i.EXIT].items[1]=0,e.lists[i.EXIT].items[2]=4}else{var c,d;s=g(p[0],r),a=x(p[4],s),l=p[1],h=p[2],u=p[3],l[0]=S*a[0]-G*a[1],l[1]=G*a[0]+S*a[1],h[0]=S*l[0]-G*l[1],h[1]=G*l[0]+S*l[1],u[0]=S*h[0]-G*h[1],u[1]=G*h[0]+S*h[1],(c=p[5])[0]=0,c[1]=0,e.capCenter=0,(d=e.vectors.items)[0].vector[0]=c[0],d[0].vector[1]=c[1],d[0].direction[0]=0,d[0].direction[1]=0,d[0].texCoords[0]=0,d[0].texCoords[1]=0,d[1].vector[0]=a[0],d[1].vector[1]=a[1],d[1].direction[0]=0,d[1].direction[1]=0,d[1].texCoords[0]=0,d[1].texCoords[1]=1,d[2].vector[0]=l[0]*B,d[2].vector[1]=l[1]*B,d[2].direction[0]=0,d[2].direction[1]=0,d[2].texCoords[0]=1,d[2].texCoords[1]=1,d[3].vector[0]=u[0]*B,d[3].vector[1]=u[1]*B,d[3].direction[0]=0,d[3].direction[1]=0,d[3].texCoords[0]=1,d[3].texCoords[1]=-1,d[4].vector[0]=s[0],d[4].vector[1]=s[1],d[4].direction[0]=0,d[4].direction[1]=0,d[4].texCoords[0]=0,d[4].texCoords[1]=-1,e.vectors.count=5,e.lists[i.CAP].count=4,e.lists[i.CAP].items[0]=1,e.lists[i.CAP].items[1]=2,e.lists[i.CAP].items[2]=3,e.lists[i.CAP].items[3]=4,e.lists[i.ENTRY].count=3,e.lists[i.ENTRY].items[0]=4,e.lists[i.ENTRY].items[1]=0,e.lists[i.ENTRY].items[2]=1,e.lists[i.EXIT].count=0}},e.prototype.fastMiterJoin=function(e,t,r){var n=g(p[0],r),o=n,s=x(p[1],n),l=e.vectors.items[0];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=a,l.direction[0]=0,l.direction[1]=0;var h=e.vectors.items[1];h.vector[0]=s[0],h.vector[1]=s[1],h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=0,h.direction[1]=0,e.vectors.count=2;var u=e.lists[i.ENTRY];u.items[0]=0,u.items[1]=1,u.count=2;var c=e.lists[i.EXIT];c.items[0]=0,c.items[1]=1,c.count=2,e.lists[i.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,r){var n=g(p[0],t),o=g(p[1],r),s=p[2];s[0]=n[0]+o[0],s[1]=n[1]+o[1];var l=m(p[3],s),h=v(l,n);l=b(p[4],l,1/h);var u=x(p[5],l);if(this._distanceAlongCorrection){(f=e.vectors.items[0]).vector[0]=l[0],f.vector[1]=l[1],f.texCoords[0]=0,f.texCoords[1]=a,f.direction[0]=t[0],f.direction[1]=t[1],(y=e.vectors.items[1]).vector[0]=u[0],y.vector[1]=u[1],y.texCoords[0]=0,y.texCoords[1]=1,y.direction[0]=t[0],y.direction[1]=t[1];var c=e.vectors.items[2];c.vector[0]=l[0],c.vector[1]=l[1],c.texCoords[0]=0,c.texCoords[1]=a,c.direction[0]=r[0],c.direction[1]=r[1];var d=e.vectors.items[3];d.vector[0]=u[0],d.vector[1]=u[1],d.texCoords[0]=0,d.texCoords[1]=1,d.direction[0]=r[0],d.direction[1]=r[1],e.vectors.count=4,(_=e.lists[i.ENTRY]).items[0]=0,_.items[1]=1,_.count=2,(C=e.lists[i.EXIT]).items[0]=2,C.items[1]=3,C.count=2}else{var f,y,_,C;(f=e.vectors.items[0]).vector[0]=l[0],f.vector[1]=l[1],f.texCoords[0]=0,f.texCoords[1]=a,f.direction[0]=0,f.direction[1]=0,(y=e.vectors.items[1]).vector[0]=u[0],y.vector[1]=u[1],y.texCoords[0]=0,y.texCoords[1]=1,y.direction[0]=0,y.direction[1]=0,e.vectors.count=2,(_=e.lists[i.ENTRY]).items[0]=0,_.items[1]=1,_.count=2,(C=e.lists[i.EXIT]).items[0]=0,C.items[1]=1,C.count=2}e.lists[i.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,r,n){var o=n*n,l=_(t,r),h=0<l?[a,1]:[1,a],u=h[0],c=h[1],d=0<l?x(p[0],g(p[1],t)):g(p[2],t),f=0<l?x(p[3],g(p[4],r)):g(p[5],r),y=p[6];y[0]=d[0]+f[0],y[1]=d[1]+f[1];var w=m(p[7],y),T=x(p[8],w),I=v(w,d),L=_(w,d),P=Math.abs(L/I),R=1+P*P,O=R<s?[P,this._distanceAlongCorrection]:[Math.sqrt(s-1),!0],M=O[0],A=O[1],S=R<o?[P,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],G=S[0],B=S[1];if(B&&A){C((z=e.vectors.items[0]).vector,x(p[9],d),b(p[10],x(p[11],t),M)),z.texCoords[0]=0,z.texCoords[1]=u,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0,C((N=e.vectors.items[1]).vector,x(p[12],f),b(p[13],r,M)),N.texCoords[0]=0,N.texCoords[1]=u,N.direction[0]=this._distanceAlongCorrection?r[0]:0,N.direction[1]=this._distanceAlongCorrection?r[1]:0,(F=e.vectors.items[2]).vector[0]=0,F.vector[1]=0,F.texCoords[0]=0,F.texCoords[1]=0,F.direction[0]=0,F.direction[1]=0,C((j=e.vectors.items[3]).vector,d,b(p[14],t,G)),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=this._distanceAlongCorrection?t[0]:0,j.direction[1]=this._distanceAlongCorrection?t[1]:0;var E=e.vectors.items[4];C(E.vector,f,b(p[15],x(p[16],r),G)),E.texCoords[0]=0,E.texCoords[1]=c,E.direction[0]=this._distanceAlongCorrection?r[0]:0,E.direction[1]=this._distanceAlongCorrection?r[1]:0,e.vectors.count=5,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,(q=e.lists[i.EXIT]).items[0]=1,q.items[1]=2,q.items[2]=4,q.count=3,R<o?((V=e.lists[i.CAP]).count=0,e.capCenter=void 0):((V=e.lists[i.CAP]).items[0]=3,V.items[1]=4,V.count=2,e.capCenter=2)}else if(!B&&A)C((z=e.vectors.items[0]).vector,x(p[9],d),b(p[10],x(p[11],t),M)),z.texCoords[0]=0,z.texCoords[1]=u,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0,C((N=e.vectors.items[1]).vector,x(p[12],f),b(p[13],r,M)),N.texCoords[0]=0,N.texCoords[1]=u,N.direction[0]=this._distanceAlongCorrection?r[0]:0,N.direction[1]=this._distanceAlongCorrection?r[1]:0,(F=e.vectors.items[2]).vector[0]=0,F.vector[1]=0,F.texCoords[0]=0,F.texCoords[1]=0,F.direction[0]=0,F.direction[1]=0,b((j=e.vectors.items[3]).vector,w,1/I),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=0,j.direction[1]=0,e.vectors.count=4,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=2,k.items[2]=3,k.count=3,(q=e.lists[i.EXIT]).items[0]=1,q.items[1]=2,q.items[2]=3,q.count=3,e.lists[i.CAP].count=0,e.capCenter=void 0;else if(B&&!A){var F,j,V;b((z=e.vectors.items[0]).vector,T,1/I),z.texCoords[0]=0,z.texCoords[1]=u,z.direction[0]=0,z.direction[1]=0,(N=e.vectors.items[1]).vector[0]=0,N.vector[1]=0,N.texCoords[0]=0,N.texCoords[1]=0,N.direction[0]=0,N.direction[1]=0,C((F=e.vectors.items[2]).vector,d,b(p[9],t,G)),F.texCoords[0]=0,F.texCoords[1]=c,F.direction[0]=this._distanceAlongCorrection?t[0]:0,F.direction[1]=this._distanceAlongCorrection?t[1]:0,C((j=e.vectors.items[3]).vector,f,b(p[10],x(p[11],r),G)),j.texCoords[0]=0,j.texCoords[1]=c,j.direction[0]=this._distanceAlongCorrection?r[0]:0,j.direction[1]=this._distanceAlongCorrection?r[1]:0,e.vectors.count=4,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=1,k.items[2]=2,k.count=3,(q=e.lists[i.EXIT]).items[0]=0,q.items[1]=1,q.items[2]=3,q.count=3,R<o?((V=e.lists[i.CAP]).count=0,e.capCenter=void 0):((V=e.lists[i.CAP]).items[0]=2,V.items[1]=3,V.count=2,e.capCenter=1)}else if(!B&&!A){var z,N,k,q;b((z=e.vectors.items[0]).vector,T,1/I),z.texCoords[0]=0,z.texCoords[1]=u,z.direction[0]=0,z.direction[1]=0,b((N=e.vectors.items[1]).vector,w,1/I),N.texCoords[0]=0,N.texCoords[1]=c,N.direction[0]=0,N.direction[1]=0,e.vectors.count=2,(k=e.lists[i.ENTRY]).items[0]=0,k.items[1]=1,k.count=2,(q=e.lists[i.EXIT]).items[0]=0,q.items[1]=1,q.count=2,e.lists[i.CAP].count=0,e.capCenter=void 0}l<0&&(D(e.lists[i.ENTRY]),D(e.lists[i.EXIT]))},e.prototype.roundJoin=function(e,t,r,n){var o=_(t,r),l=0<o?[a,1]:[1,a],h=l[0],u=l[1],c=0<o?x(p[0],g(p[1],t)):g(p[2],t),d=0<o?x(p[3],g(p[4],r)):g(p[5],r),y=p[6];y[0]=c[0]+d[0],y[1]=c[1]+d[1];var w=m(p[7],y),T=x(p[8],w),L=v(w,c),P=_(w,c),R=Math.abs(P/L),O=1+R*R<s?[R,this._distanceAlongCorrection]:[Math.sqrt(s-1),!0],M=O[0];if(O[1]){(S=e.vectors.items[0]).vector[0]=c[0],S.vector[1]=c[1],S.texCoords[0]=0,S.texCoords[1]=u,S.direction[0]=0,S.direction[1]=0,(G=e.vectors.items[1]).vector[0]=d[0],G.vector[1]=d[1],G.texCoords[0]=0,G.texCoords[1]=u,G.direction[0]=0,G.direction[1]=0,C((B=e.vectors.items[2]).vector,x(p[9],c),b(p[10],x(p[11],t),M)),B.texCoords[0]=0,B.texCoords[1]=h,B.direction[0]=this._distanceAlongCorrection?t[0]:0,B.direction[1]=this._distanceAlongCorrection?t[1]:0,C((E=e.vectors.items[3]).vector,x(p[12],d),b(p[13],r,M)),E.texCoords[0]=0,E.texCoords[1]=h,E.direction[0]=this._distanceAlongCorrection?r[0]:0,E.direction[1]=this._distanceAlongCorrection?r[1]:0;var A=e.vectors.items[4];A.vector[0]=0,A.vector[1]=0,A.texCoords[0]=0,A.texCoords[1]=0,A.direction[0]=0,A.direction[1]=0,e.vectors.count=5,(F=e.lists[i.ENTRY]).items[0]=2,F.items[1]=4,F.items[2]=0,F.count=3,(j=e.lists[i.EXIT]).items[0]=3,j.items[1]=4,j.items[2]=1,j.count=3,e.capCenter=4}else{var S,G,B,E,F,j;(S=e.vectors.items[0]).vector[0]=c[0],S.vector[1]=c[1],S.texCoords[0]=0,S.texCoords[1]=u,S.direction[0]=0,S.direction[1]=0,(G=e.vectors.items[1]).vector[0]=d[0],G.vector[1]=d[1],G.texCoords[0]=0,G.texCoords[1]=u,G.direction[0]=0,G.direction[1]=0,b((B=e.vectors.items[2]).vector,T,1/L),B.texCoords[0]=0,B.texCoords[1]=h,B.direction[0]=0,B.direction[1]=0,(E=e.vectors.items[3]).vector[0]=0,E.vector[1]=0,E.texCoords[0]=0,E.texCoords[1]=0,E.direction[0]=0,E.direction[1]=0,e.vectors.count=4,(F=e.lists[i.ENTRY]).items[0]=2,F.items[1]=3,F.items[2]=0,F.count=3,(j=e.lists[i.EXIT]).items[0]=2,j.items[1]=3,j.items[2]=1,j.count=3,e.capCenter=3}I(f,c,d,n,o<0);var V,z=e.vectors.count,N=e.lists[i.CAP];for(V=N.items[0]=0;V<f.count;++V){var k=f.items[V],q=e.vectors.items[z+V];q.vector[0]=k[0],q.vector[1]=k[1],q.texCoords[0]=0,q.texCoords[1]=u,q.direction[0]=0,q.direction[1]=0,N.items[V+1]=z+V}N.items[f.count+1]=1,N.count=f.count+2,e.vectors.count=z+f.count,o<0&&(D(e.lists[i.ENTRY]),D(e.lists[i.EXIT]))},e.prototype.unitRoundJoin=function(e,t,r,n){var o=_(t,r),s=0<o?[a,1]:[1,a],l=s[0],h=s[1],u=0<o?x(p[0],g(p[1],t)):g(p[2],t),c=0<o?x(p[3],g(p[4],r)):g(p[5],r),d=e.vectors.items[0];d.vector[0]=u[0],d.vector[1]=u[1],d.texCoords[0]=0,d.texCoords[1]=h,d.direction[0]=0,d.direction[1]=0;var v=e.vectors.items[1];v.vector[0]=c[0],v.vector[1]=c[1],v.texCoords[0]=0,v.texCoords[1]=h,v.direction[0]=0,v.direction[1]=0;var y=e.vectors.items[2];x(y.vector,u),y.texCoords[0]=0,y.texCoords[1]=l,y.direction[0]=0,y.direction[1]=0;var m=e.vectors.items[3];x(m.vector,c),m.texCoords[0]=0,m.texCoords[1]=l,m.direction[0]=0,m.direction[1]=0;var b=e.vectors.items[4];b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,e.vectors.count=5;var C=e.lists[i.ENTRY];C.items[0]=2,C.items[1]=0,C.count=2;var w=e.lists[i.EXIT];w.items[0]=3,w.items[1]=1,w.count=2,e.capCenter=4,I(f,u,c,n,o<0);var T,L=e.vectors.count,P=e.lists[i.CAP];for(T=P.items[0]=0;T<f.count;++T){var R=f.items[T],O=e.vectors.items[L+T];O.vector[0]=R[0],O.vector[1]=R[1],O.texCoords[0]=0,O.texCoords[1]=h,O.direction[0]=0,O.direction[1]=0,P.items[T+1]=L+T}P.items[f.count+1]=1,P.count=f.count+2,e.vectors.count=L+f.count,o<0&&(D(e.lists[i.ENTRY]),D(e.lists[i.EXIT]))},e.prototype.rectJoin=function(e,t,r){var n=g(p[0],t),o=g(p[1],r),s=e.vectors.items[0];s.vector[0]=n[0],s.vector[1]=n[1],s.texCoords[0]=0,s.texCoords[1]=a,s.direction[0]=0,s.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=a,l.direction[0]=0,l.direction[1]=0;var h=e.vectors.items[2];x(h.vector,n),h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=0,h.direction[1]=0;var u=e.vectors.items[3];x(u.vector,o),u.texCoords[0]=0,u.texCoords[1]=1,u.direction[0]=0,u.direction[1]=0,e.vectors.count=4;var c=e.lists[i.ENTRY];c.items[0]=0,c.items[1]=2,c.count=2;var d=e.lists[i.EXIT];d.items[0]=1,d.items[1]=3,d.count=2,e.capCenter=void 0},e}();t.Tessellator=E}.apply(null,r))||(e.exports=n)},1669:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(5),i(44),i(0)],void 0===(n=function(e,t,i,r,n,o,s){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var i=e.call(this,t)||this;return i._queue=new Map,i._onGoingGraphic=null,i._onGoingPromise=null,i._scheduledNextHandle=null,i._timestamp=Date.now(),i._next=i._next.bind(i),i._finalize=i._finalize.bind(i),i}return i(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queue.size>0||null!==this._onGoingPromise},enumerable:!0,configurable:!0}),t.prototype.cancel=function(e){this._onGoingGraphic&&this._onGoingGraphic.graphic===e&&(this._onGoingPromise.cancel(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.delete(e),this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._onGoingPromise&&(this._onGoingPromise.cancel(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingGraphic&&this._onGoingGraphic.graphic===e},t.prototype.push=function(e,t,i){this._queue.has(e)||(this._queue.set(e,{graphic:e,addOrUpdate:t,timestamp:i||this._timestamp}),this._scheduleNext(),this.notifyChange("updating"))},t.prototype.refresh=function(){this._timestamp=Date.now(),this.reset()},t.prototype.reset=function(){var e=this._onGoingGraphic;if(e){var t=e.graphic,i=e.addOrUpdate;this.push(t,i,this._timestamp)}},t.prototype._finalize=function(){this._onGoingGraphic=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=o.schedule(this._next))},t.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var e=this._peek(),t=e.graphic,i=e.addOrUpdate;this._queue.delete(t),this._onGoingGraphic=e,this._onGoingPromise=this.process(t,i,this._timestamp),this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},t.prototype._peek=function(){var e=this,t=Number.NEGATIVE_INFINITY,i=null;return this._queue.forEach(function(r,n){var o=e._timestamp-r.timestamp;isNaN(o)?i=r:o===t?i=r:o>t&&(t=o,i=r)}),i},r([s.property({readOnly:!0})],t.prototype,"length",null),r([s.property({readOnly:!0})],t.prototype,"updating",null),r([s.property({constructOnly:!0})],t.prototype,"process",void 0),r([s.subclass()],t)}(s.declared(n));t.default=a}.apply(null,r))||(e.exports=n)},1670:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(10),i(1426),i(16),i(26),i(1554),i(81),i(85),i(51),i(166),i(1652),i(1671),i(1531),i(1402)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h,u,c,d,p,f){function v(e,t,i,r,n){return y.minX=t,y.minY=i,y.maxX=r,y.maxY=n,e.search(y)}Object.defineProperty(t,"__esModule",{value:!0});var y={minX:0,minY:0,maxX:0,maxY:0},m=a.create(),g=a.create(),_=function(){function e(e,t,i,o,a){this.renderer=o,this._graphics=a,this._index=s(9,n("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new r.default,this._currentLevel=-1/0,this._tileInfoView=e,this._uidFieldName=i;var l=e.getClosestInfoForScale(t);l&&(this._currentLevel=l.level,this._resolution=this._tileInfoView.getTileResolution(l.level)),this._updateGraphicZorder=this._updateGraphicZorder.bind(this)}return e.prototype.hittest=function(e,t,i,r,n){e=u.normalizeMapX(e,this._tileInfoView.spatialReference);var s=.5*r*i;g[0]=e-s,g[1]=t-s,g[2]=e+s,g[3]=t+s;var c=.5*r*(i+50),d=v(this._index,e-c,t-c,e+c,t+c);if(!d||0===d.length)return[];for(var y,_=a.create(),x=n?function(i,r,o){var l=f.C_DEG_TO_RAD*n,h=Math.cos(l),u=Math.sin(l),c=((1+r)*i[0]+(1-r)*i[2])/2,d=((1+o)*i[1]+(1-o)*i[3])/2,p=e-c,v=t-d,y=c+h*p+u*v,m=d-u*p+h*v;return _[0]=y-s,_[1]=m-s,_[2]=y+s,_[3]=m+s,a.intersects(i,_)}:function(e){return a.intersects(e,g)},b=[],C=0,w=d;C<w.length;C++){var T=w[C];switch(h.getJsonType(T.geometry)){case"esriGeometryPoint":var I=this._getSymbol(T.graphic);if(!I)continue;var D=T.geometry,L=void 0,P=void 0;if("text"===I.type){var R=I;L=p.getXAnchorDirection(R.horizontalAlignment||"center"),P=p.getYAnchorDirection(R.verticalAlignment||"middle"),p.getTextSymbolBounds(m,D.x,D.y,R,T.size,this._resolution,n)}else L=0,P=0,p.getMarkerSymbolBounds(m,D.x,D.y,I,this._resolution,n);x(m,L,P)&&b.push(T);break;case"esriGeometryPolyline":var O=this._getSymbol(T.graphic);if(!O)continue;y=1.5*r*window.devicePixelRatio*o.pt2px(O.width),p.isPointOnPolyline(T.geometry,e,t,y)&&b.push(T);break;case"esriGeometryEnvelope":var M=T.geometry,A=a.fromValues(M.xmin,M.ymin,M.xmax,M.ymax);a.intersects(A,g)&&b.push(T);break;case"esriGeometryPolygon":l.polygonContainsPoint(T.geometry,{x:e,y:t})&&b.push(T);break;case"esriGeometryMultipoint":var S=this._getSymbol(T.graphic);if(!S)continue;for(var G=T.geometry.points,B=void 0,E=void 0,F=0;F<G.length;F++){if("text"===S.type){R=S;B=p.getXAnchorDirection(R.horizontalAlignment||"center"),E=p.getYAnchorDirection(R.verticalAlignment||"middle"),p.getTextSymbolBounds(m,G[F][0],G[F][1],R,T.size,this._resolution,n)}else B=0,E=0,p.getMarkerSymbolBounds(m,G[F][0],G[F][1],S,this._resolution,n);if(x(m,B,E)){b.push(T);break}}}}return b.sort(function(e,t){var i=p.graphicGeometryToNumber(e.graphic),r=p.graphicGeometryToNumber(t.graphic);return i===r?t.zorder-e.zorder:i-r}),b.map(function(e){return e.graphic})},e.prototype.getGraphicData=function(e,t){var r=this._itemByGraphic.get(t);if(!r)return null;var n=v(this._index,e.bounds[0],e.bounds[1],e.bounds[2],e.bounds[3]);n.sort(function(e,t){return e.zorder-t.zorder});var o=n.indexOf(r),s=0===o||-1===o?-1:n[o-1].graphic.uid,a={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},l=r.getGeometryQuantized(a),h=i({},r.graphic.attributes);return h[this._uidFieldName]=t.uid,{centroid:d.default.getCentroidQuantized(r,a,this.renderer,this._scale),geometry:l,attributes:h,symbol:t.symbol,insertAfter:s}},e.prototype.queryTileData=function(e){var t=50*e.resolution,i=a.pad(e.bounds,t,a.create()),r=v(this._index,i[0],i[1],i[2],i[3]),n=[];return this._createTileGraphics(n,r,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),n},e.prototype.has=function(e){return this._itemByGraphic.has(e)},e.prototype.getBounds=function(e){return this._itemByGraphic.has(e)?this._itemByGraphic.get(e).bounds:null},e.prototype.add=function(e,t,i){if(e){var r=d.default.acquire(e,i,t,this.renderer,this._resolution,this._scale,this._tileInfoView.spatialReference);return this._itemByGraphic.set(e,r),this._itemByGraphic.forEach(this._updateGraphicZorder),i&&this._index.insert(r),r.bounds}},e.prototype.remove=function(e){if(this._itemByGraphic.has(e)){var t=this._itemByGraphic.get(e);this._index.remove(t),this._itemByGraphic.delete(e),this._itemByGraphic.forEach(this._updateGraphicZorder)}},e.prototype.reorder=function(e){this._itemByGraphic.has(e)&&this._itemByGraphic.forEach(this._updateGraphicZorder)},e.prototype.update=function(e,t,i){var r=this._itemByGraphic.get(e),n=a.clone(r.bounds);return r.size[0]=r.size[1]=0,this._index.remove(r),r.set(e,i,t,this.renderer,this._resolution,this._scale,this._tileInfoView.spatialReference),i&&this._index.insert(r),{oldBounds:n,newBounds:r.bounds}},e.prototype.updateLevel=function(e){var t=this;if(this._currentLevel!==e){this._currentLevel=e;var i=this._tileInfoView.getTileResolution(e);this._resolution=i,this._scale=this._tileInfoView.getTileScale({level:e,row:0,col:0,world:0});var r=this._itemByGraphic.values();c.forEachIter(r,function(e){t._index.remove(e),e.updateBounds(t.renderer,t._resolution,t._scale,t._tileInfoView.spatialReference),e.geometry&&t._index.insert(e)})}},e.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},e.prototype._createTileGraphics=function(e,t,r){var n=this._uidFieldName;t.sort(function(e,t){return e.zorder-t.zorder});for(var o,s,a,l,h=0;h<t.length;h++){o=(a=t[h]).graphic,s=a.getGeometryQuantized(r),l=0===h?-1:t[h-1].graphic.uid;var u=i({},a.graphic.attributes);u[n]=o.uid,e.push({centroid:d.default.getCentroidQuantized(a,r,this.renderer,this._scale),geometry:s,attributes:u,symbol:o.symbol,insertAfter:l})}},e.prototype._getSymbol=function(e){return e.symbol?e.symbol:this.renderer?this.renderer.getSymbol(e,{scale:this._scale}):null},e.prototype._updateGraphicZorder=function(e,t){e.zorder=this._graphics.indexOf(t)},e}();t.default=_}.apply(null,r))||(e.exports=n)},1671:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(81),i(487),i(51),i(1417),i(1531)],void 0===(n=function(e,t,i,r,n,o,s){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this.bounds=i.create(),this.graphic=null,this.size=[0,0,0,0]}return e.acquire=function(t,i,r,n,o,s,a){var l;return void 0===t&&(t=null),0===e._pool.length?l=new e:(l=e._pool.pop(),this._set.delete(l)),l.acquire(t,i,r,n,o,s,a),l},e.release=function(e){e&&!this._set.has(e)&&(e.release(),this._pool.push(e),this._set.add(e))},e.getCentroidQuantized=function(e,t,i,a){if(n.isPolygon(e.geometry)){var l=e.graphic.symbol;if(!l&&i&&(l=i.getSymbol(e.graphic,{scale:a})),!l)return null;if(s.isMarkerSymbol(l.type)){var h=r.polygonCentroid(e.geometry);return o.quantizePoint(t,{},{x:h[0],y:h[1]},!1,!1)}}return null},e.prototype.acquire=function(e,t,i,r,n,o,s){void 0===e&&(e=null),e&&this.set(e,t,i,r,n,o,s)},e.prototype.release=function(){this.graphic=null,this.geometry=null},e.prototype.set=function(e,t,i,r,n,o,a){this.graphic=e,this.geometry=t,s.getBounds(this.bounds,this.size,e,t,i,r,n,o,a)},e.prototype.updateBounds=function(e,t,i,r){s.getBounds(this.bounds,this.size,this.graphic,this.geometry,null,e,t,i,r)},e.prototype.getGeometryQuantized=function(e){return o.quantizeGeometry(e,this.geometry)},e._pool=[],e._set=new Set,e}();t.default=a}.apply(null,r))||(e.exports=n)},1672:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(5),i(0)],void 0===(n=function(e,t,i,r,n,o){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.graphics=null,t.renderer=null,t.view=null,t}return i(t,e),r([o.property()],t.prototype,"graphics",void 0),r([o.property()],t.prototype,"renderer",void 0),r([o.property()],t.prototype,"view",void 0),r([o.subclass("esri.views.layers.GraphicsView")],t)}(o.declared(n))}.apply(null,r))||(e.exports=n)},2382:function(e,t,i){var r,n;r=[i.dj.c(e.i),t,i(2),i(1),i(45),i(36),i(21),i(14),i(8),i(44),i(15),i(0),i(17),i(28),i(1838),i(1642),i(1606),i(1425),i(1456),i(1662),i(1412)],void 0===(n=function(e,t,i,r,n,o,s,a,l,h,u,c,d,p,f,v,y,m,g,_,x){var b=s.ofType(n);return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handles=new a,t._bitmapIndex=new Map,t._mapImageContainer=new y.BitmapContainer,t._featuresMap=new Map,t.allVisiblePoints=new b,t.allVisiblePolylines=new b,t.allVisiblePolygons=new b,t.allVisibleMapImages=new s,t.container=new m.Container,t}return i(t,e),t.prototype.hitTest=function(e,t){var i=this;if(this.suspended||!this._pointsView&&!this._polylinesView&&!this._polygonsView)return l.resolve(null);var r=[this._pointsView.hitTest(e,t),this._polylinesView.hitTest(e,t),this._polygonsView.hitTest(e,t)];return l.all(r).then(function(e){return e.filter(function(e){return e&&(e.layer=i.layer,e.sourceLayer=i.layer),!!e})[0]||null})},t.prototype.update=function(e){this._polygonsView&&this._polygonsView.update(e),this._polylinesView&&this._polylinesView.update(e),this._pointsView&&this._pointsView.update(e)},t.prototype.attach=function(){var e=this;this._handles.add(this.allVisibleMapImages.on("change",function(t){t.added.forEach(function(t){return e._addMapImage(t)}),t.removed.forEach(function(t){return e._removeMapImage(t)})})),this.container.addChild(this._mapImageContainer),this._polygonsView=new _.default({view:this.view,graphics:this.allVisiblePolygons}),this.container.addChild(this._polygonsView.container),this._polylinesView=new _.default({view:this.view,graphics:this.allVisiblePolylines}),this.container.addChild(this._polylinesView.container),this._pointsView=new _.default({view:this.view,graphics:this.allVisiblePoints}),this.container.addChild(this._pointsView.container),this.watch("layer.visibleSublayers",function(){return e._refreshCollections()}),this._fetchService()},t.prototype.detach=function(){this._handles.removeAll(),this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView&&(this._polygonsView.destroy(),this._polygonsView=null),this._polylinesView&&(this._polylinesView.destroy(),this._polylinesView=null),this._pointsView&&(this._pointsView.destroy(),this._pointsView=null)},t.prototype.moveStart=function(){this.requestUpdate()},t.prototype.viewChange=function(){this.requestUpdate()},t.prototype.moveEnd=function(){this.requestUpdate()},t.prototype._addMapImage=function(e){var t=this;this.view.spatialReference.isWGS84&&o(e.href,{responseType:"image"}).then(function(i){var r=i.data,n=d.fromJSON(e.extent);p.canProject(n,t.view.spatialReference)&&(n=p.project(n,t.view.spatialReference));var o=new v.Bitmap(r);o.x=n.xmin,o.y=n.ymax,o.resolution=n.width/r.naturalWidth,o.rotation=e.rotation,t._mapImageContainer.addChild(o),t._bitmapIndex.set(e,o)})},t.prototype._fetchService=function(){var e=this;return this._getParsedKML().then(function(t){e._fetchSublayerService(e.layer,t)})},t.prototype._fetchSublayerService=function(e,t){var i=this,r=e.sublayers;r&&r.forEach(function(e){u.whenTrueOnce(e,"visible").then(function(){return e.load()}).then(function(){return e.networkLink?i._getParsedKML():(i._featuresMap.set(e,i._getGraphicsForSublayer(e,t)),i._handles.remove("refresh-collections"),i._handles.add(h.schedule(function(){return i._refreshCollections()}),"refresh-collections"),t)}).then(function(t){i._fetchSublayerService(e,t)})})},t.prototype._getParsedKML=function(){return f.fetchService(this.layer.url,this.view.spatialReference,this.layer.refreshInterval).then(function(e){return f.parseKML(e.data)})},t.prototype._getGraphicsForSublayer=function(e,t){var i=null;return t.sublayers.some(function(t){return i=t,t.id===e.id})?{points:i.points&&f.getGraphics(i.points),polylines:i.polylines&&f.getGraphics(i.polylines),polygons:i.polygons&&f.getGraphics(i.polygons),mapImages:i.mapImages}:null},t.prototype._refreshCollections=function(){var e=this,t=this.get("layer.visibleSublayers");this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),t&&t.length&&t.forEach(function(t){var i=e._featuresMap.get(t);i&&(e.allVisiblePoints.addMany(i.points),e.allVisiblePolylines.addMany(i.polylines),e.allVisiblePolygons.addMany(i.polygons),e.allVisibleMapImages.addMany(i.mapImages))})},t.prototype._removeMapImage=function(e){var t=this._bitmapIndex.get(e);t&&(this._mapImageContainer.removeChild(t),this._bitmapIndex.delete(e))},r([c.subclass("esri.views.2d.layers.KMLLayerView2D")],t)}(c.declared(g,x))}.apply(null,r))||(e.exports=n)}}]);